<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Timecard System</title><meta http-equiv=Content-Type content="text/html" charset="UTF-8"><meta http-equiv=expires content="2025-11-11 15:57:23"><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="pragma" content="no-cache"><script src="/Timecard/wComTools.nsf/W_JSCommonLibrary"></script><script src="/Timecard/wComTools.nsf/W_JSObjectProcessLibrary"></script>
<link rel="stylesheet" href="/Timecard/wComTools.nsf/stdstyle.css"><div class="noprint">
<script language="JavaScript" type="text/javascript">
<!-- 
var changed=false;
function processatt(){

}
// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
document._domino_target = "_self";
function _doClick(v, o, t, h) {
  var form = document._DailyTimeCard;
  if (form.onsubmit) {
     var retVal = form.onsubmit();
     if (typeof retVal == "boolean" && retVal == false)
       return false;
  }
  var target = document._domino_target;
  if (o.href != null) {
    if (o.target != null)
       target = o.target;
  } else {
    if (t != null)
      target = t;
  }
  form.target = target;
  form.__Click.value = v;
  if (h != null)
    form.action += h;
  form.submit();
  return false;
}

function _getEditAppletData(){
  var form = document._DailyTimeCard;
  for(i=0;i<form.elements.length;i++) {
     if(form.elements[i].editorApplet != null) {
       try {
        if(form.elements[i].editorApplet.doYouKnowYourLines() == 'By heart') {
           form.elements[i].value = form.elements[i].editorApplet.getText("text//html");
        } 
       } catch(e) {window.status='Editor applet did not finish loading.';} 
     }
     if(form.elements[i].webEditor != null) {
        form.elements[i].value = form.elements[i].webEditor.getText("text//html");
     }
  }
  return true;
}
function RichTextObject() { 
this.RichTextData =""; 
} 
// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function getBroswer(){
    var Sys = {};
    var ua = navigator.userAgent.toLowerCase();
    var s;
    (s = ua.match(/edge\/([\d.]+)/)) ? Sys.edge = s[1] :
    (s = ua.match(/edg\/([\d.]+)/)) ? Sys.edge = s[1] :
    (s = ua.match(/rv:([\d.]+)\) like gecko/)) ? Sys.ie = s[1] :
    (s = ua.match(/msie ([\d.]+)/)) ? Sys.ie = s[1] :
    (s = ua.match(/firefox\/([\d.]+)/)) ? Sys.firefox = s[1] :
    (s = ua.match(/chrome\/([\d.]+)/)) ? Sys.chrome = s[1] :
    (s = ua.match(/opera.([\d.]+)/)) ? Sys.opera = s[1] :
    (s = ua.match(/version\/([\d.]+).*safari/)) ? Sys.safari = s[1] : 0;

    if (Sys.edge) return { broswer : "Edge", version : Sys.edge };
    if (Sys.edg) return { broswer : "Edge", version : Sys.edge };
    if (Sys.ie) return { broswer : "IE", version : Sys.ie };
    if (Sys.firefox) return { broswer : "Firefox", version : Sys.firefox };
    if (Sys.chrome) return { broswer : "Chrome", version : Sys.chrome };
    if (Sys.opera) return { broswer : "Opera", version : Sys.opera };
    if (Sys.safari) return { broswer : "Safari", version : Sys.safari };
    
    return { broswer : "", version : "0" };
}
function ChkBroswer(){
//if (window.ActiveXObject){
//}else{
	var mb = getBroswer();
	//alert("broswer:"+mb.broswer+" version:"+mb.version);	
	if (mb.broswer=="IE"){	
//	}else if (mb.broswer=="Edge"){
	}else{	
		var xID=xckbuser;
		var xString="&xID="+encodeURIComponent(xID)+"&xBroswer="+mb.broswer+"&xVer="+encodeURIComponent(mb.version)+"&";
		var newurl="/"+xckbdbpath+"/(agXMLChkBroswerRes)?openagent"+xString;
		var post_xmlHttp=createXMLHttpRequest(); //W_JSCommonLibrary
		post_xmlHttp.open("GET",newurl,false);
		post_xmlHttp.send();
		if (mb.broswer=="Edge"){
			alert("瀏覽器有誤，請聯繫 IT窗口");
		}else{
			alert("請改用微軟 Edge 瀏覽器登入");
		}
		if (window.frameElement==null){
    			window.close();
		}
	}
//}
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function WM_ShowWaitingMsg(){
// 顯示系統處理中的訊息;
 try{
	var bTables = document.getElementById("WaitingMsg");
	bTables.style.display="block";
 }catch(e){
 }
}

function WM_HiddenWaitingMsg(){
// 隱藏系統處理中的訊息;
 try{
	var bTables = document.getElementById("WaitingMsg");
	bTables.style.display="none";
 }catch(e){
 }
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
//--------------------------Custom Special Function-----------------------------------------------
function Spec_Post_onLoad(){
	// onLoad 後執行的客製化程式, function Name 為固定名稱
	var f=document.forms[0];	
     if (f.isEdit.value=="1") {
        var tableedit1=false; //可進行編輯
     }else{
        var tableedit1=true; //不可進行編輯        
     }
   //  var tableedit1=true; 
	try{	
			WItemList1=new WMItemList(window.document,"WItemList1","TableItem1","ShowItemDisplay1",tableedit1,"2","display_WItemList1");
			WItemList1.Post_Edit= ItemListEdit_Init;
			ApplyEdit();
			
			//EditCurrentNo1();
			WItemList1.ShowMenu=false;  //true : 提供功能表選單 , false : 不提供功能表選單
			if (f.isEdit.value=="1"){
				if (f.TmpFutureFlag.value=="1"){ 
					IDDsiplay("ID_AddBtn",false);
					IDDsiplay("ID_AddCus",true);	
					IDDsiplay("ID_TableT",true);
					IDDsiplay("ID_TableAll",false);	
					WItemList1.DeleteAllItem();								
				}else{
					WItemList1.TEDITItemNo(WItemList1.ItemNo);				
				}	
			}else{
				if (f.TmpFutureFlag.value=="1" || f.MaxRegularHour.value==f.DspLeaveHours.value){ 
					//IDDsiplay("ID_TableT",true);
					//IDDsiplay("ID_TableAll",false);
					//modify by Polly, 2013.09.04, 預防後來改為假日者，有加班則仍需顯示
					if (f.TotalRealOTHour.value=="0" && f.TotalRealOBHour.value=="0") 	{		
						IDDsiplay("ID_TableT",true);
						IDDsiplay("ID_TableAll",false);
					}else {
						IDDsiplay("ID_TableT",false);
						IDDsiplay("ID_TableAll",true);	
					}
				}else{
					IDDsiplay("ID_TableT",false);
					IDDsiplay("ID_TableAll",true);					
				}
			}	
	}catch(e){
		alert("Error! Fail! Spec_Post_onLoad()");
	}
}

function ApplyEdit(){
	 if (f.isEdit.value!="1") return;
	var aryWKHR=WItemList1.GetFieldArrayValues("WorkHourList");
	var aryOTHR=WItemList1.GetFieldArrayValues("OTHourList");
	var aryOBHR=WItemList1.GetFieldArrayValues("OBHourList");
	var ValFlag=false;
	if (trim(aryWKHR[0].toString())!="" && trim(aryWKHR[0].toString())!="0") ValFlag=true;
	if (trim(aryOTHR[0].toString())!="" && trim(aryOTHR[0].toString())!="0") ValFlag=true;	
	if (trim(aryOBHR[0].toString())!="" && trim(aryOBHR[0].toString())!="0" ) ValFlag=true;	
	if (ValFlag==true) TotalHours();
}

function ItemListEdit_Init(){
	//ID_Obj1Name/Obj1NameList_x
	/*HTMLField_L1();	HTMLField_L2();
	HTMLField_Activity();	*/
	HTMLField_All();
	//ModifyChkText='<input type=checkbox style="Border=0"   '+xcheck+'   name=\"$$CheckSel_'+x+'\"  value=\"$$CheckSel_'+x+'\">'+"";
	x=WItemList1.CurrentNo;
	var DeleteText="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"DeleteCurrentNo('"+x+"');\">Delete</span>"
	document.all["ID_DelChkE"].innerHTML=DeleteText;
	var WHObj_x=f.WorkHourList_x;
	var OHObj_x=f.OTHourList_x;	
	var BHObj_x=f.OBHourList_x;	
	//Add by wmmate ,判斷各工時是否能Edit,2012-12-13
	IsEditHourFields(WHObj_x,OHObj_x,BHObj_x);
	
	if (trim(WHObj_x.value)=="") WHObj_x.value="0";
	//if (trim(WHObj_x.value)=="") WHObj_x.value=AutoWHours(x);
	if (trim(OHObj_x.value)=="") OHObj_x.value="0";
	//if (trim(OHObj_x.value)=="") OHObj_x.value=AutoHours(x,"TotalRealOTHour","OTHourList");
	if (trim(BHObj_x.value)=="") BHObj_x.value="0";	
	//if (trim(BHObj_x.value)=="") BHObj_x.value=AutoHours(x,"TotalRealOBHour","OBHourList");
	//var MarkObj_x=f.Remarks_x;		
	//if (trim(MarkObj_x.value)=="") MarkObj_x.value="-";		
	//TotalHours();
	EditTotalHours(x,WHObj_x.value,OHObj_x.value,BHObj_x.value)
	
}
//Add by wmmate -2012-12-19 ,倒扣時改由選L1/L2/Activity時回傳資料後帶出~
function DefaultHours(){
	var WHObj_x=f.WorkHourList_x;
	var OHObj_x=f.OTHourList_x;	
	var BHObj_x=f.OBHourList_x;		
	if (trim(WHObj_x.value)=="" || trim(WHObj_x.value)=="0") WHObj_x.value=AutoWHours(x);
	if (trim(OHObj_x.value)=="" || trim(OHObj_x.value)=="0") OHObj_x.value=AutoHours(x,"TotalRealOTHour","OTHourList");
	if (trim(BHObj_x.value)=="" || trim(BHObj_x.value)=="0") BHObj_x.value=AutoHours(x,"TotalRealOBHour","OBHourList");
	var MarkObj_x=f.Remarks_x;		
	//if (trim(MarkObj_x.value)=="") MarkObj_x.value="-";			//mark by Polly, 2013.07.17, remark 不補 "-"
	//TotalHours();
	EditTotalHours(x,WHObj_x.value,OHObj_x.value,BHObj_x.value)
}
function IsEditHourFields(WHObj_x,OHObj_x,BHObj_x){
//Add by wmmate ,判斷各工時是否能Edit,2012-12-13
	//WKHr
	if (f.IsHoliday.value=="Y") {
		WHObj_x.style.display="none";
	}else{
		WHObj_x.style.display="block";
	}
	//OTHr
	var rOThr=GetHr("TotalRealOTHour");
	if (rOThr>0){
		OHObj_x.style.display="block";
	}else{
		OHObj_x.style.display="none";
	}
	//OBHr
	var rOBhr=GetHr("TotalRealOBHour");	
	if (rOBhr>0){
		BHObj_x.style.display="block";
	}else{
		BHObj_x.style.display="none";
	}	
}
//Total Hours
function EditTotalHours(ItemNo,CurWhr,CurOhr,CurBhr){
var aryWH=WItemList1.GetFieldArrayValues("WorkHourList");
var aryOH=WItemList1.GetFieldArrayValues("OTHourList");
var aryOB=WItemList1.GetFieldArrayValues("OBHourList");
var tWH=0;
var tOH=0;
var tBH=0;
var tSum=0;
	
	for(var i=0;i<aryWH.length;i++){
		if ((i+1)!=parseFloat(ItemNo)){
			//WorkHours
			var xWH=trim(aryWH[i].toString());
			if(xWH!=""){
				if (IsNumber(xWH)==false)	xWH=0;
			}else{
				xWH="0";			
			}
			tWH+=parseFloat(xWH);
			//Overtime Hours
			var xOH=trim(aryOH[i].toString());	
			if(xOH!=""){
				if (IsNumber(xOH)==false)	xOH="0";
			}else{
				xOH="0";			
			}	
			tOH+=parseFloat(xOH);
			//Obligation Hours
			var xBH=trim(aryOB[i].toString());	
			if(xBH!=""){
				if (IsNumber(xBH)==false) xBH="0";
			}else{
				xBH="0";			
			}		
			tBH+=parseFloat(xBH);		
		}	
	}
	//Add Edit
	tWH+=parseFloat(CurWhr);
	tOH+=parseFloat(CurOhr);	
	tBH+=parseFloat(CurBhr);		
	//Add Leave
	var tLH=0;
	if (IsNumber(f.LeaveHour.value)==true)	{
		tLH=parseFloat(f.LeaveHour.value);
	}
	tWH+=tLH;	
	//--------------------------
	tWH=FixHours(tWH);
	tOH=FixHours(tOH);
	tBH=FixHours(tBH);	
	//--------------------------
	tSum=tWH+tOH+tBH;
	tSum=FixHours(tSum);
	//--------------------------
	//Add by Polly, 2012.12.12, 為解決7.9999999問題
	/*tWH = FixTotalHours(tWH);
	tOH = FixTotalHours(tOH);
	tBH = FixTotalHours(tBH);
	tSum = FixTotalHours(tSum);*/
	//--------------------------
	f.TotalHour.value=Math.round(tWH*100)/100;
	f.TotalOTHour.value=Math.round(tOH*100)/100;	
	f.TotalOBHour.value=Math.round(tBH*100)/100;		
	f.SumHour.value=Math.round(tSum*100)/100; 
	DisplayHoursMsg(tWH,tOH,tBH);  
}
//2012-11-20 Add
function AutoHours(ItemNo,MaxHrName,FieldName){
	var xMaxHrs=GetHr(MaxHrName);
	var xTotal=0;
	var aryWKhr=WItemList1.GetFieldArrayValues(FieldName);
	for(var i=0;i<aryWKhr.length;i++){
		if ((i+1)!=parseFloat(ItemNo)){
			xTotal=xTotal+GetHrVal(aryWKhr[i]);
		}	
	}	
	xMaxHrs=xMaxHrs-xTotal;	
	if (xMaxHrs<0 ) xMaxHrs=0;
	xMaxHrs=Math.round(xMaxHrs*100)/100;
	return FixHours(xMaxHrs);
}
//2012-11-20 Add
function AutoWHours(ItemNo){
var xMaxHrs=GetHr("MaxRegularHour"); 
//alert("Item="+ItemNo+"\nMaxHr="+xMaxHrs);
	if (f.IsHoliday.value=="Y") return 0;
	if (trim(f.LeaveHour.value)=="" ){
		var xLeaveHrs=0;
	}else{
		var xLeaveHrs=parseFloat(f.LeaveHour.value);
	}
	xMaxHrs=xMaxHrs-	xLeaveHrs;
	var xTotal=0;
	var aryWKhr=WItemList1.GetFieldArrayValues("WorkHourList");
	for(var i=0;i<aryWKhr.length;i++){
		if ((i+1)!=parseFloat(ItemNo)){
			xTotal=xTotal+GetHrVal(aryWKhr[i]);
		}	
	}
	//alert(xTotal)
	xMaxHrs=xMaxHrs-xTotal;
	if (xMaxHrs<0 ) xMaxHrs=0;
	xMaxHrs=Math.round(xMaxHrs*100)/100;
	return FixHours(xMaxHrs);
}
function display_Hours(DisplayItem){
	//Display Work Hour
	var xHoliday=f.IsHoliday.value;
	var WKObj=GetDispListItemObjByFieldName(DisplayItem,"WorkHourList");
	if (xHoliday=="Y"){
		WKObj.style.display="none";
	}else{
		WKObj.style.display="block";
		if (trim(WKObj.innerText)=="") WKObj.innerText="0";
	}
	//Display OT Hour
	var xROT=0;
	var OTObj=GetDispListItemObjByFieldName(DisplayItem,"OTHourList");
	if (trim(f.TotalRealOTHour.value)!=""){
		if (IsNumber(trim(f.TotalRealOTHour.value))==true) xROT=parseFloat(trim(f.TotalRealOTHour.value));
	}
	if (xROT>0){
		OTObj.style.display="block";
		if (trim(OTObj.innerText)=="") OTObj.innerText="0";		
	}else{
		OTObj.style.display="none";
	}
	//Display OB Hour
	var xROB=0;
	var OBObj=GetDispListItemObjByFieldName(DisplayItem,"OBHourList");
	if (trim(f.TotalRealOBHour.value)!=""){
		if (IsNumber(trim(f.TotalRealOBHour.value))==true) xROB=parseFloat(trim(f.TotalRealOBHour.value));
	}
	if (xROB>0){
		OBObj.style.display="block";
		if (trim(OBObj.innerText)=="") OBObj.innerText="0";				
	}else{
		OBObj.style.display="none";
	}	
}

//表格Display時應執行的程式+++++++++++++++++++++++++++++++++++++++
function  display_WItemList1(){
	display_Hours(this.CurDisplayItem);
	//Attribute Display-----------Add by wmmate 2013-05-02
	display_Attr(this.CurDisplayItem,"L1AttrItemDataList","ID_L1AttrTableD");
	display_Attr(this.CurDisplayItem,"L2AttrItemDataList","ID_L2AttrTableD");
	display_Attr(this.CurDisplayItem,"ActivityAttrItemDataList","ID_ActAttrTableD");	
	//--------------------------------
	if (f.isEdit.value!="1") return;
	var xcheck="";
	x=this.CurDisplayNo.toString();
	//Delete-ID_DelImg
	var DelImgObj=GetDispListItemObjByID(this.CurDisplayItem,"ID_DelImg");
	if (DelImgObj){   //onclick=\"DeleteCurrentNo('"+x+"')\";
		var DelImgText="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"DeleteCurrentNo('"+x+"');\"><u><font color='#0000FF'>Delete</font></u></span>"
		DelImgObj.innerHTML=DelImgText;
	}
	var xKind=GetDispListItemObjByID(this.CurDisplayItem,"ID_Obj1KindList");
	var xLo=GetDispListItemObjByID(this.CurDisplayItem,"ID_Attribute18List");
	//Attribute18List
	if (xKind.innerText!="Customer") {
		xLo.innerText="";	
	}else{
		xLo.innerText="-"+xLo.innerText;
	}
}
//Display Attribute Table---------------------
function display_Attr(DisplayItem,fieldName,TableID){
	var tableFlag=false;
	//var xStyle="style='border-color:#000000;table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:100%'";
	var Dataobj=GetDispListItemObjByFieldName(DisplayItem,fieldName);
	var Tableobj=GetDispListItemObjByID(DisplayItem,TableID);
	var AllHTML="<br><Table class='Attrtable' width=100%  border='1'>";
	var aryData=new Array();
	explode(Dataobj.innerText,"@",aryData);	
	for(var i=0;i<aryData.length;i++){
		if (trim(aryData[i])!="" && trim(aryData[i])!="-"){
			tableFlag=true;
			//if (fieldName=="L2AttrItemDataList" ) alert(aryData[i])
			//AllHTML+="<TR><TD style='border-bottom-style:dashed;border-bottom-color:#000000;'>"+ReplaceSubString(aryData[i],"^","<br>")+"</TD></TR>";
			AllHTML+="<TR ><TD class='Attrtd'>"+AttrTitle+ReplaceSubString(aryData[i],"^","<br>")+"</TD></TR>";
		}
	}
	AllHTML+="</Table>"
	if (tableFlag==true) Tableobj.innerHTML=AllHTML;	
}

//Delete目前指定項目的資料++++++++++++++++++++++++++
function DeleteCurrentNo(ItemNo){
	//var xflag=confirm("您確定要刪除第 "+ItemNo+" 筆資料嗎?");
	//var xflag=confirm("Are you sure you want to delete the \""+ItemNo+"\" document?");
	var xflag=confirm(GetMsg("027",ItemNo,ItemNo));
	if (xflag==false) return false;
	ItemList=WItemList1;
	ItemList.Item_Action_Delete(ItemNo);
	WItemList1.ReDisplay(WItemList1);
	TotalHours();

}


function HTMLField_All(){
	HTMLField_L1();
	HTMLField_L2();
	HTMLField_Activity();
	//Attribute------------------------------------------------------
	HTMLField_Attr("L1AttrItemDataList_x","ID_L1AttrTableE");	
	HTMLField_Attr("L2AttrItemDataList_x","ID_L2AttrTableE");	
	HTMLField_Attr("ActivityAttrItemDataList_x","ID_ActAttrTableE");		
}

//Add by wmmate 2013-05-02
function HTMLField_Attr(fieldName,TableID){
	var tableFlag=false;
	var xStyle="style='border-color:#000000;table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:100%'";
/*	var HTMLS="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('3');\"><FONT color='0000FF'><U>";
	var HTMLE="</U></FONT></span>"; */
	var HTMLS="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('3');\"><FONT color='0000FF'>";
	var HTMLE="</FONT></span>";	
	var xData=trim(getItemValue(eval("f."+fieldName)).toString());
	var aryData=new Array();
	explode(xData,"@",aryData);
	//var AllHTML="<br><Table border='1' "+xStyle+">";
	var AllHTML="<br><Table class='Attrtable' width=100%  border='1'>";
	for(var i=0;i<aryData.length;i++){
		if (trim(aryData[i])!="" && trim(aryData[i])!="-"){
			tableFlag=true;
			AllHTML+="<TR><TD class='Attrtd'>"+HTMLS+AttrTitle+ReplaceSubString(aryData[i],"^","<br>")+HTMLE+"</TD></TR>";
		}
	}
	AllHTML+="</Table>";
	if (tableFlag==true) {
		document.all[TableID].innerHTML=AllHTML;
	}else{
		document.all[TableID].innerHTML="";
	}

}

//可能不需要囉-->日後移除
function HTMLField_L1Attr(){  
	var tableFlag=false;
	var xStyle="style='border-color:#000000;table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:100%'";
	var HTMLS="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('1');\"><FONT color='0000FF'><U>";
	var HTMLE="</U></FONT></span>";
	//var xData=trim(getItemValue(f.L1AttrItemDataList_x).toString());
	var xData=trim(getItemValue(eval("f."+"L1AttrItemDataList_x")).toString());
	var aryData=new Array();
	explode(xData,"@",aryData);
	var AllHTML="<br><Table border='1' "+xStyle+">";
	for(var i=0;i<aryData.length;i++){
		if (trim(aryData[i])!=""){
			tableFlag=true;
			AllHTML+="<TR><TD>"+HTMLS+aryData[i]+HTMLE+"</TD></TR>";
		}
	}
	AllHTML+="</Table>"
	//xComent_1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('1');\"><FONT color='0000FF'><U>"+"111111111"+"</U></FONT></span>";
	//xComent_2="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('1');\"><FONT color='0000FF'><U>"+"222222222"+"</U></FONT></span>";
	//xHTL1_1="<br><Table border='1' "+xStyle+"><TR><TD>"+xComent_1+"</TD></TR><TR><TD>"+xComent_2+"</TD></TR></Table>";	
	if (tableFlag==true) document.all["ID_L1AttrTableE"].innerHTML=AllHTML;

}
//Edit Field HTML->Objective L1++++++++++++++++++++++++++++++++
function HTMLField_L1(){
var xHTL1="";
	var Obj1Kind=trim(getItemValue(f.Obj1KindList_x).toString());
	var L1=trim(getItemValue(f.Obj1NameList_x).toString());	
	NowFName="3";
	if (Obj1Kind!=""){
		if (L1==""){
			srcLink="/"+f.DbPath.value+"/Select.JPG?OpenImageResource";
			xHTL1="<img alt='L1 Select ' HEIGHT='15' ALIGN='absmiddle' src='"+srcLink+"' onclick=\"SelectAllList('"+NowFName+"');\";>"
			IDDsiplay("ID_Location",false);
		}else{			
			//xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'><U>"+L1+"</U></FONT></span>";
			xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'>"+L1+"</FONT></span>";
			//if (Obj1Kind=="Customer" ) {
			if (Obj1Kind=="Customer" && f.LocationDisplay.value=="Y" ) {
				IDDsiplay("ID_Location",true);
			}else{
				IDDsiplay("ID_Location",false);
			}	
		} 
	}
	document.all["ID_Obj1Name"].innerHTML=xHTL1;		
}


//Edit Field HTML->Objective L2++++++++++++++++++++++++++++++++
function HTMLField_L2(){
var xHTL1="";	
	NowFName="3";
	var L1=trim(getItemValue(f.Obj2NameList_x).toString());	
	if (L1!=""){
		//xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'><U>"+L1+"</U></FONT></span>";
		xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'>"+L1+"</FONT></span>";
	}
	document.all["ID_Obj2Name"].innerHTML=xHTL1;
}
//Edit Field HTML->Activity++++++++++++++++++++++++++++++++
function HTMLField_Activity(){
var xHTL1="";
	NowFName="3";
	srcLink="/"+f.DbPath.value+"/Select.JPG?OpenImageResource";
	var L1=trim(getItemValue(f.ActivityNameList_x).toString());

	//xHTL1=xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'><U>"+L1+"</U></FONT></span>";
	xHTL1=xHTL1="<span onmouseover=\"this.style.cursor='hand'\" onclick=\"SelectAllList('"+NowFName+"');\"><FONT color='0000FF'>"+L1+"</FONT></span>";
	document.all["ID_Activity"].innerHTML=xHTL1;
}


function SelectAllList(NowFName){
//var xDMsg="Please enter Timecard Date first!";
//var xDate=getItemValue(f.DataDate); 
var xDate=getItemValue(f.txtDataDate); 
if(xDate==""){
	alert(GetMsg("001","",""));
	return;
}
var xDbPath=f.DbPath.value;
var xDept=f.DeptNo.value;
var xType=getItemValue(f.Obj1KindList_x)
if (xType=="") {
  //alert("請輸入 Objective類別!!");
  //alert("Please select category.");
  alert(GetMsg("002","",""))
  return;
}
//check L1 Data--->
if (NowFName.toString()=="1"){
	if (GetL1List(encodeURIComponent(xType))==false){
		//alert(GetMsg("028","",""))
		alert(GetMsg("092","",""))			//Change by Polly, 2013.07.12
		//alert("Objective L1 information unavailable. Please contact with the system administrator! ");	
		return;
	}
}
//<----------
var skey=encodeURIComponent(xType);
var rtn;
var L1=getItemValue(f.Obj1NameList_x);
var NameList="X";
var xlink="/"+xDbPath+"/Wdlg_ObjectiveSelectInput?OpenForm&"+skey+"&"+NameList+"&HTMLField_All&"+NowFName+"&"+xDept+"&"+xDate;
rtn=window.showModalDialog(xlink ,window,GetOpenObjDialogStyle());
DefaultHours();
	if ((rtn==undefined) || (rtn=="")) {
	/*
	//2012-11-19 Add
	if (xType=="Customer"){
		var xlink="/"+xDbPath+"/Wdlg_Location?OpenForm&"+"Attribute18List_x";
		rtn=window.showModalDialog(xlink ,window,GetOpenLocationDialogStyle());
		if ((rtn==undefined) || (rtn=="")) {
 			return;
		}		
	}
	//-----------------------------
	*/
		//Add by Polly, 2012.11.30, 若都沒有選，則把Category清掉
		//-----------------------------
		//CheckSelectItem();
		if(CheckSelectItem() == false){
			f.Obj1KindList_x.options[0].selected = true;
		};
		//-----------------------------
		
 		return;
	}
//HTMLField_All();

}


//Add by Polly, 2012.11.30, 判斷是否都沒有選擇完全
function CheckSelectItem(){
	var xObj1 = trim(getItemValue(f.Obj1NameList_x).toString());
	var xObj2 = trim(getItemValue(f.Obj2NameList_x).toString());
	var xActy = trim(getItemValue(f.ActivityNameList_x).toString());

	if(trim(xObj1) == "" && trim(xObj2) == "" && trim(xActy) == ""){
		return false;
	}
	return true;
}

function WdlgLocation(){
var xType=getItemValue(f.Obj1KindList_x);
var xDbPath=f.DbPath.value;
	if (xType=="Customer"){
		var xlink="/"+xDbPath+"/Wdlg_Location_1?OpenForm&"+"Attribute18List_x";
		rtn=window.showModalDialog(xlink ,window,GetOpenLocationDialogStyle());
		if ((rtn==undefined) || (rtn=="")) {
 			return;
		}		
	}
}
function GetOpenLocationDialogStyle(){
	var xStyle="dialogHeight:200px; "
	xStyle+="dialogWidth:100px; "
	xStyle+="edge: Raised; "
	xStyle+="center: Yes; "
	xStyle+="help: No; "
	xStyle+="resizable: Yes; "
	xStyle+="status: No;"
	xStyle+="scroll:No"
	return xStyle;	
}

function GetOpenObjDialogStyle(){
	var xStyle="dialogHeight:650px; "
	xStyle+="dialogWidth:1000px; "
	xStyle+="edge: Raised; "
	xStyle+="center: Yes; "
	xStyle+="help: No; "
	xStyle+="resizable: Yes; "
	xStyle+="status: No;"
	xStyle+="scroll:Yes"
	return xStyle;	
}
//依欄名(陣列)依序塞入指定值(陣列)+++++++++++++++++++++
function InputValueFieldByName(aryFieldName,aryVal){
	//var aryFieldName=FieldNameList.split(";");
	//var aryVal=xVal.split(";");
	for(var i=0;i<aryFieldName.length;i++){
		setItemValue(eval("f."+aryFieldName[i]),trim(aryVal[i].toString()));
	}
}

function InputValueHrFieldByName(aryFieldName,aryVal){
	for(var i=0;i<aryFieldName.length;i++){		
		var xV=trim(getItemValue(eval("f."+aryFieldName[i])).toString());
		if (xV=="")	setItemValue(eval("f."+aryFieldName[i]),trim(aryVal[i].toString()));
	}
}
//Clear Edit Field+++++++++++++++++++++++++++++++++++
function ClearEditField(){
	var FNames="Obj1KindList_E;Obj1NameList_E;Obj1List_E;Obj1DescList_E;Obj1GroupList_E;Pj1TypeList_E;CustAttrList_E";
	FNames+=";CustNoList_E;CustRegionList_E;Obj2NameList_E;Obj2List_E;Obj2DescList_E;Obj2GroupList_E";
	FNames+=";ActivityNameList_E;ActivityList_E;ActivityDescList_E;Attribute18List_E";
	FNames+=";WorkHourList_E;OTHourList_E;OBHourList_E;Remarks_E";	
	//InputValueFieldByName()
	var aryFName=new Array();
	explode(FNames,";",aryFName);
	var aryFValue=new Array("","","","","","","","","","","","","","","","","","0","0","0","");
	InputValueFieldByName(aryFName,aryFValue);
	setItemValue(f.ModifyField,"");	
	INPUTHTMLField_All();
}

function ClearEditItemField(){
	var FNames="Obj1KindList_x;Obj1NameList_x;Obj1List_x;Obj1DescList_x;Obj1GroupList_x;Pj1TypeList_x;CustAttrList_x";
	FNames+=";CustNoList_x;CustRegionList_x;Obj2NameList_x;Obj2List_x;Obj2DescList_x;Obj2GroupList_x";
	FNames+=";ActivityNameList_x;ActivityList_x;ActivityDescList_x;Attribute18List_x";	
	FNames+=";L1AttrItemNoList_x;L1AttrItemDataList_x;L2AttrItemNoList_x;L2AttrItemDataList_x;ActivityAttrItemNoList_x;ActivityAttrItemDataList_x";
	FNames+=";Obj1NameNewList_x;Obj1NewList_x";
	//mark by Polly, 2013.07.02
	//FNames+=";ViewAttrData1List_x;ViewAttrData2List_x;ViewAttrData3List_x;ViewAttrData4List_x;ViewAttrData5List_x;ViewAttrData6List_x";	
	//InputValueFieldByName()
	var aryFName=new Array();
	explode(FNames,";",aryFName);
	var aryFValue=new Array("","","","","","","","","","","","","","","","","","","","","","","","","");
	InputValueFieldByName(aryFName,aryFValue);
	setItemValue(f.ModifyField,"");	
	HTMLField_All();
}
//Check  EditField  其一欄位是否有值,True:All欄位有值++++++++++
function CheckEditFieldIsVal(vFMsg,vFValue){
	//vFName:必填欄位名稱,vFValue:必填欄位值
	//var rtnflag=true;
	for(var i=0;i<vFValue.length;i++){
		if(trim(vFValue[i].toString())==""){
			alert(vFMsg[i]);
			return false;
		}
	}
	return true;
}
//Check  EditField  其一欄位是否Number,True:All欄位值Is Number
function CheckEditFieldIsNumber(vFMsg,vFValue){
	//vFName:欄位名稱,vFValue:欄位值
	//var rtnflag=true;
	for(var i=0;i<vFValue.length;i++){
		if (IsNumber(trim(vFValue[i].toString()))==false){
			//alert("您輸入之 "+vFMsg[i].toString()+" 有問題，請確認");
			//alert("Please check on "+vFMsg[i].toString()+".")
			alert(GetMsg("118",vFMsg[i].toString(),vFMsg[i].toString()));
			return false;
		}
	}
	return true;
}

//Select Date選擇日期
function SelectDataDate(xRDataDate){
	if (xRDataDate=="") return true;
	//假日加班/平日加班-日期不可修改
	var xROTHr=trim(f.TotalRealOTHour.value);
	var xROBHr=trim(f.TotalRealOBHour.value);
	var xOTHr=0;
	var xOBHr=0;
	if (xROTHr!=""){
		if (IsNumber(xROTHr)==true) xOTHr=xROTHr;
	}
	if (xROBHr!=""){
		if (IsNumber(xROBHr)==true) xOBHr=xROBHr;
	}	
	if (xOTHr>0 || xOBHr>0){
		//alert("Can Not change Timecard Data when you have Overtime Hr on this day !")
		alert(GetMsg("031","",""));
		//f.DataDate.value=xRDataDate;
		return false;
	}
	return true;
}
//輸入工號
function ChangeEmpNo(EmpNo){
	if (trim(EmpNo)=="") return false;
	var xName=f.CurAbbUserName.value;
	var arykey=new Array(EmpNo);
	var root=GetObjValueXMLData("CHGEMPNO",arykey,xName);
	var Msg=GetTagName(root,"MSG");
	if (trim(Msg)!=""){
		//alert(Msg.toString());
		alert(ReplaceSubString(Msg.toString(),"@","\n"));
		return false;	
	}else{
		setItemValue(f.EmpName,GetTagName(root,"EmpName"));
		setItemValue(f.EmpUName,GetTagName(root,"EmpUName"));
		setItemValue(f.EmpNo,GetTagName(root,"EmpNo"));
		setItemValue(f.Position,GetTagName(root,"Position"));
		setItemValue(f.DeptNo,GetTagName(root,"DeptNo"));
		setItemValue(f.EmployeeGroup,GetTagName(root,"EmployeeGroup"));
		setItemValue(f.Reviewer,GetTagName(root,"Reviewer"));
		setItemValue(f.CalendarKey,GetTagName(root,"CalendarKey"));
		setItemValue(f.Site,GetTagName(root,"Site"));		
		setItemValue(f.Location,GetTagName(root,"Location"));	
		setItemValue(f.EmpClass,GetTagName(root,"EmpClass"));	
		setItemValue(f.EmpFunction,GetTagName(root,"EmpFunction"));	
		setItemValue(f.MaxRegularHour,GetTagName(root,"MaxRegularHour"));
		setItemValue(f.MaxLeaveHour,GetTagName(root,"MaxRegularHour"));	
		setItemValue(f.LocationDisplay,GetTagName(root,"LocationDisplay"));	
		IDDsiplayText("ID_Name",f.EmpUName.value);
		IDDsiplayText("ID_Reviewer",f.Reviewer.value);
		//Add by wmmate 2014-05-22
		var IsEditLeave=GetTagName(root,"IsEditLeave");
		if (IsEditLeave=="Y"){
			f.LeaveHour.disabled=false;	
			document.getElementById("LeaveHour").className="styleLeaveHour";
		}else{
			f.LeaveHour.disabled=true;	
			document.getElementById("LeaveHour").className="textstyleReadlimpid";		
			f.LeaveHour.value="0";
		}
		//<----------------------------------------
		TotalHours();
	}
}
function SelectEmp(){
	var xTitle = "Employee list- multiple choice";  //必需 ,選單Title
	var vName ="MBView_Web";
	var xDept=f.DeptNo.value;
	var xDbPath = f.txtTCOrgFilePath.value;  
	var xDbPathWeb = f.txtTCOrgFilePathWeb.value;
	var rtn;
	rtn=window.showModalDialog("/"+f.txtCDesignPathWeb.value+"/Wdlg_ViewUserSelect?OpenForm&"+xDbPath+"&"+xTitle+"&"+vName+"&"+xDept,window,"dialogHeight:450px; dialogWidth:450px; edge: Raised; center: Yes; help: No; resizable: No; status: No;");

	if ((rtn==undefined)|(rtn=="")){ return false;}
	var EmpNo=cright(trim(rtn),":");
	ChangeEmpNo(EmpNo);
	//alert(rtn)
}
//選擇日期
function ChangeDate(){
//(DeptNo As String,EmpNo As String,TCGroupID As String,DataDate As String,DocUnid As String)
	var xDeptNo=f.DeptNo.value;
	var xEmpNo=f.EmpNo.value;
	var xTCGroupID=f.TCGroupID.value;
	//var xDate=f.DataDate.value;
	var xDate=f.txtDataDate.value;
	var DocUnid=f.MainDocUNID.value;
	var xName=f.CurAbbUserName.value;
	var xCalendarKey=f.Site.value+"^"+f.Location.value+"^"+f.EmpClass.value;	
	if (xDate=="") return false;
	var arykey=new Array(xDeptNo,xEmpNo,xTCGroupID,xDate,DocUnid,xCalendarKey);
	var root=GetObjValueXMLData("CHGDATE",arykey,xName);
	var Msg=GetTagName(root,"MSG");
	var xAuto=f.AutoCreated.value;
	if (trim(Msg)!=""){
		Msg=ReplaceSubString(Msg,"@","\n");
		alert(Msg.toString());
		var rtnToday=GetToday(xDeptNo,xEmpNo,xTCGroupID,DocUnid);
		return rtnToday;
	}
	var xHoliday=GetTagName(root,"Holiday");
	//Change by Polly, 開放可建立假日Timecard, GC201200154, 2012.11.16
/*
	if (xHoliday=="Y" && xAuto!="Y") {
		alert("It's Not your working day, No Need to fill in Timecard");
		var rtnToday=GetToday(xDeptNo,xEmpNo,xTCGroupID,DocUnid);
		return rtnToday;		
	}
*/
	GetDataByChangeDate(root);
	var FutureFlag=f.TmpFutureFlag.value;
	if (FutureFlag=="1"){
		//alert("Pre-Fill in function isn't open. Only can enter Leave hrs in the future date.")
		alert(GetMsg("050","",""));
		//return false;
	}	
	//f.DataDate.value=f.txtDataDate.value;
	//Add by wmmate ,若是假日則Working Hr全為0,2012-12-13
	UpdateAllWHR();
	TotalHours();
	return true;	
}
//Add by wmmate ,若是假日則Working Hr全為0,2012-12-13
function UpdateAllWHR(){
	var xHoliday=f.IsHoliday.value;
	//if (xHoliday!="Y") return "";
	if (xHoliday!="Y") {  //Update by wmmate 2014-06-24->修正開放編輯
		WItemList1.ReDisplay(WItemList1);
		WItemList1.TEDITItemNo(WItemList1.ItemNo);
		return "";
	}
	var aryWKhr=WItemList1.GetFieldArrayValues("WorkHourList");
	for(var i=0;i<aryWKhr.length;i++){
		Item_ReplaceField(WItemList1,i+1,"WorkHourList","0")
	}
	WItemList1.ReDisplay(WItemList1);
}

function GetToday(xDeptNo,xEmpNo,xTCGroupID,DocUnid){
	xDate=f.TmpToday.value;
	var xName=f.CurUserName.value;
	var xCalendarKey=f.Site.value+"^"+f.Location.value+"^"+f.EmpClass.value;		
	var arykey=new Array(xDeptNo,xEmpNo,xTCGroupID,xDate,DocUnid,xCalendarKey);
	var root=GetObjValueXMLData("CHGDATE",arykey,xName);	
	var Msg=GetTagName(root,"MSG");
	if (trim(Msg)==""){
		var xHoliday=GetTagName(root,"Holiday");
		var xAuto=f.AutoCreated.value;	
		if (xHoliday=="Y" && xAuto!="Y"){
			//f.DataDate.value="";
			f.txtDataDate.value="";
			return false;			
		} else {
			//f.DataDate.value=xDate;
			f.txtDataDate.value=xDate;
			GetDataByChangeDate(root);
			return true;
		}	
	}	
	//f.DataDate.value="";
	f.txtDataDate.value="";
	return false;
}
function GetDataByChangeDate(root){	
	var xHoliday=GetTagName(root,"Holiday");
	var xClass=GetTagName(root,"Class");
	var xWeekDay=GetTagName(root,"WeekDay");
	var xWeekID=GetTagName(root,"WeekID");
	var xMaxWH=GetTagName(root,"MaxRegularHour");
	var xCKey=GetTagName(root,"CalendarKey");
	var xDept=GetTagName(root,"Dept");		//Add by Polly, 2012.11.23
	//alert Future Flag
	var xDateIdx1=parseFloat(f.TmpDateIdx1.value);
	var xDateIdx2=parseFloat(GetTagName(root,"DateIdx2").toString());
	var xDateIdx3=parseFloat(GetTagName(root,"DateIdx3").toString());
	var xDateIdxS=parseFloat(GetTagName(root,"DateIdxS").toString());
	var xPreFill=parseFloat(GetTagName(root,"PreFill").toString());				//Add by Polly, 2014.09.02, GC201400150
	CheckDateIdx(xDateIdx1,xDateIdx2,xDateIdx3,xDateIdxS,xPreFill);	
	f.IsHoliday.value=xHoliday;
	if (xHoliday=="Y"){
		f.HolidayFlag.value="1";	
	}else{
		f.HolidayFlag.value="0";	
	}
	f.DeptNo.value=xDept;							//Add by Polly, 2012.11.23
	f.EmpClass.value=xClass;
	f.WeekDay.value=xWeekDay;
	f.MaxRegularHour.value=xMaxWH;
	f.MaxLeaveHour.value=xMaxWH;
	f.CalendarKey.value=xCKey; //"#"+xS+"%"+xL+"%"+xClass+"$"
	//f.CalendarKey.value="#"+f.Site.value+"%"+f.Location.value+"%"+f.EmpClass.value+"$";
	Msg="<Font size='2' color='#808080' face='Arial'>(Remark：Daily Leave Hrs can't be over "+f.MaxLeaveHour.value+" Hrs)</Font>";
	IDDsiplayHTML("ID_MsgLeave",Msg);			
	Msg="<Font size='2' color='#808080' face='Arial'>(Remark：Working Hr is "+f.MaxLeaveHour.value+" Hrs)</Font>";
	IDDsiplayHTML("ID_MsgTotal",Msg);		
	IDDsiplayText("ID_WD",xWeekDay)
	f.WeekID.value=xWeekID;
	if (xHoliday!="Y"){
		Msg="<Font color='#FF0000'>Working Hr can't be less or over than "+xMaxWH+" Hrs !</Font>";
		IDDsiplayHTML("ID_MsgWH",Msg)
		IDDsiplay("ID_MsgWH",true);	
	}else{
		IDDsiplay("ID_MsgWH",false);	
	}
	return true;
}

function CheckDateIdx(xDateIdx1,xDateIdx2,xDateIdx3,xDateIdxS,xPreFill){
//xDateIdx1(Today), xDateIdx2(Timecard Date), xDateIdx3(預填結束), xDateIdxS(預填開始)

	var xAflag=f.AdvanceFlag.value;
	var xFutureFlag="1";
	
	//Change by Polly, 2014.09.02, GC201400150
	if (xDateIdx2<=xDateIdx1){		
		xFutureFlag="0";
	}else{
		xFutureFlag = xPreFill;
	}
/*	}else if(xAflag=="1" && xDateIdx2<=xDateIdx3 && xDateIdx2>=xDateIdxS){
		xFutureFlag="0";
	}else if(xAflag=="1" && xDateIdx2>xDateIdx3){
		xFutureFlag="1";
	}else if(xAflag=="1" && xDateIdx2<xDateIdxS && xDateIdx2>xDateIdx1){	
		xFutureFlag="1";	//
	}
*/
	//-------------------------------------------------------------
	
	if (xFutureFlag=="1"){
		IDDsiplay("ID_AddBtn",false);
		IDDsiplay("ID_AddCus",true);	
		IDDsiplay("ID_TableT",true);
		IDDsiplay("ID_TableAll",false);			
		WItemList1.DeleteAllItem();
		TotalHours();
	}else{
		IDDsiplay("ID_TableT",false);
		IDDsiplay("ID_TableAll",true);	
		WItemList1.TEDITItemNo(WItemList1.ItemNo);	
	}	

	f.TmpFutureFlag.value=xFutureFlag;
	f.TmpDateIdx2.value=(xDateIdx2);
	f.TmpDateIdx3.value=(xDateIdx3);	
	f.TmpDateIdxS.value=(xDateIdxS);		
}

//Total Hours
function TotalHours(){
var aryWH=WItemList1.GetFieldArrayValues("WorkHourList");
var aryOH=WItemList1.GetFieldArrayValues("OTHourList");
var aryOB=WItemList1.GetFieldArrayValues("OBHourList");
var tWH=0;
var tOH=0;
var tBH=0;
var tSum=0;
	
	for(var i=0;i<aryWH.length;i++){
		//WorkHours
		var xWH=trim(aryWH[i].toString());
		if(xWH!=""){
			if (IsNumber(xWH)==false)	{
				xWH=0;
			}
		}else{
			xWH="0";			
		}
		tWH+=parseFloat(xWH);
		//Overtime Hours
		var xOH=trim(aryOH[i].toString());	
		if(xOH!=""){
			if (IsNumber(xOH)==false)	{
				xOH="0";
			}	
		}else{
			xOH="0";			
		}	
		tOH+=parseFloat(xOH);
		//Obligation Hours
		var xBH=trim(aryOB[i].toString());	
		if(xBH!=""){
			if (IsNumber(xBH)==false){
				xBH="0";
			}
		}else{
			xBH="0";			
		}		
		tBH+=parseFloat(xBH);		
	}
	//Add Leave
	var tLH=0;
	if (IsNumber(f.LeaveHour.value)==true)	{
		tLH=parseFloat(f.LeaveHour.value);
	}
	tWH+=tLH;	
	//--------------------------
	tWH=FixHours(tWH);
	tOH=FixHours(tOH);
	tBH=FixHours(tBH);	
	//--------------------------
	tSum=tWH+tOH+tBH;
	tSum=FixHours(tSum);
	//--------------------------
	//Add by Polly, 2012.12.12, 為解決7.9999999問題
	/*tWH = FixTotalHours(tWH);
	tOH = FixTotalHours(tOH);
	tBH = FixTotalHours(tBH);
	tSum = FixTotalHours(tSum);*/
	//--------------------------
	//Math.round(((1.09)+(1.98))*100)/100
	f.TotalHour.value=Math.round(tWH*100)/100;
	f.TotalOTHour.value=Math.round(tOH*100)/100;
	f.TotalOBHour.value=Math.round(tBH*100)/100	;	
	f.SumHour.value=Math.round(tSum*100)/100	;
	DisplayHoursMsg(tWH,tOH,tBH);
}

function FixHours(xHr){
	var xf=trim(cright(xHr.toFixed(2),"."));
	if (xf=="00"){
	//tWH=trim(cleft(tWH,"."));
		var FixHr=xHr;
	}else{
		if ((xf.substring(1,2))=="0"){
			FixHr=xHr.toFixed(1);	
		}else{
			FixHr=xHr.toFixed(2);	
		}
	}
	return parseFloat(FixHr)
}
//Display 文字訊息
function DisplayHoursMsg(tWH,tOH,tBH){
	var Allfinishflag=true;
	//Msg-WorkHour
	if (IsNumber(trim(f.MaxRegularHour.value))==false){
		var rWH=0;
	}else{
		var rWH=parseFloat(trim(f.MaxRegularHour.value));
	}	
	var xHoliday=f.IsHoliday.value;
	if (tWH!=rWH && xHoliday!="Y"){
		Msg="<Font color='#FF0000'>Working Hr can't be less or over than "+rWH+" Hrs !</Font>";
		IDDsiplayHTML("ID_MsgWH",Msg)
		IDDsiplay("ID_MsgWH",true);	
		Msg="<Font size='2' color='#808080' face='Arial'>(Remark：Daily Leave Hrs can't be over "+f.MaxLeaveHour.value+" Hrs)</Font>";
		IDDsiplayHTML("ID_MsgLeave",Msg);			
		Msg="<Font size='2' color='#808080' face='Arial'>(Remark：Working Hr is "+f.MaxLeaveHour.value+" Hrs)</Font>";
		IDDsiplayHTML("ID_MsgTotal",Msg);			
		Allfinishflag=false;
	}else{	
		IDDsiplay("ID_MsgWH",false);	
		Msg="<Font size='2' color='#808080' face='Arial'>(Remark：Working Hr is "+f.MaxLeaveHour.value+" Hrs)</Font>";
		IDDsiplayHTML("ID_MsgTotal",Msg);			
	}
	//Msg-OTHour	
	if (IsNumber(trim(f.TotalRealOTHour.value))==false){
		var rOH=0;
	}else{
		var rOH=parseFloat(trim(f.TotalRealOTHour.value));
	}		
	if (tOH!=rOH && rOH>0){
		IDDsiplay("ID_MsgOH",true);	
		Allfinishflag=false;		
	}else{	
		IDDsiplay("ID_MsgOH",false);	
	}	
	//Msg-OBHour		
	if (IsNumber(trim(f.TotalRealOBHour.value))==false){
		var rBH=0;
	}else{
		var rBH=parseFloat(trim(f.TotalRealOBHour.value));
	}		
	if (tBH!=rBH && rBH>0){
		IDDsiplay("ID_MsgBH",true);	
		Allfinishflag=false;		
	}else{			
		IDDsiplay("ID_MsgBH",false);				
	}		
	//if (rWH==tSum)	Allfinishflag=true;		
	if (Allfinishflag==true){
		//Add by Polly, 2013.09.05
		if (xHoliday == "Y" && rOH == 0 && rBH == 0){
			IDDsiplay("ID_MsgAll",false);
		}else{
			IDDsiplay("ID_MsgAll",true);
		}
	}else{
		IDDsiplay("ID_MsgAll",false);			
	}
}
function AddNewItem(){
	//var xDMsg="Please enter Timecard Date first!";
	var xDate=getItemValue(f.txtDataDate); 
	if(xDate==""){
		//alert(xDMsg);
		alert(GetMsg("001","",""));
		return;
	}

//Check CK_CheckCloseFlag&是否已存在相同日期的文件 
	var Msg=CheckAllItem();
	if (Msg!=""){
		alert(Msg);
		return ;
	}
	TotalHours();
	WItemList1.Item_Action_New();
}

function CheckAllItem(){
	var aryKind=WItemList1.GetFieldArrayValues("Obj1KindList");
	var aryObj1=WItemList1.GetFieldArrayValues("Obj1NameList");
	//var aryLoca=WItemList1.GetFieldArrayValues("Attribute18List");
	var aryObj2=WItemList1.GetFieldArrayValues("Obj2NameList");	
	var aryActivity=WItemList1.GetFieldArrayValues("ActivityNameList");		
/*	var xKMsg="Please Select 「Category」";
	var x1NMsg="Please Select 「Objective L1」";
	var xLoMsg="Please Select 「Location」";
	var x2NMsg="Please Select 「Objective L2」";
	var xANMsg="Please Select 「Activity」"; */
	var Msg="";
	for(var i=0;i<WItemList1.ItemNo;i++){	
		if (trim(aryKind[i].toString())==""){
			//Msg="Item No :"+(i+1).toString()+"\n"+xKMsg;
			Msg=GetMsg("033",(i+1).toString(),(i+1).toString());
			return Msg;
		}
		if (trim(aryObj1[i].toString())==""){
			//Msg="Item No :"+(i+1).toString()+"\n"+x1NMsg;
			Msg=GetMsg("034",(i+1).toString(),(i+1).toString());
			return Msg;
		}
		/*  //mark by Polly, 2013.05.31, Location Option 調整不存在 Attribute18List 了!
		//if (trim(aryLoca[i].toString())=="" && trim(aryKind[i].toString())=="Customer" ){ //Add by wmmate 2012-12-24
		if (trim(aryLoca[i].toString())=="" && trim(aryKind[i].toString())=="Customer" && f.LocationDisplay.value=="Y"){
			//Msg="Item No :"+(i+1).toString()+"\n"+xLoMsg;
			Msg=GetMsg("037",(i+1).toString(),(i+1).toString());
			return Msg;
		}
		*/
		if (trim(aryObj2[i].toString())==""){
			//Msg="Item No :"+(i+1).toString()+"\n"+x2NMsg;
			Msg=GetMsg("035",(i+1).toString(),(i+1).toString());
			return Msg;
		}		
		if (trim(aryActivity[i].toString())==""){
			//Msg="Item No :"+(i+1).toString()+"\n"+xANMsg;
			Msg=GetMsg("036",(i+1).toString(),(i+1).toString());
			return Msg;
		}			
	}
	return Msg;
}

function GetL1List(Category){
//DeptCode,L1,Category;
	var DeptCode=f.DeptNo.value;
	var xName=f.CurAbbUserName.value;
	var arykey=new Array(DeptCode,Category);
	var root=GetObjValueXMLData("ObjL1",arykey,xName);
	var xcount=GetTagName(root,"count")
	if (xcount=="0") return false;

	return true;
}


function ActLogWItem(DocUnid,xAction){
	var arykey=new Array(DocUnid,xAction,"");
	var xName=f.CurAbbUserName.value;
	var root=GetObjValueXMLData("ACTLOGWITEM",arykey,xName);
	var MSG=GetTagName(root,"MSG");
	var LOGUID=GetTagName(root,"LOGUID")		
	if (trim(MSG.toString())!=""){
		//alert(MSG);
		alert(ReplaceSubString(MSG.toString(),"@","\n"));
		return "";
	}
	return LOGUID;
}


function FixDate(xd){
res_year = xd.getYear();
res_month = xd.getMonth();
res_date = xd.getDate();
res_hour = xd.getHours();
res_minute = xd.getMinutes();
res_Sec=xd.getSeconds();
res_ms=xd.getMilliseconds();
return res_year+"/"+res_month +"/"+res_date +" "+res_hour+":"+res_minute+":"+res_Sec
}
function ActLogWItemSpec(StartTime,EndTime,Diff){
	var arykey=new Array(StartTime,EndTime,Diff,"");
	var xName=f.CurAbbUserName.value;
	var root=GetObjValueXMLData("ACTLOGWITEMSPEC",arykey,xName);
	var MSG=GetTagName(root,"MSG");
	var LOGUID=GetTagName(root,"LOGUID")		
	if (trim(MSG.toString())!=""){
		//alert(MSG);
		alert(ReplaceSubString(MSG.toString(),"@","\n"));
		return "";
	}
	return "";
	//return LOGUID;

}
//Create Table++++++++++++++++++++++++++++++++++++++++++
function sfAction1_Build(xType,P1,Count){
	try{
		var ItemList=WItemList1;
		var Fields="Obj1KindList,Obj1NameList,Obj1List,Obj1DescList,Obj1GroupList,Pj1TypeList,CustAttrList";
		Fields+=","+"CustNoList,CustRegionList,Attribute18List,Obj2NameList,Obj2List,Obj2DescList,Obj2GroupList";
		Fields+=","+"ActivityNameList,ActivityList,ActivityDescList";
		Fields+=","+"WorkHourList,OTHourList,OBHourList,Remarks";		
		var FNames=Fields.split(",");
		var coll_1=Item_GetFieldValue(ItemList,ItemList.ItemNo,FNames[0]);
		var xItemNo=0;
		if(xType=="NEW"){
			if(trim(coll_1)!=""){
				Count=ItemList.ItemNo+1;
			}else{
				Count=ItemList.ItemNo;
			}
			if(ItemList.ItemNo < Count){
				Item_Array_Insert(ItemList);
			}
			xItemNo=ItemList.ItemNo;
		}else{
			xItemNo=Count+1;
		}
		for(var i=0;i<P1.length;i++){
			Item_ReplaceField(ItemList,xItemNo,FNames[i],P1[i].toString());
		}
	}catch(e){
		alert("e:"+e.message+":"+Count+":"+P1);
	}

}

function sfAction1_Post(){
	var ItemList=WItemList1;
	try{
	}catch(e){
		alert("e:"+e.message);
	}
	ItemList.ReDisplay(ItemList);
}
//*******************************************************************
//動態表格新增列-------------------------------------------------------------------------------------------------------------------------------
function Item_Array_Insert(ItemList){ 
for(var i=0;i< ItemList.AryValues.length;i++){
ItemList.AryValues[i]= ItemList.InsertArrayElement(ItemList.AryValues[i],ItemList.ItemNo+1);
}
ItemList.ItemNo=ItemList.AryValues[0].length;
}
//內容帶入動態表格指定列及欄位-----------------------------------------------------------------------------------------------------------
function Item_ReplaceField(ItemList,xNo,FName,FValue){
ItemList.AryValues[ItemList.GetFieldNameArrayLoc(FName)][xNo-1]=FValue;
}

//取得動態表格指定列及欄位------------------------------------------------------------------------------------------------------------------
function Item_GetFieldValue(ItemList,xNo,FName){
return ItemList.AryValues[ItemList.GetFieldNameArrayLoc(FName)][xNo-1];
}

//於後端取得資料
function GetObjValueXMLData(xtype,vField,xName){
     var f=document.forms[0];
	var source = new ActiveXObject('Microsoft.XMLDOM');
	source.async = false;
	var Link="/"+f.rDbPath.value+"/(agXMLGetObjValue)?OpenAgent&xtype="+xtype+"&";
	//alert(vField.length)
	var xkey="";
	for (var i = 0; i <vField.length; i++) {
		if (xkey!="") xkey+="&";
		xkey+="xkey"+(i+1).toString()+"="+vField[i];
	}
	xkey+="&";
	Link+=xkey;
	if (trim(xName)!=""){
		Link+="xName="+xName+"&";
	}	
	
	//var Link="/"+f.rDbPath.value+"/(agXMLGetObjValue)?OpenAgent&xview="+xView+"&xkey="+xKey+"&xfield="+xField;
	source.load(Link);
	var root = source.documentElement;
	//alert(root.xml)
	return root;
}

//傳XML回來依TagName取得資料清單
function GetListTagName(root,xtagName){
try{
return root.getElementsByTagName(xtagName);
}catch(e){
return "";
}
}
//傳XML回來依TagName取得單一資料
function GetTagName(root,xtagName){
try{
return root.getElementsByTagName(xtagName)[0].text;
}catch(e){
return "";
}
}

//控制ID的style display
function IDDsiplay(IDName,IsDisplayfalg){
	if (IsDisplayfalg==true){
		document.getElementById(IDName).style.display="block";
	}else{
		document.getElementById(IDName).style.display="none";
	}
}

function IDDsiplayText(IDName,xText){
	if (trim(xText.toString())=="") xText=" ";
	document.getElementById(IDName).innerText=xText;
}

function IDDsiplayHTML(IDName,xText){
	if (trim(xText.toString())=="") xText=" ";
	document.getElementById(IDName).innerHTML=xText;
}

function IsNumber2(s)
{
    var isN=!isNaN((s));
    if (isN==false) return false;
    if (s.length>1){
    		if (s.substring(0,1)=="0"){
    			if (s.split(".").length<=1) {
				return false;
			}	
    			var arys=s.split(".");
    			if (arys.length>2) return false;
	
	  }	
	  if (s.split("-").length>1) return false;
	  return true;  		
    }
    return true;  
}

//小數點位數限2位
function checkCash(strCash ) 
{ 
    var re=cright(strCash,".")
   if (re.length>2)
     { 
	return false;
     }
     return true; 
 }

//Add by Polly, 2012.12.12
function FixTotalHours(xHr){
	var xf = trim(xHr.toString());
	if (checkCash(xf) == true){
		var FixTHr = xHr;
	}else{
		var ret = trim(cright(xf,".")).substring(0,5);
		if (ret == "99999"){
			var FixTHr = xHr.toFixed(0);
		}else{
			var FixTHr = xHr;
		}
	}
	return parseFloat(FixTHr)
}
//Add by wmmate 2013-01-11
function GetMsg(xCode,aryEngP,aryChP){
	if (IsArray(aryEngP)==true){
		EngPList=Implode(aryEngP,"@");
	}else{
		EngPList=aryEngP;
	}
	if (IsArray(aryChP)==true){
		ChPList=Implode(aryChP,"@");
	}else{
		ChPList=aryChP;
	}
	aryP=new Array(xCode,EngPList,ChPList);
	var root=GetObjValueXMLData("UIMSG",aryP,"");
	var vMsg=GetListTagName(root,"MSG");
	var xRes="";
	for (var i = 0; i <vMsg.length; i++) {
		if (xRes!="") xRes+="\n";
		//xRes+=(vMsg[i].text);
		xRes+=ReplaceSubString(vMsg[i].text,"@","\n");
	}
	//alert(xRes);
	if (trim(xRes)=="") xRes="Error Message!\nPlease contact with the system administrator!\nMessage Code:"+xCode;
	return xRes;
}
//限制填寫項目最多 ? 項---Add by wmmate 2013-04-17
function CheckItemListLimit(WMItemList,xLimitNo){
//xLimitNo:限制筆數
	if ((WMItemList.ItemNo+1)>xLimitNo){
		alert(GetMsg("130","",""));
		return false;
	}
	return true;
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function OpenCustomer(){

	
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
var display_url="";
var TarListObj="";
var chkHelp="";
function showmenuie5(thisitem){
TarListObj=thisitem;
document.all.WMie5menu.style.left=document.body.scrollLeft+event.clientX;
document.all.WMie5menu.style.top=document.body.scrollTop+event.clientY-100;
window.status="SL:"+document.body.scrollLeft+",ST:"+document.body.scrollTop+"X:"+event.clientX +",Y:"+event.clientY;
try{
document.frames("WMie5menu").document.all["TableMenuShowNo"].innerText="NO."+TarListObj.CurrentNo;
document.frames("WMie5menu").TarListObj=TarListObj;
}catch(e){
}

//document.all.WMie5menu.TarListObj=TarListObj;
document.all.WMie5menu.style.visibility="visible";
return false
}

function hidemenuie5(){
document.all.WMie5menu.style.visibility="hidden"
}



function WMItemListCenter(){
var AllItemList=new Array();
	function Add(ItemListObj){
		this.AllItemList.length++;
		this.AllItemList[this.AllItemList.length-1]=ItemListObj;
	}
	function Add(ItemListObj){
		this.AllItemList.length++;
		this.AllItemList[this.AllItemList.length-1]=ItemListObj;
	}
	function UpdateAll(){
		if(this.AllItemList.length >0){
			for(var i=0;i<this.AllItemList.length;i++){
				if(this.AllItemList[i].DisplayMode=="Edit"){
					this.AllItemList[i].setInputToArray(this.AllItemList[i].ItemEdit,this.AllItemList[i].CurrentNo);
					window.status+="update:"+this.AllItemList[i].ObjVarName ;
					this.AllItemList[i].Edit_Out();
					this.AllItemList[i].MapArrayToField();					
					this.AllItemList[i].ReDisplay();	
				}else{
					this.AllItemList[i].MapArrayToField();
				}
			}
		}
	}

this.AllItemList=AllItemList;
this.Add=Add;
this.UpdateAll=UpdateAll;
}
var WM_ItemListCenter=new WMItemListCenter();



function WMItemList(TargetDoc,NewVarObjName,TemplateTableID,ShowItemListID,IsReadOnly,xTableType,PostDisplayRun){
/*
IsReadOnly=true:read mode/false:edit Mode
TableType="2" 清單型
*/

// ----------------------------------------------
var DocTarget=TargetDoc;
var classkey=TemplateTableID+"Item";
var AryFieldNames;
var AryValues=new Array();
var AryItemNo=new Array();
var ItemSampleTable;
var ItemEmptyTable;
var ItemHeader;
var ItemDisplay;
var ItemEdit;
var TableStyle;
var ItemNo=1;
var TopTag;
var ShowItemList;
var CurrentNo=0;
var ObjVarName=NewVarObjName;
var DisplayMode=(IsReadOnly==true)?"Dispaly":"Edit"; // Dispaly/Edit
var BackItemDisplay="";
var BackItemEdit="";
var BackItemHeader="";
var BackItemEmptyTable="";
var ShowMenu=true;
var EditQuest="";
var HiddenItem; // 在edit mode中被 edit table hidden的 item
var NewItem; // 新產生的 read item
var CurDisplayNo=0; // 目前 builditem產生的xNo;
var CurDisplayItem; // 目前 builditem產生的xNo;
try{
this.EditQuest=EditQuest;
this.GetID=GetID;
this.DisplayClassList=DisplayClassList;
this.InitItemList=InitItemList;
this.buildShowItem=buildShowItem;
this.MapFieldToArray=MapFieldToArray;
this.RemoveAllChild=RemoveAllChild;
this.Item_Action_Insert=Item_Action_Insert;
this.InsertArrayElement=InsertArrayElement;
this.CopyArrayElement=CopyArrayElement;
this.Item_Action_Delete=Item_Action_Delete;
this.DeleteArrayElement=DeleteArrayElement;
this.CheckTaleItemValue=CheckTaleItemValue;
this.setArrayToInput=setArrayToInput;
this.resetInsertItemId=resetInsertItemId;
this.SwapItemArrValue=SwapItemArrValue;
this.IsEmptyItemValues=IsEmptyItemValues;
this.MapArrayToField=MapArrayToField;
this.DeleteHTMLField=DeleteHTMLField;
this.BuildHTMLField=BuildHTMLField;
this.EDITItemNo=EDITItemNo;
this.DispOut=DispOut;
this.DeleteAllItem=DeleteAllItem;

this.CurDisplayNo=CurDisplayNo;
this.CurDisplayItem=CurDisplayItem;

this.ShowMenu=ShowMenu;
this.CurrentNo=CurrentNo;
this.ObjVarName=ObjVarName;

this.getItemValue_T=getItemValue_T;
this.setItemValue_T=setItemValue_T;
this.InitBackItem=InitBackItem;
if(NewVarObjName==null) return false;
if(NewVarObjName=="undefined") return false;
this.BackItemEmptyTable=BackItemEmptyTable;
this.BackItemHeader=BackItemHeader;
this.BackItemDisplay=BackItemDisplay;
this.BackItemEdit=BackItemEdit;
this.DocTarget=DocTarget;
this.classkey=classkey;
this.AryFieldNames=AryFieldNames;
this.AryValues=AryValues;
this.AryItemNo=AryItemNo;
this.ItemSampleTable=ItemSampleTable;
this.ItemEmptyTable=ItemEmptyTable;
this.ItemHeader=ItemHeader;
this.ItemDisplay=ItemDisplay;
this.ItemEdit=ItemEdit;
this.ItemNo=ItemNo;
this.HiddenItem=HiddenItem;
this.NewItem=NewItem;
this.TopTag=TopTag;
this.TableStyle=xTableType;
this.ShowItemList=ShowItemList;
this.DisplayMode=DisplayMode;
this.DisabledCurentEdit=DisabledCurentEdit;
this.ReDisplay=ReDisplay;
this.setInputToArray=setInputToArray;
this.Item_Action_MoveUp=Item_Action_MoveUp;
this.Item_Action_New=Item_Action_New;
this.Item_Action_MoveDown=Item_Action_MoveDown;
this.Item_Action_Copy=Item_Action_Copy;
this.TEDITItemNo=TEDITItemNo;
this.GetFieldValueByNo=GetFieldValueByNo;
this.GetFieldArrayValues=GetFieldArrayValues;
this.GetFieldNameArrayLoc=GetFieldNameArrayLoc;
this.GetFieldValues=GetFieldValues;
this.GetDispListItemObjByFieldName=GetDispListItemObjByFieldName;
// ----------------------------------------------

// ----Public FLAG------------------------------
//this.ShowMenu=ShowMenu;
//this.CurrentNo=CurrentNo;
//this.ObjVarName=ObjVarName;

//-----------------Public Metho --------------
//this.ReDisplay=ReDisplay;
//this.setInputToArray=setInputToArray;
//this.Item_Action_MoveUp=Item_Action_MoveUp;
//this.Item_Action_New=Item_Action_New;
//this.Item_Action_MoveDown=Item_Action_MoveDown;
//this.Item_Action_Copy=Item_Action_Copy;
//this.TEDITItemNo=TEDITItemNo;
//this.GetFieldValueByNo=GetFieldValueByNo;
//this.GetFieldArrayValues=GetFieldArrayValues;
//this.GetFieldNameArrayLoc=GetFieldNameArrayLoc;
//this.GetFieldValues=GetFieldValues;
//----------------- Metho END --------------

//-----------------Public EVENT --------------
this.Can_Swap=Can_Swap;
this.Post_Edit=Post_Edit;
this.Post_Copy=Post_Copy; // blue 2007/09/28
this.Edit_Out=Edit_Out;
this.Post_DisplayItem=Post_DisplayItem;
//----------------- EVENT END --------------

//-----------------Prevate EVENT --------------
this.Edit_MouseOut=Edit_MouseOut;
this.PreEdit_In=PreEdit_In;
//----------------- EVENT END --------------

this.InitBackItem(TemplateTableID);
var FieldNames=GetAllFieldNames(this.BackItemDisplay);
this.MapFieldToArray(FieldNames);
if(PostDisplayRun){
	try{
	eval("this.Post_DisplayItem="+PostDisplayRun+";");
	}catch(e){
		alert("Assign Post_DisplayItem Event Error!");
	}
}
this.InitItemList(TemplateTableID);
this.DisplayClassList(this.GetID(ShowItemListID));
if(this.DisplayMode=="Edit"){
	this.setArrayToInput(this.ItemEdit,this.CurrentNo);
}
if(this.TableStyle=="2"){

}else{
	this.GetID(ShowItemListID).setAttribute("ListItem",this.ObjVarName);
}
WM_ItemListCenter.Add(this);
}catch(e){
	alert(this.ObjVarName +" Init Error!:"+e.message);
}
}
function DispOut(){
	window.event.cancelBubble = true;
	var ItemName=GetParentListDisplay(event.srcElement);
	window.status=ItemName+ "MouseOut";	
	var obj=eval(ItemName);
	obj.setInputToArray(obj.ItemEdit,obj.CurrentNo);
}
function Can_Swap(){
	return true;
}
function Post_Edit(){
	return true;
}
function Post_Copy(){
	return true;
}
function GetID(xid){
var xObj;
try{
	xObj=this.DocTarget.getElementById(xid);
}catch(e){
	xObj=window.document.getElementById(xid);
}
if( xObj==null || xObj=="" ) xObj= GetChildNode(this.ItemEmptyTable,xid);
return xObj;
}

function DisplayClassList(tagetListobj){
	this.ShowItemList=tagetListobj;
	this.RemoveAllChild(tagetListobj);
	if(this.DisplayMode=="Edit" && this.ShowMenu==true){
		tagetListobj.innerHTML="<div style='TEXT-ALIGN: left; margin-left:55px; color:#0000ff'>"+chkHelp+"</div>"+this.ItemEmptyTable.outerHTML;
	}else{
		tagetListobj.innerHTML=this.ItemEmptyTable.outerHTML;
	}
	
}

function InitBackItem(ItemListId){
	this.TopTag=this.GetID(ItemListId);
	this.ItemSampleTable=GetID(ItemListId);
	if(this.TableStyle=="2"){
		FixTableStyle2ItemID(this.ItemSampleTable);
	}	
	this.BackItemEmptyTable=this.ItemSampleTable.childNodes(0).cloneNode(true);
	this.BackItemEmptyTable.id=this.classkey;
	this.RemoveAllChild(this.BackItemEmptyTable);
	this.BackItemHeader=this.GetID(ItemListId+"Header");
	this.BackItemDisplay=this.GetID(ItemListId+"Display").cloneNode(true);
	this.BackItemDisplay.id=this.classkey+"_"+this.BackItemDisplay.id;
	this.BackItemEdit=this.GetID(ItemListId+"Edit").cloneNode(true);
}

function InitItemList(ItemListId){
	this.TopTag=this.GetID(ItemListId);
	this.ItemSampleTable=GetID(ItemListId);
	this.RemoveAllChild(this.ItemEmptyTable);
	this.ItemEmptyTable=this.BackItemEmptyTable.cloneNode(true);
	this.ItemHeader=this.BackItemHeader.cloneNode(true);
	this.ItemDisplay=this.BackItemDisplay.cloneNode(true);
	if (!this.ItemEdit){
	this.ItemEdit=this.BackItemEdit.cloneNode(true);
	this.ItemEdit=this.GetID(ItemListId+"Edit");		
	}
	this.ItemEmptyTable.appendChild(this.ItemHeader);	

	if(this.DisplayMode=="Edit"){	
		try{		
		this.ItemEdit.style.display="Block";
		}catch(e){

		}
		var xItemEdit=this.ItemEmptyTable.appendChild(this.ItemEdit);
		xItemEdit.removeNode(true);

	}
	for(var i=0;i <this.ItemNo ;i++){
		var xNoItem=this.ItemDisplay.cloneNode(true);
		this.NewItem=xNoItem;
		xNoItem.style.display="Block";	
		this.buildShowItem(xNoItem,(i+1));
		this.ItemEmptyTable.appendChild(xNoItem);
	}
}

function buildShowItem(xNoItem,xNo){
		var allTD;
		var xTD;
		var xFieldName="";

		try{
		xNoItem.id=this.ItemEmptyTable.id+"_No_"+xNo;
		}catch(e){
		xNoItem.id=this.BackItemEmptyTable.id+"_No_"+xNo;
		}
		try{
		if(this.DisplayMode=="Edit"){
			var xPara=this.ObjVarName+".ItemEdit,"+this.ObjVarName+".CurrentNo";
			 xNoItem.onMouseOver="this.title='click to edit'";
			 xNoItem.onClick=this.ObjVarName+'.EditQuest='+xNo+';setTimeout("'+this.ObjVarName+'.PreEdit_In('+xNo+')",100)';
		}
		allTD=xNoItem.all;
		
		for(var k=0; k < allTD.length;k++){
			xTD=allTD[k];
			xFieldName=xTD.getAttribute("FieldName");
			if(xFieldName!=null){
			    if(xFieldName=="W_ItemNo"){
				    xTD.innerText=xNo;
			    }else{
					//xTD.innerHTML=ReplaceSubString(ReplaceSubString(ReplaceSubString(this.GetFieldValueByNo(xFieldName,xNo-1),"; ",";"),"\r\n","<BR>"),"\n","<BR>")
					xTD.innerHTML=ReplaceSubString(ReplaceSubString(ReplaceSpec(this.GetFieldValueByNo(xFieldName,xNo-1),"; ",";"),"\r\n","<BR>"),"\n","<BR>")
			    }
			}
		}
		try{
		this.CurDisplayNo=xNo;
		this.CurDisplayItem=xNoItem;
			this.Post_DisplayItem();
		}catch(e){
			alert("Error! Post_DisplayItem"+e.message);
		}
	}catch(e){
				alert(this.ObjVarName+" buildShowItem:"+e.message+":"+e.description+":"+xNoItem);
	}
}

function MapFieldToArray(strFieldNames){

	this.AryFieldNames=strFieldNames.split(",");

	this.AryValues.length=this.AryFieldNames.length;
	
	for(var i=0;i<this.AryValues.length;i++){
		this.AryValues[i]=this.GetFieldValues(this.AryFieldNames[i]);
	}
	this.ItemNo=this.AryValues[0].length;
	this.AryItemNo.length=this.AryValues[0].length;
	for(var i=0;i<this.AryValues[0].length;i++){
		this.AryItemNo[i]=i+1;
	}
	if(this.IsEmptyItemValues(this.AryValues)==true){
		this.AryItemNo[0]="1";
		this.ItemNo=1;
	}
}
function GetFieldValues(FieldName){
	var xres=new Array();
	var xitems=this.DocTarget.getElementsByName(FieldName)
	try{
		xres=xitems[0].value.split("; ");
	}catch(e){
		alert(this.ObjVarName+" Error!GetFieldValues:"+FieldName + "->"+e.message+":"+e.description);
	}
	return xres;
}
function GetFieldArrayValues(FieldName){
// 取得欄位在陣列中的數值
	var xloc=this.GetFieldNameArrayLoc(FieldName);
	var xres;
	if(xloc==null){
		xres="";
	}else{
		xres=this.AryValues[xloc];
	}
	return xres;
}

function GetFieldValues_BK(FieldName){
	var xres=new Array();
	var xitems=this.DocTarget.getElementsByName(FieldName)
	xres.length=xitems.length
	for(var i=0;i<xres.length;i++){
		xres[i]=xitems[i].value;
	}
	return xres;
}

function RemoveAllChild(xobj){
  try{
  	for(var i=0; i< xobj.childNodes.length;){
  		xobj.removeChild(xobj.childNodes(0));
  	}
  }catch(e){
  }
}

function GetFieldValueByNo(FieldName,xLoc){
 try{
	var xFloc=this.GetFieldNameArrayLoc(FieldName);
	if(xFloc==null) return "";
	if(0 > xLoc|| xLoc >= this.AryValues[xFloc].length) return "";
	return this.AryValues[xFloc][xLoc];
 }catch(e){
	alert(this.ObjVarName+" Error!GetFieldValueByNo:"+xLoc+"."+FieldName+"->"+e.message+":"+e.description);
 	return "";
 }	
}
function GetFieldNameArrayLoc(FieldName){
	try{
		for(var i=0;i<this.AryFieldNames.length;i++){
			if(this.AryFieldNames[i]==FieldName) return i;
		}
	}catch(e){
		alert(this.ObjVarName+" Error!GetFieldNameArrayLoc:"+FieldName+"->"+e.message+":"+e.description);
	}
		return null;
}

function Item_Action_Insert(xItemLoc){

if(this.CurrentNo>0) this.setInputToArray(this.ItemEdit,this.CurrentNo);
if(this.CheckTaleItemValue(xItemLoc)==false) return false;
if(this.IsEmptyItemValues(this.AryValues)==true){
	 //alert("IsEmpty:"+xItemLoc);
}else{
  for(var i=0;i< this.AryValues.length;i++){
	this.AryValues[i]= this.InsertArrayElement( this.AryValues[i],xItemLoc);
  }	
  this.ItemNo=this.AryValues[0].length;
  ReDisplay(this);
  this.TEDITItemNo(xItemLoc+1);
}
}



function InsertArrayElement(xArry,xloc){
var newelement;
var newarray
if(xloc==0){
	newarray=  new Array("");
}else{
	var xarryLeft=xArry.slice(0,xloc);
	var xarryRight=xArry.slice(xloc,xArry.length);
	newelement =  new Array("");
	newarray=xarryLeft.concat(newelement);
	newarray=newarray.concat(xarryRight);
}
return newarray;  
}

function CopyArrayElement(xArry,xSNo,xTNo){
 for(var i=0;i< this.AryValues.length;i++){
	this.AryValues[i][xTNo-1]= this.AryValues[i][xSNo-1];
 }
}

function Item_Action_Delete(xNo){
 if( 1>xNo ||  xNo >  this.ItemNo) return false;
if(this.ItemEdit) this.setInputToArray(this.ItemEdit,this.CurrentNo);
 for(var i=0;i< this.AryValues.length;i++){
	this.AryValues[i]= this.DeleteArrayElement( this.AryValues[i],xNo);
 }

if(this.IsEmptyItemValues(this.AryValues)==true){
	this.ItemNo=  1;
}else{
	this.ItemNo=this.AryValues[0].length;
}
ReDisplay(this);
this.CurrentNo=0;
if(xNo <=	this.ItemNo){
	this.TEDITItemNo(xNo);
}else{
	this.TEDITItemNo(this.ItemNo);
}

}

function DeleteArrayElement(xArry,xNo){
var newarray;
if(xNo == 0){
	newarray=new Array("");
	return newarray;
}
var xarryLeft=xArry.slice(0,xNo-1);
var xarryRight=xArry.slice(xNo,xArry.length);
newarray=xarryLeft.concat(xarryRight);
if(newarray.length<1) newarray=new Array("");
return newarray;  
}
function CheckTaleItemValue(xNo){
return true;
}

function setInputToArray(xItemEdit,xNo){
  var allobj;
  var xFieldName;
  var xFN=new Array("");
  var xEFN=new Array("");
  var xRes;
  if(xNo<1 || xNo > this.ItemNo) return false;
  
  allobj=xItemEdit.all;
  for(var i=0;i<allobj.length;i++){  			
 			xFieldName=allobj[i].getAttribute("FieldName");
			if(xFieldName!=null){

			    if(xFieldName=="W_ItemNo"){
				    //				  
			    }else{
			    		if(xFN[0]==""){
			    			xFN[0]=allobj[i].name;
			    			xEFN[0]=xFieldName;
			    		}else{
			    			if(Member(allobj[i].name,xFN) == -1 ){
			    				xFN[xFN.length]=allobj[i].name;
			    				xEFN[xEFN.length]=xFieldName;
			    			}
			    		}
				}
			}
  }

  for(var i=0;i<xFN.length;i++){
 			xFieldName=xFN[i];
			    if(xFieldName=="W_ItemNo"){
				    //
			    }else{
			           //alert(xFieldName);
			           if(eval("this.DocTarget.forms[0]."+xFieldName)!=null) {
						xRes=this.getItemValue_T(eval("this.DocTarget.forms[0]."+xFieldName));
						try{
						this.AryValues[this.GetFieldNameArrayLoc(xEFN[i])][xNo-1]=xRes.join(",");
						}catch(e){
							alert(this.ObjVarName+" Error!Field "+xEFN[i]+"->"+e.message+":"+e.description);
						}
					}
				}
  }
//	this.MapArrayToField(); //blue mark20070116
	if(this.HiddenItem) this.buildShowItem(this.HiddenItem,xNo);
	this.CurrentNo=xNo;
}

function setInputToArray_T(xItemEdit,xNo){
  var allobj;
  var xFieldName;
  var xRes;
  if(xNo<1 || xNo > this.ItemNo) return false;
  
  allobj=xItemEdit.all;
  var xItem=this.GetID(this.ItemEmptyTable.id+"_No_"+xNo);
  for(var i=0;i<allobj.length;i++){
 			xFieldName=allobj[i].getAttribute("FieldName");
			if(xFieldName!=null){
			    if(xFieldName=="W_ItemNo"){
				    //
			    }else{
					xRes=this.getItemValue_T(allobj[i]);
					//xRes=ReplaceSubString(ReplaceSubString(ReplaceSubString(xRes,"; ",";"),"\r\n","<BR>"),"\n","<BR>");
					xRes=ReplaceSubString(ReplaceSubString(ReplaceSpec(xRes,"; ",";"),"\r\n","<BR>"),"\n","<BR>");
					this.AryValues[this.GetFieldNameArrayLoc(xFieldName)][xNo-1]=xRes.join(",");
				}
			}
  }
  
	this.CurrentNo=xNo;
}


function setArrayToInput(xItemEdit,xNo){
 var allobj;
 var xFieldName;
 var xRes;
 if(xNo<1 || xNo > this.ItemNo){
 	allobj=xItemEdit.all;
 	try{
	   	for(var i=0;i<allobj.length;i++){
 				xFieldName=allobj[i].getAttribute("FieldName");
				if(xFieldName!=null){
					if(xFieldName=="W_ItemNo"){
						allobj[i].innerText="";
				    	xRes="";
					}else{
						xRes=this.setItemValue_T(allobj[i],"");
					}
				}
 		}
 	}catch(e){
 	}
	this.CurrentNo=0; 
 }else{
 	try{
 	allobj=xItemEdit.all;
  	for(var i=0;i<allobj.length;i++){
 			xFieldName=allobj[i].getAttribute("FieldName");
			if(xFieldName!=null){
				if(xFieldName=="W_ItemNo"){
			    		var xHTML='<input type="button" value="'+xNo+'" onclick="showmenuie5('+this.ObjVarName+');window.event.cancelBubble=true;" ParentItem="'+this.ObjVarName+'">';
			    		if(this.ShowMenu!=true){
				    		xHTML=xNo;
			    		}
					allobj[i].innerHTML=xHTML;
//					allobj[i].innerText=xNo;
				    xRes=xNo;
				}else{
					try{
					xRes=this.AryValues[this.GetFieldNameArrayLoc(xFieldName)][xNo-1];
					xRes=ReplaceSubString(xRes,"<BR>","\n");
					if(xRes==" ") xRes="";
					xRes=this.setItemValue_T(allobj[i],xRes);
					}catch(e){}
				}
			}
 	}
 	}catch(e){
 		window.status+=","+xFieldName;
 	}
 	this.CurrentNo=xNo;
 }
}

function resetInsertItemId(xNo){
var xItem ;
var xid="";
	for(var i=xNo+1;i <= this.ItemNo;i++){
		xItem=this.GetID(this.ItemEmptyTable.id+"_No_"+i);
		try{
			xid=xItem.id;
		 	xItem.id=this.ItemEmptyTable.id+"_No_"+(i+1);	  
		}catch(e){
		}
	}
}

function SwapItemArrValue(xNo1,xNo2){

var xtmp;
 if( 1>xNo1 ||  xNo1 >  this.ItemNo) return false;
 if( 1> xNo2 ||  xNo2 > this.ItemNo) return false;

 for(var i=0;i< this.AryValues.length;i++){
	xtmp=this.AryValues[i][xNo1-1];
	this.AryValues[i][xNo1-1]=this.AryValues[i][xNo2-1];
	this.AryValues[i][xNo2-1]=xtmp;
 }

}

function Item_Action_MoveUp(xNo){

	var NextNo=xNo-1;
	if(xNo==1) return void(false);

	this.setInputToArray(this.ItemEdit,this.CurrentNo);
	this.SwapItemArrValue(xNo,NextNo);
	ReDisplay(this);
try{	
		this.TEDITItemNo(NextNo);
	}catch(e){
		alert("up:"+e.number+":"+e.description+"\n"+NextNo+"\n->"+e.message+":"+e.description);
	}
}

function Item_Action_New(){
	this.Item_Action_Insert(this.ItemNo);
}

function Item_Action_MoveDown(xNo)	{
	if(xNo==this.ItemNo) return void(false);
	var NextNo=xNo+1;
	this.setInputToArray(this.ItemEdit,this.CurrentNo);
	this.SwapItemArrValue(xNo,NextNo);
	ReDisplay(this);
	this.TEDITItemNo(NextNo);
}

function Item_Action_Copy( xNo){
 this.setInputToArray(this.ItemEdit,this.CurrentNo);
   this.Item_Action_New();
 this.CopyArrayElement(this.AryValues,xNo,this.ItemNo);
 this.setArrayToInput(this.ItemEdit,this.ItemNo);
 this.TEDITItemNo(this.ItemNo);
  this.Post_Copy(); 
}

function IsEmptyItemValues(AryItems){
	var flag=true;
	try{
	 for(var i=0;AryItems.length;i++){
	 	if(AryItems[i].length >1){
	 		flag=false;
	 		break;
	 	}
	 	if(AryItems[i][0]!=""){
	 		flag=false;
	 		break;
	 	}
	 }
	}catch(e){
		 flag=true;
	}
	return  flag;
}

function MapArrayToField(){

	for(var i=0;i< this.AryFieldNames.length;i++){
		try{
		this.DeleteHTMLField(this.AryFieldNames[i]);
		this.BuildHTMLField(this.AryFieldNames[i],this.AryValues[i])
		}catch(e){
		alert("e:"+e.message);
		}
	}
}

function DeleteHTMLField(FieldName){
	var fobjs=this.DocTarget.getElementsByName(FieldName)
		if(fobjs){
			// Is array
			for(var k=0;k<fobjs.length ;k++){
				fobjs[k].value="";
				fobjs[k].removeNode(false);
			}
		}else{
			// isn't array
//			fobjs.outerHTML="";
		}
}

function BuildHTMLField(FieldName,aryValues){
	var TmpNode;
	for(var i=0; i<aryValues.length;i++){
			TmpNode=this.DocTarget.createElement("INPUT");
			TmpNode.name=FieldName;
			TmpNode.type="hidden";
			//TmpNode.value=(aryValues[i]==""?" ":ReplaceSubString(ReplaceSubString(ReplaceSubString(aryValues[i],"; ",";"),"\r\n","<BR>"),"\n","<BR>"));
			TmpNode.value=(aryValues[i]==""?" ":ReplaceSubString(ReplaceSubString(ReplaceSpec(aryValues[i],"; ",";"),"\r\n","<BR>"),"\n","<BR>"));
			this.DocTarget.forms[0].appendChild(TmpNode);
		}
}

function TEDITItemNo(xNo){
//alert(xNo);
window.status="Tedit:"+xNo + " aCNo:"+this.CurrentNo;
	if(	this.Can_Swap()==false) return false;
	this.EDITItemNo(xNo);
	this.Post_Edit();
}

function EDITItemNo(xNo){
	var PreNo=this.CurrentNo;
	if( 1>xNo ||  xNo >  this.ItemNo){
		return false;
	}

	if( xNo != this.CurrentNo){
		hidemenuie5();
	}else{
		return true;
	}

	try{
			if(this.CurrentNo!=0){
				try{		
					var PreTo=this.AryValues[0].length;
				 	this.setInputToArray(this.ItemEdit,this.CurrentNo);
					var PosTo=this.AryValues[0].length;
				}catch(e){
					alert(this.ObjVarName+" 2:"+this.ItemEmptyTable.id+"_No_"+this.CurrentNo+"\n"+e.number+":"+e.description);
				}
			}

	}catch(e){
	}
//	alert(this.ItemEmptyTable.id+"_No_"+xNo);
	var xNoItem=GetID(this.ItemEmptyTable.id+"_No_"+xNo);
	if( !xNoItem) xNoItem= GetChildNode(this.ItemEmptyTable,this.ItemEmptyTable.id+"_No_"+xNo);
	if( !xNoItem) xNoItem=window.document.getElementById(this.ItemEmptyTable.id+"_No_"+xNo);
	if( !xNoItem){
		xNoItem=this.NewItem;
	}
	try{	
			try{
				if(this.HiddenItem){
					try{
					this.buildShowItem(this.HiddenItem,PreNo);
					}catch(e){
						alert("call buildShowItem("+this.HiddenItem.id+","+PreNo+"):"+"->"+e.message+":"+e.description);
					}
					var xxx=this.ItemEdit.swapNode(this.HiddenItem);
					this.HiddenItem.style.display="block";
					this.ItemEdit.style.display="none";	
					this.ItemEdit.removeNode(true);
					this.ItemEdit=this.BackItemEdit.cloneNode(true);
				}
			}catch(e){
				alert("xPreNoItem:ShowError:"+this.ItemEmptyTable.id+"_No_"+PreNo+"->"+e.message+":"+e.description);
		}
//		alert(xNoItem.id);
		try{
		xNoItem.style.display="block";
		this.ItemEdit.style.display="block";
		}catch(e){
			alert("e3:"+e.message+":"+e.description+":");
		}
		try{
		if(!xNoItem) alert("No xNoItem:"+this.ItemEmptyTable.id+"_No_"+xNo);
		
		var xxx=this.ItemEdit.swapNode(xNoItem);
		}catch(e){
			alert("e:"+e.message+":"+e.description+":"+xNoItem);
		}
		this.HiddenItem=xNoItem;
		this.HiddenItem.style.display="block";
	}catch(e){
		alert("e1:"+e.message+":"+e.description+":"+xNoItem);
		alert(this.ItemEmptyTable.id+"_No_"+xNo);
		allChildNode(this.ItemEmptyTable);		
	}
	
			
	try{
		this.ItemEdit.style.display="block";
		this.ItemEdit.PID=this.ObjVarName;
		if(this.TableStyle=="2"){
			this.ItemEdit.parentNode.setAttribute("ListItem",this.ObjVarName);
			this.ItemEdit.parentNode.attachEvent("onmouseout",this.Edit_MouseOut);			
		}else{
			this.ItemEdit.attachEvent("onmouseout",this.Edit_MouseOut);		
		}
	}catch(e){
		alert("e5"+e.message+":"+e.description);
	}
	try{
		this.setArrayToInput(this.ItemEdit,xNo);	
	}catch(e){
		alert("e2:"+e.message+":"+e.description+":");
	}
}

function Edit_MouseOut()
{
	window.event.cancelBubble = true;
	var ItemName=GetParentListDisplay(event.srcElement);
	var toItemName=GetParentListDisplay(event.toElement);
	var tnae,snae;
//	window.status="s:"+event.srcElement.tagName+"--"+"t:"+event.toElement.tagName;
	if(toItemName!=null){	
		if(toItemName!=ItemName && toItemName!="ListItemMenu"){
			try{
					var obj=eval(ItemName);
					obj.setInputToArray(obj.ItemEdit,obj.CurrentNo);
					window.status+="update:"+ItemName ;
					obj.Edit_Out();
			}catch(e){
						window.status="";
			}

		}else{
			window.status="";
		}
	}
}
function Edit_Out(){
	window.status+=" Edit_Out";
	return true;
}
function getItemValue_T(itemobject){
	var xres=new Array();
	var len=itemobject.length;
	var k=0;

		if(itemobject.tagName=="TEXTAREA"){
//			xres=itemobject.value.split('\n');
			xres[0]=itemobject.value;
		}else if(itemobject.type=="text" ||  itemobject.type=="password" || itemobject.type=="hidden" || itemobject.type=="file"){	
			xres[k]=itemobject.value;
		}else if(itemobject.type=="select-one"){
				for(var m=0;m < itemobject.options.length;m++){
					if(itemobject.options[m].selected){
//						xres[k++]=itemobject.options[m].text;
						xres[k++]=itemobject.options[m].value;
						if(xres[k-1]=="") xres[k-1]=itemobject.options[m].text;
					}
				}		
		}else if(itemobject.type=="select-multiple"){
				for(var m=0;m < itemobject.options.length;m++){
					if(itemobject.options[m].selected){
						//xres[k++]=itemobject.options[m].text;
						xres[k++]=itemobject.options[m].value;
						if(xres[k-1]=="") xres[k-1]=itemobject.options[m].text;
					}
				}			
		}else 	if(itemobject.type=="radio"){
					if(itemobject.checked){
						xres[0]=itemobject.value;
					}else{
						xres[0]="";
					}
		}else if(itemobject.length >0){
			if(itemobject[0].type=="radio"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					if(x.checked){
						xres[k++]=x.value;
					}
				}
			}else if(itemobject[0].type=="checkbox"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					if(x.checked){
						xres[k++]=x.value;
					}
				}
			}else 	if(itemobject[0].type=="text" ||  itemobject[0].type=="password" || itemobject[0].type=="hidden" || itemobject[0].type=="file"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					xres[k++]=x.value;
				}

			}else{
				var txttemp=itemobject[0].innerHTML;
				txttemp=ReplaceSubString(txttemp,"<BR>","\n");
				xres[0]=txttemp.innerText;
			//	xres[0]=itemobject[0].innerText;
			}
		}else{
				var txttemp=itemobject.innerHTML;
				txttemp=ReplaceSubString(txttemp,"<BR>","\n");
				xres[0]=txttemp.innerText;
		//		xres[0]=itemobject.innerText;
		}
	return xres;
}


function setItemValue_T(itemobject,values){
// use ","separate
	var xvalues=values.split(",");
//	alert(typeof(itemobject)+"-"+itemobject.type+"-"+itemobject.length);
	var len=xvalues.length;
	var k=0;
	switch(itemobject.type){
		case "textarea":
			itemobject.value=ReplaceSubString(values,"<BR>","\n");
			break;
		case "text":
		case "password":
		case "hidden":
		case "file":
			itemobject.value=values;
				break;
	case "select-one":
					var xflag=false;
				for(var m=0;m < itemobject.options.length;m++){
					var x1=itemobject.options[m].value==""?itemobject.options[m].text:itemobject.options[m].value;
					if(itemobject.options[m].text==values || x1==values){
						itemobject.options[m].selected=true;
						xflag=true;
					}
				}
				if(xflag==false && trim(values)!="" ){
					itemobject[itemobject.length] = new Option( values, values, false, false );
					itemobject.options[itemobject.length-1].selected=true;
				}
						break;
	case "select-multiple"	:
					for(var m=0;m < itemobject.options.length;m++){
						itemobject.options[m].selected=false;
					}
					var xflag=false;
				for(n=0;n<xvalues.length;n++){
					xflag=false;
					for(var m=0;m < itemobject.options.length;m++){
						var x1=itemobject.options[m].value==""?itemobject.options[m].text:itemobject.options[m].value;
						if(itemobject.options[m].text==xvalues[n] || x1==xvalues[n]){
							itemobject.options[m].selected=true;
							xflag=true;
						}
					}
					if(xflag==false && trim(values)!=""){
					// 值不在選項中
					itemobject[itemobject.length] = new Option( xvalues[n], xvalues[n], false, false );
					itemobject.options[itemobject.length-1].selected=true;
					}	
				}
						break;				
		case "checkbox"	:
				var xflag=false;
				var x=itemobject;
				var x1=x.nextSibling.nodeValue;
				x.checked=false;
				for(var i=0 ;i<len;i++){		
					if(x.value==xvalues[i] || x1==xvalues[i]){
						x.checked=true;
						xflag=true;
					}
				}
						break;
		case "radio":
						var xflag=false;
				var x=itemobject;
				var x1=x.nextSibling.nodeValue;
				for(var i=0 ;i<len;i++){		
					if(x.value==xvalues[i] || x1==xvalues[i]){
						x.checked=true;
						xflag=true;
					}
				}
				if(xflag!=true){
					x.checked=false;
				}
						break;
		default :
   	itemobject.innerHTML=ReplaceSubString(ReplaceSubString(ReplaceSpec(values,"; ",";"),"\r\n","<BR>"),"\n","<BR>");						
	//itemobject.innerHTML=ReplaceSubString(ReplaceSubString(ReplaceSubString(values,"; ",";"),"\r\n","<BR>"),"\n","<BR>");						
				break;
	}
}


function allparentNode(xNode){
var xT=xNode.parentNode;
var xM="PN:\n"+xNode.id +":"+xNode.tagName+"\n";;
for(;xT!=null;){
try{
xM+=xT.id +":"+xT.tagName+"\n";
xT=xT.parentNode;
}catch(e){
xM+="err";
break;
}
}
//alert(xM);
}
function allChildNode(xNode){
var xT;
var xM="PN:\n"+xNode.id +":"+xNode.tagName+"\n";;
if(xNode.hasChildNodes()) {
return null;
}
for(var i=0;xNode.childNodes.length;i++){
try{
xM+=xNode.childNodes(i).id +":"+xNode.childNodes(i).tagName+"\n";

}catch(e){
xM+="err";
break;
}
}
//alert(xM);
}
function GetChildNode(xNode,xcid){
var xT;
if(!xNode) return null;
if(xNode.hasChildNodes()) return null;
for(var i=0;xNode.childNodes.length;i++){
try{
 if(xNode.childNodes(i).id==xcid) return xNode.childNodes(i); 

}catch(e){
break;
}
}
return null;
}
function FixTableStyle2ItemID(xTable){
var xID=xTable.id;
		var xT=xTable.all.tags("TR");
		xT[0].id=xID+"Header";
		xT[1].id=xID+"Edit";
		xT[2].id=xID+"Display";
}
function GetAllFieldNames(DisplayItem){
var items=DisplayItem.all;
var FieldNames="";
	for(i=0;i< items.length;i++){
			xFieldName=items[i].getAttribute("FieldName");
			if(xFieldName!=null && xFieldName!="W_ItemNo"){
				if(FieldNames==""){
					FieldNames=xFieldName;
				}else{
					FieldNames+=","+xFieldName;
				}
			}
	}
	return FieldNames;
}

function GetParentListDisplay(xobj){
/*
Edti Mode Mouse out Event Get Which Mouse out ItemList
*/
var pobj;
var xItemListName=null;
	if(xobj){
		if(xobj.parentElement){
				for(pobj=xobj.parentElement;pobj!=null;pobj=pobj.parentElement){
					xItemListName=pobj.getAttribute("ListItem");
					if(xItemListName!=null) return xItemListName;	
				}
		}
		xItemListName="";
	}
	return xItemListName;
}
function ReDisplay(xItemList){
/*
*/

if(xItemList==null) xItemList=this;
//xItemList.ShowItemList.style.display="none";
xItemList.RemoveAllChild(xItemList.ItemEmptyTable);
xItemList.ItemEmptyTable=xItemList.BackItemEmptyTable.cloneNode(true);
xItemList.ItemHeader=xItemList.BackItemHeader.cloneNode(true);
xItemList.ItemDisplay=xItemList.BackItemDisplay.cloneNode(true);
xItemList.ItemEdit=xItemList.BackItemEdit.cloneNode(true);
xItemList.ItemEmptyTable.appendChild(xItemList.ItemHeader);	
for(var i=0;i <xItemList.ItemNo ;i++){
	var xNoItem=xItemList.ItemDisplay.cloneNode(true);
	xNoItem.style.display="block";	
	xItemList.buildShowItem(xNoItem,(i+1));
	xItemList.ItemEmptyTable.appendChild(xNoItem);
}	

xItemList.DisplayClassList(xItemList.ShowItemList);

 try{
	if(this.HiddenItem) this.HiddenItem.removeNode(true);
	if(this.ItemEdit) this.ItemEdit.removeNode(true);
	if(this.CurrentNo) this.CurrentNo=0;
	if(this.NewItem) this.NewItem=null;
	
 }catch(e){
 }
// xItemList.ShowItemList.style.display=Isdispaly;
		return true;
}

function PreEdit_In(ItemNo){
	if(ItemNo== this.EDITItemNo) return false;
	if(this.EditQuest!=ItemNo) return false;
	window.status+="PreEdit_In:"+ItemNo;	
	this.TEDITItemNo(ItemNo);
}
function Post_DisplayItem(){
		return true;
}
function DeleteAllItem(){
/*
刪除itemlist內的全部項目
*/
	var xtemp=new Array("");
 	for(var i=0;i< this.AryValues.length;i++){	
	this.AryValues[i]=new Array("");
 	}
	this.ItemNo=  1;
	this.CurrentNo=0;
	ReDisplay(this);
}
function DisabledCurentEdit(){
/*
取消目前的編輯ITEM mode
*/
	if(this.CurrentNo==0) return false;
	this.setInputToArray(this.ItemEdit,this.CurrentNo);
	if(this.HiddenItem){
		try{
			this.buildShowItem(this.HiddenItem,this.CurrentNo);
		}catch(e){
			alert("call buildShowItem("+this.HiddenItem.id+","+this.CurrentNo+"):"+"->"+e.message+":"+e.description);
		}
		var xxx=this.ItemEdit.swapNode(this.HiddenItem);
		this.HiddenItem.style.display="block";
		this.ItemEdit.style.display="none";	
		this.ItemEdit.removeNode(true);
		this.ItemEdit=this.BackItemEdit.cloneNode(true);
		this.HiddenItem=null;
		this.CurrentNo=0;
	}
}

function GetDispListItemObjByID(DisplayItem,objid){
var items=DisplayItem.all;
var xobjid="";
var targetobj=null;
	for(i=0;i< items.length;i++){
			xobjid=items[i].id;
				if(xobjid==objid){
					targetobj=items[i];
					break;
				}
	}
	return targetobj;
}
function GetDispListItemObjByFieldName(DisplayItem,FieldName){
var items=DisplayItem.all;
var xFieldName="";
var targetobj=null;
	for(i=0;i< items.length;i++){
		xFieldName=items[i].getAttribute("FieldName");
		if(xFieldName!=null){
			    if(xFieldName==FieldName){
	    				targetobj=items[i];
					break;	
			    }
		}
	}
	return targetobj;
}


//Add by wmmate 2013-07-08
function ReplaceSpec(SourceString, SubString, ReplaceString){
	var newValue='';	
	var subflag=true;
	newValue=SourceString;
	while (subflag==true){
			rtn=ReplaceSubStringfalg(newValue,SubString,ReplaceString);
			subflag=rtn[0];
			newValue=rtn[1];
	}
	return newValue;
}

function ReplaceSubStringfalg( SourceString, SubString, ReplaceString){
	startpos = 0;
	endpos = -1;
	var rtnValue=new Array(false,'');
	NewString = '';
	LenSubString = SubString.length;
	LenSourceString = SourceString.length;	
	while ( endpos < LenSourceString){
		endpos = SourceString.indexOf( SubString, startpos);
		endpos = ( endpos < 0) ? LenSourceString : endpos;
		if (endpos!=LenSourceString){
			NewString = NewString + SourceString.substring( startpos, endpos) + ReplaceString;
			startpos = endpos + LenSubString;
			rtnValue[0]=true;
		}else{
			NewString = NewString + SourceString.substring( startpos, endpos)
		}
	}
	rtnValue[1]=NewString;
	return rtnValue;
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 

function showifProcess(){
	var f=document.forms[0];
	if (f.GTDocNoDsp.value=="") {
	  var xkey=f.CDocID.value;
	}else{
	  var xkey=f.GTDocNoDsp.value;
	}
	newurl = "/"+f.rDbPath.value+"/vsysfSignRecordWeb?openview&count=-1&sKey="+xkey;
	ifProcess = document.getElementById("ifProcess");
	ifProcess.location.href = newurl;	
	
}
function dyniframesize(iframename) {  
	var xtar= null;  
	if (document.getElementById){
		xtar= document.getElementById(iframename);
	}else{  
		eval('xtar = ' + iframename + ';');
	}
	if (xtar && !window.opera){
		xtar.style.display="block"        
		if (xtar.contentDocument && xtar.contentDocument.body.offsetHeight){
      		//ns6 syntax     
			xtar.height = xtar.contentDocument.body.offsetHeight+FFextraHeight; 
		}else if (xtar.Document && xtar.Document.body.scrollHeight){
      		//ie5+ syntax  
			//xtar.width = xtar.Document.body.scrollWidth+15;
			xtar.height = xtar.Document.body.scrollHeight;
		}
	}
}
//********************************************Create TimeCard Sign Record*************************************
function TWTimeCardTableHTML(WID){
var TitleList="Log";
var FieldList="WMSignComment";
var WidthList="100%";
var AlignList="left";
var type1=";";
 var f=document.forms[0];  
 var Title=new Array();
 var FieldName=new Array();
 var BeginHTML="<TABLE id='Table1'  border='0' cellspacing='0' cellpadding='2'  width='100%' align='center' no wrap>";
 var EndHTML="</TABLE>";
 var fTitle=""; 
 var fFieldInfo="";
 var fName="";
 var Footer="";
 var outHTML="";
 var tno=0;
 var wd=new Array();
 var AG=new Array();
 var xcolor="";
 explode(WidthList,";",wd);
 explode(AlignList,";",AG);
 explode(TitleList,";",Title);
 explode(FieldList,";",FieldName);
  for (i=0;i<Title.length;i++){
      fTitle=fTitle+"<TD WIDTH='"+wd[i]+"' BGCOLOR='0060A0'><DIV ><FONT SIZE=2 COLOR='FFFFFF' FACE='Arial'>"+Title[i]+"</FONT></DIV></TD>"  
    } 
	var fd1=new Array(); 
    	explode(document.forms[0][FieldName[0]].value,type1,fd1);			
tno=fd1.length;
for (i=0;i<tno;i++){
		var xTWComment_1="";
		var xTWComment_Other="";
		var xTWFiles="";
		var showitem=true;
          xstyle="border-bottom:1px dashed #ccc"; //格線
		if(showitem){
    	       fFieldInfo=fFieldInfo+"<TR  VALIGN=top>"
      	  if(Word(document.forms[0]["WMSignStatus"].value,";",i+1).indexOf("Cancal")>-1){
      	  	xcolor="FF0000";
      	  }else{
	      	  xcolor="0000FF";
      	  }
		  for (j=0;j<FieldName.length;j++){
				fFieldInfo=fFieldInfo+"<TD WIDTH='"+wd[j]+"' Style='"+xstyle+"'><DIV ALIGN="+AG[j]+"><FONT SIZE=2 COLOR='000000' FACE='Arial,Arial'>"+Word(document.forms[0][FieldName[j]].value,type1,i+1)+"</FONT></DIV></TD>";
		  } 
		  fFieldInfo=fFieldInfo+"</TR>" 
		  		  j=0; 
		 }
} 
outHTML=BeginHTML+fTitle+fFieldInfo+EndHTML;
document.all(WID).innerHTML=outHTML;
return true;
}
//********************************************Create Attachment Sign Record*************************************

function TWGenerateTableHTML(WID){
var TitleList="簽核站別;部門;姓名;簽核時間;簽核結果";
var FieldList="WMSignStation;WMSignDept;WMSignName;WMSignTime;WMSignStatus";
var WidthList="20%;18%;10%;25%;*";
var AlignList="left;left;left;left;left";
var type1=";";
 var f=document.forms[0];  
 var Title=new Array();
 var FieldName=new Array();
 var BeginHTML="<TABLE id='Table1'  border='0' cellspacing='0' cellpadding='2'  width='100%' align='center' no wrap>";
 var EndHTML="</TABLE>";
 var fTitle=""; 
 var fFieldInfo="";
 var fName="";
 var Footer="";
 var outHTML="";
 var tno=0;
 var wd=new Array();
 var AG=new Array();
 var xcolor="";
 explode(WidthList,";",wd);
 explode(AlignList,";",AG);
 explode(TitleList,";",Title);
 explode(FieldList,";",FieldName);
  for (i=0;i<Title.length;i++){
      fTitle=fTitle+"<TD WIDTH='"+wd[i]+"' BGCOLOR='A9B6CD'><DIV ><FONT SIZE=2 COLOR='FFFFFF' FACE='Arial'>"+Title[i]+"</FONT></DIV></TD>"  
    } 
	var fd1=new Array(); 
    	explode(document.forms[0][FieldName[0]].value,type1,fd1);			
tno=fd1.length;
for (i=0;i<tno;i++){
		var xTWComment_1="";
		var xTWComment_Other="";
		var xTWFiles="";
		var showitem=true;
          xstyle="border-bottom:1px dashed #ccc"; //格線
		if(showitem){
    	       fFieldInfo=fFieldInfo+"<TR  VALIGN=top>"
      	  if(Word(document.forms[0]["WMSignStatus"].value,";",i+1).indexOf("Cancal")>-1){
      	  	xcolor="FF0000";
      	  }else{
	      	  xcolor="0000FF";
      	  }
		  for (j=0;j<FieldName.length;j++){
				fFieldInfo=fFieldInfo+"<TD WIDTH='"+wd[j]+"' Style='"+xstyle+"'><DIV ALIGN="+AG[j]+"><FONT SIZE=2 COLOR='000000' FACE='Arial,Arial'>"+Word(document.forms[0][FieldName[j]].value,type1,i+1)+"</FONT></DIV></TD>";
		  } 
		  fFieldInfo=fFieldInfo+"</TR>" 
		  		  j=0; 
		 }
} 
outHTML=BeginHTML+fTitle+fFieldInfo+EndHTML;
document.all(WID).innerHTML=outHTML;
return true;
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function RunAction(action){
  var f=document.forms[0];
  if (CheckItem(action)==false) {
	return false;
  }
  if (saveflagprocess()==false) return false;  //下方
  
  f.NowAction.value=action;
}

function ProcessComment(IsEdit,Action,xcmd,NeedInput){

  if(xcmd=="-1" ){ // 按下取消
	return false;
  }    
  var f=document.forms[0];
  var resMsg;
  var xurl=f.rDbPath.value+"/ProcessAction?openAgent";
  var Docuid=f.dispUID.value;
  var ckres;
  if(NeedInput){
	if(xcmd==""){ // 沒有輸入內容
       //alert("Please enter comment.");
       alert(GetMsg("047","",""));
	  return false;
	}
  }
  if (saveflagprocess()==false) return false;  //下方  
  if(IsEdit==true){
     var xxcmd=ReplaceSubString(xcmd,'\n','<br>');
	f.tmpComment.value=xxcmd;
	RunAction(Action);
	f.submit();
  }else{
      if(xcmd==""){ xcmd=" "};
      var cm=xcmd;
      xurl="/"+xurl+"&Action=" +encodeURIComponent(Action) +"&Docuid="+Docuid+"&Cmd="+encodeURIComponent(cm)+"&CurUser="+encodeURIComponent(f.CurUserName.value)+"&xOtr="+"&";
      
      var post_xmlHttp=createXMLHttpRequest();
      post_xmlHttp.open("POST",xurl,false);
      post_xmlHttp.send();      
      var returnXML = post_xmlHttp.responseXML;
     // alert(returnXML.xml)
      var root = post_xmlHttp.responseXML.getElementsByTagName("root");
      if (root!=null) {
          ckres = post_xmlHttp.responseXML.getElementsByTagName("status")[0].childNodes[0].nodeValue;
         if (ckres!="Nothing"){          	
           alert(ckres);
           WM_ShowActionList();
           if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }
           return false;
         }
         ckres = post_xmlHttp.responseXML.getElementsByTagName("nextSigner")[0].childNodes[0].nodeValue;
         ckres=ReplaceSubString(unescape(ckres),'$^$','\n');
          //if (f.IsShowNextMsg.value!="N") alert(ckres);
          if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }         
      }   
     if (window.frameElement==null){
          if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }      
         window.open('','_parent','');
         window.opener=null;
         window.close();
      }else{
         f.OpenInBoxid.click();
      }
   }
}

function Web_InputComment(){
  var f=document.forms[0];
  var xurl="/"+f.rDbPath.value+"/Web_Comment?openform";
  var Docuid=f.dispUID.value;
  var xres=window.showModalDialog(xurl,Docuid,"dialogHeight: 250px; dialogWidth: 450px; dialogTop: 200px; dialogLeft: 200px; edge: Raised; center: Yes; help: No; resizable: Yes; status: No;");
  if (typeof(xres)=="undefined") xres="-1";
  return xres;
}

function saveflagprocess() {
   var f = document.forms[0];
   WM_HiddenActionList();
   if (f.isEdit.value=="0") return true;   
     f.addattflag.value = "";
   //}
   if (window.frameElement==null){
      f.hasopener.value = "Y";
   }else{
      f.hasopener.value = "N";
   }
   f.saveflag.value="True";
}

function CheckItem(Action) {
  var f=document.forms[0];
  var RCheck=false;
  var ErrMsg="";
  var xStation="";
  //欄位檢查
  xStation=f.CurFlowStepNoDsp.value;  
  if ((xStation=="0001") && (Action=="Save")) {   
      RCheck=ApplySaveCheck();
      return RCheck;
      //return true;
  //-----------------------------------------------------------
  }else if ((xStation=="0001") && (Action=="Submit")) { 
  	 RCheck=ApplySubmitCheck();
  	 //RCheck=true;
  	 if (RCheck==true){
  	 	//var RCheck=confirm("Are you sure you want to \""+Action+"\" document?");
  	 	WM_ItemListCenter.UpdateAll();			//Add by Polly, 2014.07.05
  	 	var RCheck=confirm(GetMsg("129", Action, Action));
  	 }
      return RCheck;  	 
  //----------------------------------------------------------- 
  }else if ((xStation=="0010") && (Action=="Review")) { 
  	 RCheck=ReviewCheck();
  	 if (RCheck==true){
  	 	//var RCheck=confirm("Are you sure you want to \""+Action+"\" document?");
  	 	var RCheck=confirm(GetMsg("129", Action, Action));
  	 }  	 
      return RCheck;  	 
  //-----------------------------------------------------------     
  }else if ((xStation=="0010") && (Action=="Reject")) { 
  	 RCheck=RejectCheck();
  	 if (RCheck==true){
  	 	//var RCheck=confirm("Are you sure you want to \""+Action+"\" document?");
  	 	var RCheck=confirm(GetMsg("129", Action, Action));
  	 }  	   	 
      return RCheck;  	 
  //-----------------------------------------------------------   
  }else if ((xStation=="0020") && (Action=="處理完成")) { //回覆處理人員
  //-----------------------------------------------------------  
    if (trim(f.Answer.value)==""){
      alert("請輸入 Answer !!");
      return false;
    }
  }
  RCheck=true;
  return RCheck;
}
//申請人按下「儲存」時檢查
function ApplySaveCheck(){
	var xDMsg="Please enter Timecard Date first!";
	var xEMsg="Please enter Name first!";
	var xDeptNo=f.DeptNo.value;
	var xEmpNo=trim(f.EmpNo.value);
	var xTCGroupID=f.TCGroupID.value;
	var xDate=trim(f.txtDataDate.value);
	var DocUnid=f.MainDocUNID.value;
	var xName=f.CurUserName.value;
	//Add by wmmate 2013-08-12--->	
	var xCalendarKey=f.Site.value+"^"+f.Location.value+"^"+f.EmpClass.value;		
	//<-----------------------------------------	
	if (xDate==""){
		//alert(xDMsg);
		alert(GetMsg("001","",""));
		return false;
	}else if (xEmpNo==""){
		alert(GetMsg("048","",""));
		return false;	
	}else {
		//Add  xCalendarKey by wmmate 2013-08-12--->		
		//var arykey=new Array(xDeptNo,xEmpNo,xTCGroupID,xDate,DocUnid,f.NewDoc.value);
		var arykey=new Array(xDeptNo,xEmpNo,xTCGroupID,xDate,DocUnid,f.NewDoc.value,xCalendarKey);
		//<-----------------------------------------		
		var root=GetObjValueXMLData("CHSAVE",arykey,xName);
		var Msg=GetTagName(root,"MSG");	
		if (trim(Msg)!=""){
			Msg=ReplaceSubString(Msg,"@","\n");
			alert(Msg.toString());			
			return false;
		}else{
			//Add by wmmate 2013-08-12--->
			GetDataByChangeDate(root);		
			//<-----------------------------------------
			var xAuto=f.AutoCreated.value;
			var xHoliday=f.IsHoliday.value;
			var rOThr=GetHr("TotalRealOTHour");
			var rOBhr=GetHr("TotalRealOBHour");
			//Add by Polly, 2013.09.04, 若是假日則清空 WHr --->
			if (xHoliday=="Y"){
				UpdateAllWHR();
				TotalHours();
				WM_ItemListCenter.UpdateAll();
			}
			//<-----------------------------------------
			if (xHoliday=="Y" && rOThr==0 && rOBhr==0) { //Add by wmmate ,若是假日且rOThr=0且rOBhr=0不能Save,2012-12-13
			//if (xHoliday=="Y" && xAuto!="Y") {
				//alert("It's Not your working day, No Need to fill in Timecard");			
				alert(GetMsg("049","",""));
				return false;		
			}			
		}
	}
	return true;
}
//申請人按下「送件」時檢查
function ApplySubmitCheck(){
	var xDMsg="Please enter Timecard Date first!";
	var xDeptNo=f.DeptNo.value;
	var xEmpNo=trim(f.EmpNo.value);
	var xTCGroupID=f.TCGroupID.value;
	//var xDate=trim(f.DataDate.value);
	var xDate=trim(f.txtDataDate.value);
	var DocUnid=f.MainDocUNID.value;
	var xName=f.CurUserName.value;
	//var xCalendarKey=f.CalendarKey.value;		
	var xCalendarKey=f.Site.value+"^"+f.Location.value+"^"+f.EmpClass.value;	
	if (xDate==""){
		//alert(xDMsg);
		alert(GetMsg("001","",""));
		return false;	
	}else {
		var arykey=new Array(xDeptNo,xEmpNo,xTCGroupID,xDate,DocUnid,f.NewDoc.value,xCalendarKey);
		var root=GetObjValueXMLData("CHSUBMIT",arykey,xName);
		var Msg=GetTagName(root,"MSG");	
		if (trim(Msg)!=""){
			Msg=ReplaceSubString(Msg,"@","\n");
			alert(Msg.toString());			
			return false;
		}else{
			GetDataByChangeDate(root);	
			//Add by Polly, 2013.09.04, 若是假日則清空 WHr --->
			var xHoliday=f.IsHoliday.value;
			if (xHoliday=="Y"){
				UpdateAllWHR();
				TotalHours();
				WM_ItemListCenter.UpdateAll();
			}else{
				TotalHours();
			}
			//<-----------------------------------------
			//TotalHours();				//mark by Polly, 2013.09.04
			if (CheckFuture()==false) return false;
			f.Reviewer.value=GetTagName(root,"Reviewer");	
			document.getElementById("ID_Reviewer").innerText	=f.Reviewer.value;			
			var CheckRtn=CheckAllHous();	
			return CheckRtn;
		}
	}	
	return true;
}
function CheckFuture(){
	var CheckRtn;
	var xChK=false;
	var aryKindObj=WItemList1.GetFieldArrayValues("Obj1KindList");
	if (aryKindObj.length>=1 && trim(aryKindObj[0].toString())!="") xChK= true;
	var FutureFlag=f.TmpFutureFlag.value;
	if (FutureFlag=="1" && xChK==true){
		//alert("預填功能未開啟, 預填未來日期 Timecard 只可填休假(Leave) !");
		//alert("Pre-fill in function isn't turn on. Only can enter Leave hrs for future date Timecard.")
		alert(GetMsg("050","",""));
		return false;
	}
	var rWKhr=GetHr("MaxRegularHour");
	var tLHR=GetHr("LeaveHour");
	if (FutureFlag=="1" && tLHR!=rWKhr){
		//alert("Please enter Leave hour (\""+rWKhr+"\" hrs).")
		alert(GetMsg("051",rWKhr.toString(),rWKhr.toString()));
		return false;
	}
	CheckRtn=CheckLeaveHours();
	if (CheckRtn==false) return false;	
}

//submit check  Hours
function CheckAllHous(){
	var CheckRtn;
	var xHoliday=f.IsHoliday.value;
	var xAuto=f.AutoCreated.value;	
	var rWKhr=GetHr("MaxRegularHour");
	var rOThr=GetHr("TotalRealOTHour");
	var rOBhr=GetHr("TotalRealOBHour");	
	if (xHoliday=="Y" && rOThr==0 && rOBhr==0) { //Add by wmmate ,若是假日且rOThr=0且rOBhr=0不能Submit,2012-12-13
	//if (xHoliday=="Y" && xAuto!="Y") {
			//alert("It's Not your working day, No Need to fill in Timecard");			
			alert(GetMsg("049","",""));			
			return false;		
	}	
	
	var xHoliday=f.IsHoliday.value;
	CheckRtn=CheckItemList(xHoliday,rWKhr,rOThr,rOBhr);	
	if (CheckRtn==false) return false;
	var sumWKhr=GetHr("TotalHour");
	var sumOThr=GetHr("TotalOTHour");
	var sumOBhr=GetHr("TotalOBHour");
	var sumhr=GetHr("SumHour");	
	CheckRtn=CheckTotalHours(xHoliday,rWKhr,rOThr,rOBhr,sumWKhr,sumOThr,sumOBhr);
	if (CheckRtn==false) return false;
	return true;
}
function GetHrVal(FNValue){
	var Rtn=0;
	if (trim(FNValue)!=""){
		if (IsNumber2(trim(FNValue))==true){
			Rtn=parseFloat(trim(FNValue));
		}
	}
	return Rtn;
}
function GetHr(FName){
	var Rtn=0;
	var FNValue=eval("f."+FName).value;
	if (trim(FNValue)!=""){
		if (IsNumber2(trim(FNValue))==true){
			Rtn=parseFloat(trim(FNValue));
		}
	}	
	return Rtn;
}
//不是全天請假則檢查各項時數-->Update Attribute Check by wmmate 2013/05/13
function CheckItemList(xHoliday,rWKhr,rOThr,rOBhr){
	var CheckRtn;	
	//---Get All Attribute Data
	GETATTRAllData();
	for(var i=0;i<aryTroot.length;i++){
		var xTroot=aryTroot[i];
		var xitem=GetTagName(xTroot,"Item");
		//alert( xitem)
	}
	//-------------------------------
	var aryKindObj=WItemList1.GetFieldArrayValues("Obj1KindList");
	var aryL1Obj=WItemList1.GetFieldArrayValues("Obj1List");
	var aryL2Obj=WItemList1.GetFieldArrayValues("Obj2List");
	var aryActObj=WItemList1.GetFieldArrayValues("ActivityList");
	// mark by Polly, 2013.07.03
	//var aryLocObj=WItemList1.GetFieldArrayValues("Attribute18List");
	var aryWKhr=WItemList1.GetFieldArrayValues("WorkHourList");
	var aryOThr=WItemList1.GetFieldArrayValues("OTHourList");
	var aryOBhr=WItemList1.GetFieldArrayValues("OBHourList");	
	//Attribute Obj--------------------------------------------------------------
	var aryL1AttrNoObj=WItemList1.GetFieldArrayValues("L1AttrItemNoList");
	var aryL1AttrDataObj=WItemList1.GetFieldArrayValues("L1AttrItemDataList");
	var aryL2AttrNoObj=WItemList1.GetFieldArrayValues("L2AttrItemNoList");
	var aryL2AttrDataObj=WItemList1.GetFieldArrayValues("L2AttrItemDataList");
	var aryActAttrNoObj=WItemList1.GetFieldArrayValues("ActivityAttrItemNoList");
	var aryActAttrDataObj=WItemList1.GetFieldArrayValues("ActivityAttrItemDataList");
	//<----------------------------------------------------------------------------
	var rWKhr=GetHr("MaxRegularHour");
	var tLHR=GetHr("LeaveHour");
	var tOTRHr=GetHr("TotalRealOTHour");		//Add by Polly, 2013.10.01
	var tOBRHr=GetHr("TotalRealOBHour");		//Add by Polly, 2013.10.01
	if (tOTRHr==0 && tOBRHr==0){					//Add by Polly, 2013.10.01, 有OT一定要有填寫項目
		if (aryKindObj.length==0 && rWKhr==tLHR) return true;
		if (aryKindObj.length==1 && trim(aryKindObj[0].toString())=="" && rWKhr==tLHR) return true;
	}
	for(var i=0;i<aryWKhr.length;i++){
		//-------------------------------------------	
		CheckRtn=CheckValByField(i,aryKindObj[i],"Category","Category");
		if (CheckRtn==false) return false;		
		CheckRtn=CheckValByField(i,aryL1Obj[i],"Objective L1","Objective L1");
		if (CheckRtn==false) return false;	
		//if (trim(aryKindObj[i].toString())=="Customer" ){ //Add by wmmate 2012-12-17
		// mark by Polly, 2013.07.03
		//if (trim(aryKindObj[i].toString())=="Customer" && f.LocationDisplay.value=="Y" ){
		//	CheckRtn=CheckValByField(i,aryLocObj[i],"Location","Location");
		//	if (CheckRtn==false ) return false;	
		//}	
		CheckRtn=CheckValByField(i,aryL2Obj[i],"Objective L2","Objective L2");
		if (CheckRtn==false) return false;		
		CheckRtn=CheckValByField(i,aryActObj[i],"Activity","Activity");
		if (CheckRtn==false) return false;		
		//Check Attribute---------------------------------
		CheckRtn=CheckAttrItem(i,aryL1AttrNoObj[i],aryL2AttrNoObj[i],aryActAttrNoObj[i]);	
		if (CheckRtn==false) return false;			
		//Check 需為數字---------------------------------
		CheckRtn=CheckIsNumberByItem(i,aryWKhr[i],"Regular","");
		if (CheckRtn==false) return false;
		CheckRtn=CheckIsNumberByItem(i,aryOThr[i],"Overtime","");
		if (CheckRtn==false) return false;		
		CheckRtn=CheckIsNumberByItem(i,aryOBhr[i],"Diligence","");
		if (CheckRtn==false) return false;				
		//Check 不可小於 0-------------------------------
		var xWKhr=GetHrVal(trim(aryWKhr[i]));
		var xOThr=GetHrVal(trim(aryOThr[i]));	
		var xOBhr=GetHrVal(trim(aryOBhr[i]));		
		if (xHoliday!="Y"){
			CheckRtn=ChecklessByItem(i,xWKhr,"應出勤工時","Working Hr");
			if (CheckRtn==false) return false;		
		}
		if (rOThr>0){
			CheckRtn=ChecklessByItem(i,xOThr,"加班工時","Overtime Hr");
			if (CheckRtn==false) return false;				
		}
		if (rOBhr>0){
			CheckRtn=ChecklessByItem(i,xOBhr,"工作投入工時","Diligence Hr");
			if (CheckRtn==false) return false;				
		}	
		//Check不允許為零
		CheckRtn=CheckZeroHrByItem(xHoliday,rWKhr,rOThr,rOBhr,xWKhr,xOThr,xOBhr,i);
		if (CheckRtn==false) return false;
	}	
}


function CheckValByField(i,xValue,CHMsg,ENMsg){
	if ( trim(xValue.toString())==""){
		//alert(CHMsg+" Please Fill in "+ENMsg+" Data (Item " + (i+1) + ") !");
		if (ENMsg=="Category"){
			alert(GetMsg("052",(i+1).toString(),(i+1).toString()));
		}else if (ENMsg=="Objective L1"){
			alert(GetMsg("053",(i+1).toString(),(i+1).toString()));
		}else if (ENMsg=="Objective L2"){
			alert(GetMsg("054",(i+1).toString(),(i+1).toString()));
		}else if (ENMsg=="Activity"){
			alert(GetMsg("055",(i+1).toString(),(i+1).toString()));
// mark by Polly, 2013.07.03
//		}else if (ENMsg=="Location"){
//			alert(GetMsg("119",(i+1).toString(),(i+1).toString()));
		}
		return false;	
	}	
	return true;
}
//Check 需為數字
function CheckIsNumberByItem(i,xhr,CHMsg,ENMsg){
		if(trim(xhr)!="" ){
			if (IsNumber(trim(xhr))==false)	{
				//alert("Please check on "+CHMsg+" hour (item\""+ (i+1) +"\").")
				if (ENMsg=="Working Hr"){
					alert(GetMsg("056",(i+1).toString(),(i+1).toString()));
				}else if (ENMsg=="Overtime Hr"){
					alert(GetMsg("057",(i+1).toString(),(i+1).toString()));
				}else if (ENMsg=="Diligence Hr"){
					alert(GetMsg("058",(i+1).toString(),(i+1).toString()));
				}				
				return false;
			}		
		}
		return true;		
}
//Check 不可小於 0
function ChecklessByItem(i,xhr,CHMsg,ENMsg){
		if (xhr<0){
			//alert(ENMsg+" Can Not less than 0 Hrs (Item " + (i+1) + ") !");
			if (ENMsg=="Working Hr"){
				alert(GetMsg("059",(i+1).toString(),(i+1).toString()));
			}else if (ENMsg=="Overtime Hr"){
				alert(GetMsg("060",(i+1).toString(),(i+1).toString()));
			}else if (ENMsg=="Diligence Hr"){
				alert(GetMsg("061",(i+1).toString(),(i+1).toString()));
			}				
			return false;			
		}
		return true;		
}
function CheckIsNumberByItemX(xWKhr,xOThr,xOThr){
		if(trim(xWKhr)!="" ){
			if (IsNumber(trim(xWKhr))==false)	{
				//alert("Please check on Regular hour (item "+(i+1)+" ).");
				alert(GetMsg("120",(i+1).toString(),(i+1).toString()));
				return false;
			}		
		}
		if(trim(xOThr)!="" ){
			if (IsNumber(trim(xOThr))==false)	{
				//alert("Please check on Overtime hour (item "+(i+1)+" ).");
				alert(GetMsg("121",(i+1).toString(),(i+1).toString()));
				return false;
			}		
		}	
		if(trim(xOThr)!="" ){
			if (IsNumber(trim(xOThr))==false)	{
				//alert("Please check on Diligence hour (item "+(i+1)+" ).");
				alert(GetMsg("122",(i+1).toString(),(i+1).toString()));
				return false;
			}		
		}	
		return true;
}
//Check不允許為零
function CheckZeroHrByItem(xHoliday,rWKhr,rOThr,rOBhr,xWKhr,xOThr,xOBhr,i){
		//'若有實際加班工時及實際工作投入--------------------------------------	
		if (rOThr>0 && rOBhr>0){			
			if (xHoliday!="Y"){
				if (xWKhr==0 && xOThr==0 && xOBhr==0){
						//alert("Working Hr & Overtime Hr / Diligence Hr Can Not be zero in the same time (Item " + (i+1) + ") !");
						alert(GetMsg("062",(i+1).toString(),(i+1).toString()));
						return false;	
				}
			}else{
				if ( xOThr==0 && xOBhr==0){
						//alert("Overtime Hr & Diligence Hr Can Not be zero in the same time (Item " + (i+1) + ") !");
						alert(GetMsg("063",(i+1).toString(),(i+1).toString()));
						return false;	
				}			
			}
		}else if (rOThr>0 && rOBhr<=0){
		//有實際加班工時	
			if (xHoliday!="Y"){
				if (xWKhr==0 && xOThr==0 ){
						//alert("Working Hr & Overtime Hr Can Not be zero in the same time (Item " + (i+1) + ") !");
						alert(GetMsg("064",(i+1).toString(),(i+1).toString()));						
						return false;	
				}			
			}else{
				if ( xOThr==0 ){
					//alert("Overtime Hr Can Not be zero (Item " + (i+1) + ") !");
					alert(GetMsg("065",(i+1).toString(),(i+1).toString()));	
					return false;	
				}
			}		
		}else if (rOBhr>0 && rOThr<=0){
		//有實際工作投入	
			if (xHoliday!="Y"){
				if (xWKhr==0 && xOBhr==0 ){
						//alert("Working Hr & Diligence Hr Can Not be zero in the same time (Item " + (i+1) + ") !")
						alert(GetMsg("066",(i+1).toString(),(i+1).toString()));	
						return false;	
				}					
			}else{
				if ( xOBhr==0 ){
					//alert("Diligence Hr Can Not be zero (Item " + (i+1) + ") !");
					alert(GetMsg("067",(i+1).toString(),(i+1).toString()));	
					return false;	
				}			
			}			
		}else{
			if (xHoliday!="Y"){  //正常工時不能為0	
				if ( xWKhr==0 ){
					//alert("Working Hr Can Not be zero (Item " + (i+1) + ") !");
					alert(GetMsg("068",(i+1).toString(),(i+1).toString()));	
					return false;	
				}					
			}
		}
		//------------------
		return true;	
}
function CheckTotalHours(xHoliday,rWKhr,rOThr,rOBhr,sumWKhr,sumOThr,sumOBhr){
	//每日應出勤工=輸入工時總計
	if (xHoliday!="Y"){
		if (sumWKhr!=rWKhr){
			//alert("Total Working Hr Can Not be less or over than " + rWKhr + " Hrs");
			alert(GetMsg("069",(rWKhr).toString(),(rWKhr).toString()));	
			return false;
		}
	}
	//check 加班時數>0 
	if (rOThr>0){
			if (sumOThr!=rOThr){
				//alert("Total Overtime Hr should be " +rOThr+ " Hrs on this day !");
				alert(GetMsg("070",(rOThr).toString(),(rOThr).toString()));	
				return false;
			}
		}
	//check 工作投入時數>0 		
	if (rOBhr>0){
			if (sumOBhr!=rOBhr){
				//alert("Total Diligence Hr should be " +rOBhr+ " Hrs on this day !");
				alert(GetMsg("071",(rOBhr).toString(),(rOBhr).toString()));	
				return false;
			}
		}		
	
	//--------------
	return true;
}
function CheckLeaveHours(){
	var xHoliday=f.IsHoliday.value;
	var xHours=f.LeaveHour.value;
	
	var xMaxHours=parseFloat(trim(f.MaxLeaveHour.value));
	if (trim(f.LeaveHour.value)=="") f.LeaveHour.value="0";
	if (IsNumber2(trim(f.LeaveHour.value))==false){
		//alert("Please check on  Leave Hour.")
		alert(GetMsg("072","",""));
		f.LeaveHour.value="0";
		return false;
	}else{
		var xHours=parseFloat(trim(f.LeaveHour.value));
	}		
	if (xHours<0){
		//alert("Leave Hr Can Not less then 0 Hr !");
		alert(GetMsg("073","",""));
		return false;	
	}
	if (f.IsHoliday.value=="Y") return true;	
	if (xHours>xMaxHours){
		//alert("Leave Hr Can Not over than your Daily Work Hr ("+xMaxHours+" Hrs) !");
		alert(GetMsg("074",xMaxHours.toString(),xMaxHours.toString()));
		return false;	
	}		
	var sumWKhr=GetHr("TotalHour");
	if (xMaxHours!=sumWKhr){
		//alert("Total Working Hr Can Not be less or over than " + xMaxHours + " Hrs");
		alert(GetMsg("069",xMaxHours.toString(),xMaxHours.toString()));
		return false;	
	}
	var aryKindObj=WItemList1.GetFieldArrayValues("Obj1KindList");
	if (aryKindObj.length==0 ){
			if (xHours!=xMaxHours){
				//alert("If whole day off, please enter Leave hour (\""+xMaxHours+"\" hrs).")
				alert(GetMsg("075",xMaxHours.toString(),xMaxHours.toString()));
				return false;	
			}		
	}else if (aryKindObj.length==1 ){
		if (trim(aryKindObj[0].toString())=="" && xHoliday!="Y"){
			if (xHours!=xMaxHours){
				//alert("If whole day off, please enter Leave hour (\""+xMaxHours+"\" hrs).")
				alert(GetMsg("075",xMaxHours.toString(),xMaxHours.toString()));
				return false;	
			}
		}
	}
	return true;
}
//Review Check
function ReviewCheck(){
		var xUID=f.dispUID.value;
		var xName=f.CurUserName.value;
		var arykey=new Array(xUID);
		var root=GetObjValueXMLData("CHREVIEW",arykey,xName);
		var Msg=GetTagName(root,"MSG");		
		if (trim(Msg)!=""){
			Msg=ReplaceSubString(Msg,"@","\n");
			alert(Msg.toString());			
			return false;
		}
		return true;
}

//Reject Check
function RejectCheck(){
		var xUID=f.dispUID.value;
		var xName=f.CurUserName.value;
		var arykey=new Array(xUID);
		var root=GetObjValueXMLData("CHREJECT",arykey,xName);
		var Msg=GetTagName(root,"MSG");		
		if (trim(Msg)!=""){
			Msg=ReplaceSubString(Msg,"@","\n");
			alert(Msg.toString());			
			return false;
		}
		return true;		
}

//Administrator Action
function ProcessAdminAction(Action,xcmd,NeedInput){
 if(xcmd=="-1" ){ // 按下取消
	return false;
  }    
  var f=document.forms[0];
  var resMsg;
  var xurl=f.rDbPath.value+"/AdministratorAction?openAgent";
  var Docuid=f.dispUID.value;
  var ckres;
  //alert("NeedInput="+NeedInput)
  if(NeedInput){
	if(xcmd==""){ // 沒有輸入內容
       alert("需輸入原因才能變更狀態!");
	  return false;
	}
  }
    if(xcmd==""){ xcmd=" "};
      var cm=xcmd;
      xurl="/"+xurl+"&Action=" +encodeURIComponent(Action) +"&Docuid="+Docuid+"&Cmd="+encodeURIComponent(cm)+"&CurUser="+encodeURIComponent(f.CurUserName.value)+"&xOtr="+"&";
      var post_xmlHttp=createXMLHttpRequest();
      post_xmlHttp.open("POST",xurl,false);
      post_xmlHttp.send();      
      var returnXML = post_xmlHttp.responseXML;
      var root = post_xmlHttp.responseXML.getElementsByTagName("root");
      if (root!=null) {
          ckres = post_xmlHttp.responseXML.getElementsByTagName("status")[0].childNodes[0].nodeValue;
         if (ckres!=""){          	
           alert(ckres);
           if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }
           return false;
         }
         alert("文件狀態已變更!");         
          if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }         
      }   
      if (window.frameElement==null){
          if (window.opener && WinOpen()==true){
           	window.opener.parent.right.location.reload();
           }      
         //window.open('','_parent','');
         //window.opener=null;
         window.close();
      }else{
         f.OpenInBoxid.click();
      }
}
//-------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------
function WinOpen(){
var openerHref=window.opener.location.href.toUpperCase();
	if (openerHref.indexOf("?OPENFORM")>0){
	
	}else if(openerHref.indexOf("?OPENVIEW")>0){
 		return true;
	}
	return false;
}	

function GetAdminMsg(rtnAction){
  	var xmsg="";
 	if (rtnAction=="DRAFT"){
  		xmsg="此功能會將 Timecard 文件回復【寫作中】狀態, 確認執行動作? ";
  	}else if (rtnAction=="SUBMITTED"){
  		xmsg="此功能會將 Timecard 文件回復【已送出】狀態, 確認執行動作? ";
  	}else if (rtnAction=="REVIEWED"){
  		xmsg="此功能會將 Timecard 文件狀態變更為【Reviewed】, 確認執行動作? ";
  	}else if (rtnAction=="DEL"){
  		xmsg="此功能會將 Timecard 文件刪除, 確認執行動作? ";
  	}else if (rtnAction=="REJECT"){
  		xmsg="您確定要退回此份 Timecard 嗎？";
  	}
  	return xmsg;
}

function OpenAdminStyle(){
	var xStyle="dialogHeight:150px; "
	xStyle+="dialogWidth:300px; "
	xStyle+="edge: Raised; "
	xStyle+="center: Yes; "
	xStyle+="help: No; "
	xStyle+="resizable: Yes; "
	xStyle+="status: No;"
	xStyle+="scroll:Yes"
	return xStyle;
}

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function GETATTRAllData(){
	//&&&&&&&&&&&&&&&
	var xDeptNo=f.DeptNo.value;
	var arykey=new Array(xDeptNo);
	Troot=GetObjValueXMLData("GETATTRTITLEBYDEPT",arykey,"");
	var aryData=GetListTagName(Troot,"AttrData");
	aryTroot=new Array();
	aryAroot=new Array();
	for(var i=0;i<aryData.length;i++){
		var xItem=trim(GetListTagName(aryData[i],"Item")[0].text);
		var ItemNo=parseInt(xItem);
		//aryTroot[ItemNo]=aryData[i];	
		aryTroot.push(aryData[i]);	
	}	
	var aryACData=GetListTagName(Troot,"ACAttrData");
	for(var i=0;i<aryACData.length;i++){
		var xItem=trim(GetListTagName(aryACData[i],"Item")[0].text);
		var ItemNo=parseInt(xItem);
		//aryAroot[ItemNo]=aryACData[i];	
		aryAroot.push(aryACData[i]);	
	}		
}
//測試用的唷(CheckAttrItem_OK才是對的)
function CheckAttrItem_Test(xCount,L1AttrNoObjs,L2AttrNoObjs,ActAttrNoObjs){
	//Get PjType/OwningDept
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var aryMaster=GetMasterDataByObj(Obj1);
	//---------------------------------
	var aryAllAttrNo=new Array();
	AddaryAttrItem(aryAllAttrNo,L1AttrNoObjs);
	AddaryAttrItem(aryAllAttrNo,L2AttrNoObjs);	
	//Test>>
	var aryChkAttrNo=new Array();
	//Test
	//L1&L2
	var AttrCommName=new Array();
	var AttrCommflag=false;   //check 10/11/12
	/*for(var i=0;i<aryTroot.length;i++){
		var xitem=GetTagName(aryTroot[i],"Item");	
		 if(xitem=="10" || xitem=="11" || xitem=="12"){
		 	var xName=GetTagName(aryTroot[i],"Name");	
		 	AttrComm.push(xName);
		 }
	}*/
	var arychkCons=new Array("13","14","15","18","17","20","21","16","30","31","33","35");
	//Check_ConsOKind2
	for(var i=0;i<aryTroot.length;i++){
		var xTroot=aryTroot[i];
		var xitem=GetTagName(xTroot,"Item");	
		if (Member(xitem,aryAllAttrNo)==-1){
			//check Attribute Constraint
			aryChkAttrNo.push(xitem);			
			if (xitem=="8" || xitem=="9") {				
				//rtnchk=Check89(xCount,xTroot,aryMaster);
				//if (rtnchk==false) return false;	
			}else if(xitem=="7") {		
				rtnchk=Check7(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;							
			}
		}
	}	
	//EPN特殊檢查&重新計算
	rtnchk=CheckProjEPN(xCount,aryMaster);
	if (rtnchk==false) return false;		
	return true;	

}
function CheckAttrItem(xCount,L1AttrNoObjs,L2AttrNoObjs,ActAttrNoObjs){
	//Get PjType/OwningDept
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var aryMaster=GetMasterDataByObj(Obj1);
	//---------------------------------
	var aryAllAttrNo=new Array();
	AddaryAttrItem(aryAllAttrNo,L1AttrNoObjs);
	AddaryAttrItem(aryAllAttrNo,L2AttrNoObjs);	
	//Test>>
	var aryChkAttrNo=new Array();
	//Test
	//L1&L2
	var AttrCommName=new Array();
	var AttrCommflag=false;   //check 10/11/12
	/*for(var i=0;i<aryTroot.length;i++){
		var xitem=GetTagName(aryTroot[i],"Item");	
		 if(xitem=="10" || xitem=="11" || xitem=="12"){
		 	var xName=GetTagName(aryTroot[i],"Name");	
		 	AttrComm.push(xName);
		 }
	}*/
	var check7flag=false; //Add 2014-01-10
	var arychkCons=new Array("13","14","15","18","17","20","21","16","30","31","33","35");
	//Check_ConsOKind2
	for(var i=0;i<aryTroot.length;i++){
		var xTroot=aryTroot[i];
		var xitem=GetTagName(xTroot,"Item");	
		if (Member(xitem,aryAllAttrNo)==-1){
			//check Attribute Constraint
			aryChkAttrNo.push(xitem);			
			if (xitem=="8" || xitem=="9") {				
				rtnchk=Check89(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;
			}else if(xitem=="3") {
				rtnchk=Check3(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;			
			}else if(xitem=="10" || xitem=="11" || xitem=="12") {		
		 		var xName=GetTagName(xTroot,"Name");	
		 		AttrCommName.push(xName);		
				AttrCommflag=true;		
			}else if(xitem=="4" || xitem=="5") {
				rtnchk=Check45(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;		
			}else if(xitem=="19") {		
				rtnchk=Check19(xCount,xTroot);
				if (rtnchk==false) return false;		
			}else if(Member(xitem,arychkCons)!=-1) {	
				rtnchk=Check_ConsOKind2(xCount,xTroot);
				if (rtnchk==false) return false;		
			}else if(xitem=="7") {
				check7flag=true; //Add 2014-01-10
				rtnchk=Check7(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;			
			}else if(xitem=="2") {		
				rtnchk=Check2(xCount,xTroot,aryMaster);
				if (rtnchk==false) return false;		
			}else if(xitem=="32") {		
				rtnchk=Check32(xCount,xTroot);
				if (rtnchk==false) return false;		
			}else if(xitem=="34") {		
				rtnchk=Check34(xCount,xTroot);
				if (rtnchk==false) return false;			
			}
		}
		
		 if(xitem=="7") check7flag=true;		//Add by Polly, 2014.07.04, 有填要檢查EPN有效性
	}	
	//check 10/11/12
	if (AttrCommflag==true){
		rtnchk=Check10(xCount,xTroot,aryMaster,AttrCommName);
		if (rtnchk==false) return false;		
	}		
	
	//check Activity Attribute	
	var aryAcAttrNo=new Array();
	AddaryAttrItem(aryAcAttrNo,ActAttrNoObjs);	
	for(var i=0;i<aryAroot.length;i++){
		var xAroot=aryAroot[i];
		var xitem=GetTagName(xAroot,"Item");	
		if (Member(xitem,aryAcAttrNo)==-1){
			if (xitem=="1" ){
				rtnchk=CheckAC1(xCount,xAroot);
				if (rtnchk==false) return false;				
			}
		}
	}	
/*	//mark by Polly, 2014.05.22, GC201400062
	//check Activity Job List
	if (Member("2",aryAcAttrNo)==-1){		
		rtnchk=CheckAC2(xCount);
		if (rtnchk==false) return false;		
	}
*/
	//EPN特殊檢查&重新計算
	if (check7flag==true){  //update 2014-01-10
		rtnchk=CheckProjEPN(xCount,aryMaster);	
		if (rtnchk==false) return false;
	}
	return true;
}

function GetMasterDataByObj(xcode){
	var aryRtn=[2];
	var arykey=new Array(xcode);
	var root=GetObjValueXMLData("ObjL1Code",arykey,"");
	aryRtn[0]=GetListTagName(root,"ObjGroup")[0].text;
	aryRtn[1]=GetListTagName(root,"PjType")[0].text;	
	aryRtn[2]=GetListTagName(root,"OwningDept")[0].text;	
	return aryRtn;
}

function Check3(xCount,xroot,aryMaster){
	var xName=GetTagName(xroot,"Name");	
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var ObjAct=WItemList1.GetFieldArrayValues("ActivityList")[xCount];	
	var PType=aryMaster[1];	
	var Inputflag1=false;
	var Inputflag2=false;
	var Inputflag3=false;	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsPType=GetListTagName(xroot,"ConsPType");
	var ConsOCode6=GetListTagName(xroot,"ConsOCode6");	
	//-----------------------------------------------------------------		
	if (trim(ObjAct.toString())!=""){		
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(PType,ConsPType);
		Inputflag3=IsMemberAttr(Obj2,ConsOCode6);
	}   
	//-----------------------------------------------------------------
	if (Inputflag1==true && Inputflag2==true && Inputflag3==true)  return rtnAttrMsg(xName,xCount);	
	return true;	
}

function Check10(xCount,xroot,aryMaster,AttrCommName){
	var xName=GetTagName(xroot,"Name");		
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var PType=aryMaster[1];	
	var Inputflag1=false;
	var Inputflag2=false;	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsPType=GetListTagName(xroot,"ConsPType");
	//-----------------------------------------------------------------	
	if (Obj1!=""){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(PType,ConsPType);		
		/*if (AttrIsArray(ConsOKind)==false) {
			Inputflag1=true;
		}else{			
			for(var i=0;i<ConsOKind.length;i++){				
				if (xCategory==ConsOKind[i].text){
					Inputflag1=true;
				}
			}		
		}
		if (AttrIsArray(ConsPType)==false) {
			Inputflag2=true;		
		}else{
			for(var i=0;i<ConsPType.length;i++){		
				 if (PType==ConsPType[i].text){
					Inputflag2=true;
				}
			}
		}	*/	
	}		
	//-----------------------------------------------------------------		
	if (Inputflag1==true && Inputflag2==true ){
		//var xE=new Array(AttrCommName[0],AttrCommName[1],"",(xCount+1).toString());
		var xAllName=Implode(AttrCommName," , ");
		var xE=new Array(xAllName,(xCount+1).toString());
		var xC=new Array((xCount+1).toString(),xAllName);		
/*		var xE=new Array();
		var xC=new Array();
		xC.push((xCount+1).toString());
		for(var i=0;i<AttrCommName.length;i++){	
			xE.push(AttrCommName[i]);
			xC.push(AttrCommName[i]);
		}
		xE.push((xCount+1).toString());*/
		alert(GetMsg("136",xE,xC));
		return false;	
	}	
	return true;
}

function Check45(xCount,xroot,aryMaster){
	var xName=GetTagName(xroot,"Name");	
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var PType=aryMaster[1];	
	var Inputflag1=false;
	var Inputflag2=false;	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsPType=GetListTagName(xroot,"ConsPType");
	//-----------------------------------------------------------------		
	if (Obj1!=""){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(PType,ConsPType);		
		/*if (AttrIsArray(ConsOKind)==false) {
			Inputflag1=true;
		}else{			
			for(var i=0;i<ConsOKind.length;i++){				
				if (xCategory==ConsOKind[i].text){
					Inputflag1=true;
				}
			}		
		}
		if (AttrIsArray(ConsPType)==false) {
			Inputflag2=true;		
		}else{
			for(var i=0;i<ConsPType.length;i++){		
				 if (PType==ConsPType[i].text){
					Inputflag2=true;
				}
			}
		}	*/	
	}	
	//-----------------------------------------------------------------		
	if (Inputflag1==true && Inputflag2==true)  return rtnAttrMsg(xName,xCount);	
	return true;		
}


function Check89(xCount,xroot,aryMaster){
	var xItem=GetTagName(xroot,"Item");	
	var xName=GetTagName(xroot,"Name");		
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var PType=aryMaster[1];	
	var OwningDept=aryMaster[2];	
	//alert("No="+(xCount+1).toString()+"\nxCategory="+xCategory+"\nPType="+PType)
	var Inputflag1=false;
	var Inputflag2=false;	
	var Inputflag3=false;		
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsPType=GetListTagName(xroot,"ConsPType");
	var ConsOKind1=GetListTagName(xroot,"ConsOKind1");
	var ConsPType1=GetListTagName(xroot,"ConsPType1");
	var ConsDep1=GetListTagName(xroot,"ConsDep1");
	//alert("ConsOKind="+ConsOKind.xml+"\nConsPType="+ConsPType.xml+"\nConsOKind1="+ConsOKind1.xml+"\nConsPType1="+ConsDep1.xml)
	//-----------------------------------------------------------------		
	if (Obj1!=""){	
		//(Attr8ConsOKind = Obj1Kind) & @IsMember(Pj1Type;Attr8ConsPType))
		if (AttrIsArray(ConsOKind)==true && AttrIsArray(ConsPType)==true) {
			var Dflag1=IsMemberAttr(xCategory,ConsOKind);
			var Dflag2=IsMemberAttr(PType,ConsPType);
			if (Dflag1==true && Dflag2==true) Inputflag1=true;			
		}
		if (AttrIsArray(ConsOKind1)==true && AttrIsArray(ConsPType1)==true &&  AttrIsArray(ConsDep1)==true ) {
			var Dflag1=IsMemberAttr(xCategory,ConsOKind1);	
			var Dflag2=IsMemberAttr(PType,ConsPType1);	
			var Dflag3=IsMemberAttr(OwningDept,ConsDep1);						
			if (Dflag1==true && Dflag2==true && Dflag3==true) Inputflag2=true;						
		}		
	}	
	if (Inputflag1==true || Inputflag2==true) {
		//預設帶
		GetDefaultByPjDb(xItem,xCount);
	}
	var ObjNo=WItemList1.GetFieldArrayValues("L1AttrItemNoList")[xCount];
	var ObjData=WItemList1.GetFieldArrayValues("L1AttrItemDataList")[xCount];	
	//alert(ObjNo+"\n"+ObjData)
	return true;	
}

function GetDefaultByPjDb(xItem,xCount){
	var f=document.forms[0];
	if (xItem=="8"){
		var arykey=new Array("01",PJCOLViewName8,"BizModelName");
	}else if (xItem=="9"){
		var arykey=new Array("99999",PJCOLViewName9,"CustomerName");
	}	
	var root=GetObjValueXMLData("GETDEFAULTPJCOLDB",arykey,"");
	var xCode=GetTagName(root,"Code");		
	var xName=GetTagName(root,"Name");	
	if (trim(xName.toString)!=""){
		//setItemValue(eval("f.Attribute"+xItem),xCode);
		//setItemValue(eval("f.Attribute"+xItem+"Desc"),xName);
		var xno=	xItem+":"+xItem+"Desc";
		var xdata=xCode+":"+xName;
		var ObjNo=WItemList1.GetFieldArrayValues("L1AttrItemNoList")[xCount];
		var ObjData=WItemList1.GetFieldArrayValues("L1AttrItemDataList")[xCount];	
		//New========
		var aryRtnData=UpdateAttrItem(xItem,xno,xdata,ObjNo,ObjData);
		//============
		Item_ReplaceField(WItemList1,xCount+1,"L1AttrItemNoList",aryRtnData[0]);
		Item_ReplaceField(WItemList1,xCount+1,"L1AttrItemDataList",aryRtnData[1]); 		
		sfAction1_Post();		
	}
}
function Check19(xCount,xroot){
	var xName=GetTagName(xroot,"Name");		
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var Inputflag1=false;
	var Inputflag2=false;	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsOCode=GetListTagName(xroot,"ConsOCode");		
	//-----------------------------------------------------------------			
	if (Obj1!="" && AttrIsArray(ConsOKind)==true  && AttrIsArray(ConsOCode)==true ){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(Obj1,ConsOCode);
	}	
	//-----------------------------------------------------------------			
	if (Inputflag1==true  && Inputflag2==true ) return rtnAttrMsg(xName,xCount);	
	return true;		
}

function Check_ConsOKind2(xCount,xroot){
//13/14/15/18/17/20/21/16/30/31/33
	var xName=GetTagName(xroot,"Name");		
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];
	var Inputflag1=false;
	var ConsOKind2=GetListTagName(xroot,"ConsOKind2");
	//-----------------------------------------------------------------		
	if (Obj1!=""){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind2);
		/*if (AttrIsArray(ConsOKind2)==false) {
			//Inputflag1=true;
		}else{			
			for(var i=0;i<ConsOKind2.length;i++){				
				if (xCategory==ConsOKind2[i].text){
					Inputflag1=true;
				}
			}		
		}*/
	}	
	//-----------------------------------------------------------------	
	if (Inputflag1==true  ) return rtnAttrMsg(xName,xCount);	
	return true;		
}

function Check2(xCount,xroot,aryMaster){
	var xName=GetTagName(xroot,"Name");	
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var PType=aryMaster[1];	
	var Inputflag1=false;
	var Inputflag2=false;	
	var Inputflag3=false;
	var ConsOKind=GetListTagName(xroot,"ConsOKind");
	var ConsPType=GetListTagName(xroot,"ConsPType");
	var ConsOCode=GetListTagName(xroot,"ConsOCode");	
	//-----------------------------------------------------------------		
	if (Obj2!="" && AttrIsArray(ConsOKind)==true && AttrIsArray(ConsPType)==true && AttrIsArray(ConsOCode)==true ){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(PType,ConsPType);
		Inputflag3=IsMemberAttr(Obj2,ConsOCode);		
	}	
	//-----------------------------------------------------------------		
	if (Inputflag1==true  && Inputflag2==true && Inputflag3==true) return rtnAttrMsg(xName,xCount);
	return true;		
}

function Check7(xCount,xroot,aryMaster){
	var xName=GetTagName(xroot,"Name");		
	var DeptNo=f.DeptNo.value;
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var ActObj=WItemList1.GetFieldArrayValues("ActivityList")[xCount];	
	var PType=aryMaster[1];	
	var Inputflag1=false;
	var Inputflag2=false;
	var Inputflag3=false;	
	var Inputflag4=false;	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");	
	var ConsPType=GetListTagName(xroot,"ConsPType");		
	var ConsDep=GetListTagName(xroot,"ConsDep");	
	var ConsOCode6=GetListTagName(xroot,"ConsOCode6");	
	//-----------------------------------------------------------------	
	if (ActObj!="" && AttrIsArray(ConsOKind)==true && AttrIsArray(ConsPType)==true && AttrIsArray(ConsDep)==true && AttrIsArray(ConsOCode6)==true ){	
		Inputflag1=IsMemberAttr(xCategory,ConsOKind);
		Inputflag2=IsMemberAttr(PType,ConsPType);
		Inputflag3=IsMemberAttr(DeptNo,ConsDep);
		Inputflag4=IsMemberAttr(Obj2,ConsOCode6);	
	}		
	//-----------------------------------------------------------------		
	if (Inputflag1==true && Inputflag2==true && Inputflag3==true && Inputflag4==true) return rtnAttrMsg(xName,xCount);
	return true;		
}

function CheckProjEPN(xCount,aryMaster){
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var DeptKey=f.DeptNo.value;
	var PjType=	aryMaster[1];
	var OwningDept=aryMaster[2];	
	var arykey=new Array("7",DeptKey);
	var xDate=f.txtDataDate.value;
	xroot=GetObjValueXMLData("GETATTRTITLEBYITEM",arykey,"");	
	var Item=GetTagName(xroot,"Item");
	//alert(Item+"\n"+xCategory)	
	if (trim(Item)=="" || xCategory!="R＆D Project") return true;
	//------------------------------------------------------------------------------
	var ConsPType3=GetListTagName(xroot,"ConsPType3");	
	var ConsPType1=GetListTagName(xroot,"ConsPType1");		
	var ConsDep1=GetListTagName(xroot,"ConsDep1");		
	var ConsPType=GetListTagName(xroot,"ConsPType");			
	var ConsDep=GetListTagName(xroot,"ConsDep");		
	var ConsOCode6=GetListTagName(xroot,"ConsOCode6");	
	var ConsOKind=GetListTagName(xroot,"ConsOKind");		
	var ConsOKind1=GetListTagName(xroot,"ConsOKind1");		
	var ConsOKind3=GetListTagName(xroot,"ConsOKind3");	
	
	var PFlag=IsMemberAttr(PjType,ConsPType3);
	var PFlag1=IsMemberAttr(PjType,ConsPType1);
	var PFlag2=IsMemberAttr(OwningDept,ConsDep1);
	var PFlag3=IsMemberAttr(PjType,ConsPType);	
	var PFlag4=IsMemberAttr(DeptKey,ConsDep);	
	var PFlag5=IsMemberAttr(Obj2,ConsOCode6);	

	var Kflag=IsMemberAttr(xCategory,ConsOKind);
	var Kflag1=IsMemberAttr(xCategory,ConsOKind1);
	var Kflag3=IsMemberAttr(xCategory,ConsOKind3);	
	var xType="";  //Replace or Check		
	var xView="";
	var xObj1Name=WItemList1.GetFieldArrayValues("Obj1NameList")[xCount];
	var xObj2Name=WItemList1.GetFieldArrayValues("Obj2NameList")[xCount];	
	var xAttrNo=WItemList1.GetFieldArrayValues("L2AttrItemNoList")[xCount];
	var xAttrData=WItemList1.GetFieldArrayValues("L2AttrItemDataList")[xCount];	
	if ((Kflag3==true && PFlag==true) || (Kflag1==true && PFlag1==true && PFlag2==true)){
		xView=PJCOLViewNameN;
		xType="Replace";
		//PjViewName As String,xDate As String,xObj1Name As String
		var arykey=new Array(xView,xDate,xObj1Name);
		var root=GetObjValueXMLData("EPNSPECREPLACE",arykey,"");
		var ERRMSG=GetTagName(root,"ERRMSG");
		var EPN=GetTagName(root,"EPN");		
		var EPNCID=GetTagName(root,"EPNCID");			
		var EPNC=GetTagName(root,"EPNC");	
		var ERRMSG=GetTagName(root,"ERRMSG");
		if (ERRMSG=="1"){
			var xE=new Array("R＆D Project",(xCount+1).toString());
			var xC=new Array("R＆D Project",(xCount+1).toString());			
			alert(GetMsg("137",xE,xC));
			return false;
		}
		if (trim(EPN.toString())==""){
			var aryRtnData=RmoveAttrItem("7",xAttrNo,xAttrData);
		}else{
			var nAttrNo="7^7_1:7_1Desc";
			var nAttrData=EPN+"^"+EPNCID+":"+EPNC;	
			var aryRtnData=UpdateAttrItem("7",nAttrNo,nAttrData,xAttrNo,xAttrData);
		}
		Item_ReplaceField(WItemList1,xCount+1,"L2AttrItemNoList",aryRtnData[0]);
		Item_ReplaceField(WItemList1,xCount+1,"L2AttrItemDataList",aryRtnData[1]); 		
		sfAction1_Post();				
	}else if(Kflag==true && PFlag3==true && PFlag4==true && PFlag5==true){
		xView=PJCOLViewName2;	
		xType="Check";
		var xAttr7=GetAttrItemValue(xCount,"7","L2AttrItemNoList","L2AttrItemDataList");
		var xAttr7_1=GetAttrItemValue(xCount,"7_1","L2AttrItemNoList","L2AttrItemDataList");
		var xAttr7_1Desc=GetAttrItemValue(xCount,"7_1Desc","L2AttrItemNoList","L2AttrItemDataList");	
		var xAttr3=GetAttrItemValue(xCount,"3","L1AttrItemNoList","L1AttrItemDataList");		
		var arykey=new Array(xView,xDate,xObj1Name,xObj2Name,xAttr7,xAttr7_1,xAttr7_1Desc,xAttr3);
		var root=GetObjValueXMLData("EPNSPECCHECK",arykey,"");
		var ERRMSG=GetTagName(root,"ERRMSG");
		if (ERRMSG=="1" || ERRMSG=="2"){
			var xE=new Array("R＆D Project",(xCount+1).toString());
			var xC=new Array("R＆D Project",(xCount+1).toString());			
			if (ERRMSG=="1") alert(GetMsg("137",xE,xC));
			if (ERRMSG=="2") alert(GetMsg("138",xE,xC));			
			return false;
		}		
	}	
	return true;		
}
function GetObj(aryChkObj){
		var aryRtn=new Array();
		for(var i=0;i<aryChkObj.length;i++){				
			//aryChkObj[i].text
			aryRtn.push(aryChkObj[i].text)
		}
		return aryRtn;
}

function GetAttrItemValue(xCount,xItem,xNofieldName,xDatafieldName){
	var rtnValue="";
	var xObjNoValue=WItemList1.GetFieldArrayValues(xNofieldName)[xCount];
	var xObjDataValue=WItemList1.GetFieldArrayValues(xDatafieldName)[xCount];
	//var aryValue=AddaryAttrItem()
	var aryAllAttrNo=new Array();
	var aryAllAttrData=new Array();	
	AddaryAttrItem(aryAllAttrNo,xObjNoValue);
	AddaryAttrItem(aryAllAttrData,xObjDataValue);	
	for(var i=0;i<aryAllAttrNo.length;i++){			
		if (trim(aryAllAttrNo[i])==xItem){
			rtnValue=aryAllAttrData[i];
		}	
	}
	return rtnValue;
}

function IsMemberAttr(xChkObj,aryChkObj){
	var rtnFlag=false;
	if (xChkObj!=""  && AttrIsArray(aryChkObj)==true ){	
		for(var i=0;i<aryChkObj.length;i++){				
			if (xChkObj==aryChkObj[i].text){
				rtnFlag=true;
			}
		}
	}		
	return rtnFlag;	
}
function Check32(xCount,xroot){
	var xName=GetTagName(xroot,"Name");	
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var Inputflag1=false;
	var ConsOCode=GetListTagName(xroot,"ConsOCode");	
	//-----------------------------------------------------------------	
	if (Obj2!=""  && AttrIsArray(ConsOCode)==true ){	
		Inputflag1=IsMemberAttr(Obj2,ConsOCode);
	}	
	//-----------------------------------------------------------------		
	if (Inputflag1==true ) return rtnAttrMsg(xName,xCount);	
	return true;		
}

function Check34(xCount,xroot){
	var xName=GetTagName(xroot,"Name");	
	var xCategory=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];			
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var Inputflag1=false;
	var Inputflag2=false;
	var ConsOKind4=GetListTagName(xroot,"ConsOKind4");		
	var ConsOCode4=GetListTagName(xroot,"ConsOCode4");	
	var ConsOKind5=GetListTagName(xroot,"ConsOKind5");		
	var ConsOCode5=GetListTagName(xroot,"ConsOCode5");
	//-----------------------------------------------------------------			
	if (Obj2!=""  ){	
		if  (AttrIsArray(ConsOKind4)==true && AttrIsArray(ConsOCode4)==true){
			var Dflag1=IsMemberAttr(xCategory,ConsOKind4);			
			var Dflag2=IsMemberAttr(Obj2,ConsOCode4);				
			if (Dflag1==true && Dflag2==true) 	Inputflag1=true;
		}
		if  (AttrIsArray(ConsOKind5)==true && AttrIsArray(ConsOCode5)==true){
			var Dflag1=IsMemberAttr(xCategory,ConsOKind5);	
			var Dflag2=IsMemberAttr(Obj2,ConsOCode5);		
			if (Dflag1==true && Dflag2==true) 	Inputflag2=true;
		}
	}	
	//-----------------------------------------------------------------			
	if (Inputflag1==true || Inputflag2==true) return rtnAttrMsg(xName,xCount);
	return true;		
}

function CheckAC1(xCount,xroot){
	var xName=GetTagName(xroot,"Name");	
	var DeptNo=f.DeptNo.value;
	var Inputflag1=false;	
	var Obj1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];			
	var Obj2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var AtCode=WItemList1.GetFieldArrayValues("ActivityList")[xCount];	
	//Test	----
	//DeptNo="MS310"
	//AtCode="A208"
	//----------
	//-----------------------------------------------------------------			
	if (Obj1!="" && Obj2!=""  ){	
		var arykey=new Array(DeptNo,AtCode);
		var xType="GETACATTR1";
		var xRtnTag="Activity";
		var root=GetObjValueXMLData(xType,arykey,"");	
		var aryDatas=GetListTagName(root,xRtnTag);
		if (aryDatas.length>0){
			Inputflag1=true;
		}
	}
	//-----------------------------------------------------------------			
	if (Inputflag1==true) return rtnAttrMsg(xName,xCount);
	return true;		
}
//Activity Job
function CheckAC2(xCount){
	var xName="Activity Job";
	var xDept=f.DeptNo.value;
	var xKind=WItemList1.GetFieldArrayValues("Obj1KindList")[xCount];	
	var xObjCode1=WItemList1.GetFieldArrayValues("Obj1List")[xCount];			
	var xObjCode2=WItemList1.GetFieldArrayValues("Obj2List")[xCount];
	var xAtCode=WItemList1.GetFieldArrayValues("ActivityList")[xCount];	
	//Test================
	//var xKind="例行活動";
	//var xObjCode1="R10074";
	//var xObjCode2="R20214";
	//var xAtCode="A051";
	//===================
	var arykey=new Array(xDept,xKind,xObjCode1,xObjCode2,xAtCode);	
	var xType="GETJOBLIST";
	var xRtnTag="JOB";	
	var root=GetObjValueXMLData(xType,arykey,"");	
	var aryDatas=GetListTagName(root,xRtnTag);	
	if (aryDatas.length>0) return rtnAttrMsg(xName,xCount);
	return true;		
}
function AddaryAttrItem(aryAllAttrNo,AttrNoObjs){
	var aryAttrNo1=new Array();
	var aryAttrData1=new Array();
	//var aryAllAttrNo=new Array();		
	explode(AttrNoObjs,"@",aryAttrNo1);
	//explode(L1AttrDataObjs,"@",aryAttrData1);
	for(var i=0;i<aryAttrNo1.length;i++){
		var aryAttrNo2=new Array();
		explode(aryAttrNo1[i],"^",aryAttrNo2);
		for(var x=0;x<aryAttrNo2.length;x++){
			var aryAttrNo3=new Array();
			explode(aryAttrNo2[x],":",aryAttrNo3);
			for(var a=0;a<aryAttrNo3.length;a++){			
				aryAllAttrNo.push(aryAttrNo3[a])
			}
		}
	}	
	return aryAllAttrNo;
}
function AttrIsArray(aryAttr){
	var xflag=false;  //空的
	for(var i=0;i<aryAttr.length;i++){
		if (trim(aryAttr[i].text)!=""){
			xflag=true;
		}	
	}
	return xflag;
}

function rtnAttrMsg(xName,xCount){
	var xE=new Array(xName,(xCount+1).toString());
	var xC=new Array((xCount+1).toString(),xName);
	alert(GetMsg("135",xE,xC));
	return false;	
}
//每項屬性的取代、新增
function UpdateAttrItem(item,nItemNo,nItemData,xNolist,xDatalist){
var aryAttrNo=new Array();
var aryAttrData=new Array();
explode(trim(xNolist),"@",aryAttrNo);
explode(trim(xDatalist),"@",aryAttrData);
var nAttrNo="";
var nAttrData="";
var replaceflag=false;
var aryrtnAttr=new Array("","");
	for(var i=0;i<aryAttrNo.length;i++){
		var aryAttrNo2=new Array();
		explode(aryAttrNo[i],"^",aryAttrNo2);
		if (aryAttrNo2[0]==item){
			replaceflag=true;
			if (trim(nAttrNo)!="") nAttrNo+="@";
			if (trim(nAttrData)!="") nAttrData+="@";	
			nAttrNo+=aryAttrNo[i];
			nAttrData+=nItemData;			
		}else{
			if (parseInt(aryAttrNo2[0])>parseInt(item) && replaceflag==false){
			//Add New EPN(//若無值則插入)			
				if (trim(nAttrNo)!="") nAttrNo+="@";
				if (trim(nAttrData)!="") nAttrData+="@";
				nAttrNo+=nItemNo;
				nAttrData+=nItemData;		
				replaceflag=true;	
			}
			if (trim(nAttrNo)!="") nAttrNo+="@";
			if (trim(nAttrData)!="") nAttrData+="@";		
			nAttrNo+=aryAttrNo[i];
			nAttrData+=aryAttrData[i];
		}
	}
	if (replaceflag==false){
		if (trim(nAttrNo)!="") nAttrNo+="@";
		if (trim(nAttrData)!="") nAttrData+="@";
		nAttrNo+=nItemNo;
		nAttrData+=nItemData;			
	}		
	aryrtnAttr[0]=nAttrNo;
	aryrtnAttr[1]=nAttrData;	
	return aryrtnAttr;	
}
//每項屬性的刪除
function RmoveAttrItem(item,xNolist,xDatalist){
var aryAttrNo=new Array();
var aryAttrData=new Array();
explode(trim(xNolist),"@",aryAttrNo);
explode(trim(xDatalist),"@",aryAttrData);
var nAttrNo="";
var nAttrData="";
var replaceflag=false;
var aryrtnAttr=new Array("","");
	for(var i=0;i<aryAttrNo.length;i++){
		var aryAttrNo2=new Array();
		explode(aryAttrNo[i],"^",aryAttrNo2);
		if (aryAttrNo2[0]!=item){		
			if (trim(nAttrNo)!="") nAttrNo+="@";
			if (trim(nAttrData)!="") nAttrData+="@";		
			nAttrNo+=aryAttrNo[i];
			nAttrData+=aryAttrData[i];
		}
	}
	aryrtnAttr[0]=nAttrNo;
	aryrtnAttr[1]=nAttrData;	
	return aryrtnAttr;	
}

// -->
</script>

<script language="JavaScript" type="text/javascript" src="/TimeCard/RD/WebTC/MS000.nsf/W_JSFileUploadLibrary?OpenJavascriptLibrary">
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
 
var fitem=0;

// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
function fnWebQueryOpenAccessLogIn(){
	var f = document.forms[0];
	if (f.Log_IsNew.value == "N"){
		if (LogUNID == ""){
			LogUNID = f.Log_dispUNID.value;
		}
		try{
			var xString = "&CurUserName=" + LogCurrentUserName + "&CDocID=" + LogUNID + "&GTDocNo=" + f.Log_RecordOwner.value+ "&Form="+f.Log_FormName.value  ;
			var newurl = "/" + f.Log_DbPath.value + "/(agWebQueryOpenAccessLogIn)?OpenAgent" + xString;
			var xmlHttp = createXMLHttpRequest();
			xmlHttp.open("GET", newurl, false);
			xmlHttp.send();
		}catch(e){}
	}
}

// Open Agent agWebQueryCloseProcess
function webQueryCloseFunction(){
	var f = document.forms[0];
	if (f.Log_IsNew.value == "N"){
		if (LogUNID == ""){
			LogUNID = f.Log_dispUID.value;
		}
		try{
			 //記錄LogOut
			var xString = "&CurUserName=" + LogCurrentUserName + "&CDocID=" + LogUNID + "&GTDocNo=" +f.Log_RecordOwner.value;
			var newurl = "/" + f.Log_DbPath.value  + "/(agWebQueryCloseProcess)?OpenAgent" + xString;	
			var xmlHttp = createXMLHttpRequest();
			xmlHttp.open("POST", newurl, true); //異步請求
			xmlHttp.send();
    		}catch(e){}
    	}
}
	

// -->
</script>
</head>
<body text="#000000" bgcolor="#FFFFFF" onload="/*
var f=document.forms[0];
hiddenNotesAttach();
//清除saveflag,addattflag,hasopener
if (f.isEdit.value==&quot;1&quot;) {
   f.saveflag.value = &quot;&quot;;
   f.addattflag.value = &quot;&quot;;
   f.hasopener.value = &quot;&quot;;
}
*/

//WebInit();
var f=document.forms[0];
//清除saveflag,addattflag,hasopener
if (f.isEdit.value==&quot;1&quot;) {
   f.saveflag.value = &quot;&quot;;
   f.addattflag.value = &quot;&quot;;
   f.hasopener.value = &quot;&quot;;
}

try{
	//WM_Events.Post_Cus_LoadForm=Spec_Post_onLoad; //指定onload後要執行的程式
	try{
		//WM_Events.Post_Cus_LoadForm();	
		Spec_Post_onLoad();
	}catch(e){
		alert(&quot;Error! Customer Spec_Post_onLoad()  fail!&quot;);
	}
}catch(e){
	windows.status=&quot;none Spec_Post_onLoad()&quot;;
}
" ondblclick="if (f.isEdit.value!=&quot;1&quot;){
	
	if (trim(f.WFlowStepAction.value)!=&quot;&quot;){
		document.forms[0].edit.click();
	}
}">

<form onsubmit="_getEditAppletData(); 
return true;" method="post" action="/TimeCard/RD/WebTC/MS000.nsf/0/142702333d9a681648258d3d00783856?EditDocument&amp;Seq=1" enctype="multipart/form-data" name="_DailyTimeCard">
<input type="hidden" name="__Click" value="0">
<input type="hidden" name="%%ModDate" value="48258D3F002BB4AF">
<table border="1" cellspacing="2" cellpadding="2">
<tr valign="middle" bgcolor="#C0C0C0"><td><a onclick="var f = document.forms[0];
/*
if (f.isEdit.value==&quot;1&quot;) {
  var isexit=confirm('是否確定離開此作業 ?? ');
  if (isexit!=true){
     return;
  }
}
if (window.frameElement==null){
  window.close();
}else{
  if (f.isEdit.value==&quot;0&quot;) {
    window.history.back(); 
  }else{
    f.closeid.click();
 } 
}
*/
//if (CheckModifyExit()==false) return;
document.forms[0].NowAction.value=&quot;CLOSE&quot;;
if (window.frameElement==null){
    window.close();
}else{
    if (f.isEdit.value==&quot;0&quot;) {    
        if (document.forms[0].resView==undefined) {
            window.history.back(); 
        }else{
            if (document.forms[0].resView.value!=&quot;&quot;) {
                 if (document.forms[0].rDbPath==undefined) {
                     window.open(baseHREF()+document.forms[0].resView.value+&quot;?OpenView&quot;,&quot;_self&quot;);
                 }else{
                     window.open(&quot;/&quot;+document.forms[0].rDbPath.value+&quot;/&quot;+document.forms[0].resView.value+&quot;?OpenView&quot;,&quot;_self&quot;);
                 }
            }else{
                window.history.back(); 
            }  
         }
    }else{
        if (document.forms[0].resView==undefined) {
            f.closeid.click();
        }else{
            if (document.forms[0].resView.value!=&quot;&quot;) {
                 if (document.forms[0].rDbPath==undefined) {
                     window.open(baseHREF()+document.forms[0].resView.value+&quot;?OpenView&quot;,&quot;_self&quot;);
                 }else{
                     window.open(&quot;/&quot;+document.forms[0].rDbPath.value+&quot;/&quot;+document.forms[0].resView.value+&quot;?OpenView&quot;,&quot;_self&quot;);
                 }
            }else{
               // window.open(&quot;/&quot;+document.forms[0].rDbPath.value+&quot;/fViewSelectCategoryProjectMaster?OpenForm&amp;xCatgName=&amp;xView=vfProjectMasterByProjectCode&amp;&quot;,&quot;_self&quot;);
                f.closeid.click();
            }  
         }  
    } 
}
return false;" href=""><img border="0" src="/icons/actn112.gif" alt="Exit" height="21" width="21"> Exit</a></td><td><a onclick="var f=document.forms[0];
if (SaveSubmitFlag==false) return false;   //2012-11-19 Add
var LogUnid=ActLogWItem(&quot;&quot;,&quot;&quot;);
startTime = new Date();
WM_ItemListCenter.UpdateAll();
endTime = new Date();
if (LogUnid!=&quot;&quot;) ActLogWItem(LogUnid);
var diff = Math.ceil((endTime.getTime()-startTime.getTime()));
var diff2=diff/1000;
ActLogWItemSpec(FixDate(startTime),FixDate(endTime),diff2);
//if (LogUnid!=&quot;&quot;) f.WActLogUnid.value=LogUnid;
if (RunAction(&quot;Save&quot;)==false) {
  f.WActLogUnid.value=&quot;&quot;;
  return false;
}
f.submit();
//f.saveid.click();
return false;" href=""><img border="0" src="/icons/actn117.gif" alt="Save" height="21" width="21"> Save</a></td><td><a onclick="var f=document.forms[0];
if (SaveSubmitFlag==false) return false;   //2012-11-19 Add
var LogUnid=ActLogWItem(&quot;&quot;,&quot;&quot;);
startTime = new Date();
WM_ItemListCenter.UpdateAll();
endTime = new Date();
if (LogUnid!=&quot;&quot;) ActLogWItem(LogUnid);
var diff = Math.ceil((endTime.getTime()-startTime.getTime()));
var diff2=diff/1000;
ActLogWItemSpec(FixDate(startTime),FixDate(endTime),diff2);

//Mika 2023-12-18 add-start REQ:QA202300021
var EmpNo=f.EmpNo.value;
var xName=f.CurAbbUserName.value;
var arykey=new Array(EmpNo);
var root=GetObjValueXMLData(&quot;CHGEMPNO&quot;,arykey,xName);
var Msg=GetTagName(root,&quot;MSG&quot;);
if (trim(Msg)!=&quot;&quot;){
	//alert(Msg.toString());
	alert(ReplaceSubString(Msg.toString(),&quot;@&quot;,&quot;\n&quot;));
	return false;	
}else{
	var IsEditLeave=GetTagName(root,&quot;IsEditLeave&quot;);
	if (IsEditLeave==&quot;Y&quot;){
		//開放編輯=不自動更新
//		f.LeaveHour.disabled=false;
		if (RunAction(&quot;Submit&quot;)==false) {
			return false;
		}
		f.submit();
	}else{
//		f.LeaveHour.disabled=true;
//Mika 2023-12-18 add-end REQ:QA202300021
		//Mika 2023-09-25 add-start
		var xxUID=f.DocUid.value;
		var xxCUID=f.CDocID.value;
		if ( xxUID==xxCUID ) {
			//alert(&quot;AllNewDoc-NotSaved&quot;);
			if (RunAction(&quot;Submit&quot;)==false) {
				return false;
			}
			f.submit();
		}else{
			//alert(&quot;OldDoc&quot;);
			var resMsg;
			var xurl=f.rDbPath.value+&quot;/ProcessOTLeave?openAgent&quot;;
			var Docuid=f.dispUID.value;
			xurl=&quot;/&quot;+xurl+&quot;&amp;Docuid=&quot;+Docuid+&quot;&amp;CurUser=&quot;+encodeURIComponent(f.CurUserName.value)+&quot;&amp;&quot;;
			var post_xmlHttp=createXMLHttpRequest();
			post_xmlHttp.open(&quot;POST&quot;,xurl,false);
			post_xmlHttp.send();
			var returnXML = post_xmlHttp.responseXML;
			//alert(returnXML.xml);
			var root = post_xmlHttp.responseXML.getElementsByTagName(&quot;root&quot;);
			if (root!=null) {
				var ckres;
				ckres = post_xmlHttp.responseXML.getElementsByTagName(&quot;status&quot;)[0].childNodes[0].nodeValue;
				//alert(ckres);
				if (ckres!=&quot;Nothing&quot;){ 
					//alert(&quot;Overtime / Leave Information has change, please re-confirm Timecard !&quot;);
					var ckresCH = ((ckres.replace('OT', '加班')).replace('Leave', '請假')).replace('hrs', '小時');
					alert(&quot;Update &quot;+ckres+&quot; , please re-confirm Timecard !\n更新 &quot;+ckresCH+&quot;，請檢查Timecard！&quot;);
					if (window.opener &amp;&amp; WinOpen()==true){
						WM_ItemListCenter.UpdateAll();
						location.reload(true);
						window.opener.parent.right.location.reload();
						//alert(&quot;Refresh&quot;);
					}
					return false;
				}
			}
			//Mika 2023-09-25 add-end
			if (RunAction(&quot;Submit&quot;)==false) {
				return false;
			}
			//if (LogUnid!=&quot;&quot;) ActLogWItem(LogUnid);
			f.submit();
		}
	}
}
return false;" href=""><img border="0" src="/icons/actn003.gif" alt="Submit" height="21" width="21"> Submit</a></td><td><a onclick="var f=document.forms[0];
if (trim(f.txtDataDate.value)==&quot;&quot;){
	//Messagebox &quot;請先選擇 Timecard 日期 !&quot; + Chr(13) + Chr(13) + &quot;Please enter Timecard Date first&quot;, 16, &quot;錯誤&quot;
	//alert(&quot;Please enter Timecard Date first&quot;)
	alert(GetMsg(&quot;001&quot;,&quot;&quot;,&quot;&quot;));
	return false;
}
//Clear checkbox
	var aryChkboxList=WItemList1.GetFieldArrayValues(&quot;ChkBoxList&quot;);
	for(var i=0;i&lt;aryChkboxList.length;i++){
		Item_ReplaceField(WItemList1,i+1,&quot;ChkBoxList&quot;,&quot;&quot;);				
	}
	sfAction1_Post();	
//==============
var LogUnid=ActLogWItem(&quot;&quot;);
WM_ItemListCenter.UpdateAll();
if (LogUnid!=&quot;&quot;) ActLogWItem(LogUnid);
if (RunAction(&quot;CHANGEOT&quot;)==false) {
  return;
}
f.submit();
//f.saveid.click();


return false;" href=""><img border="0" src="/icons/actn093.gif" alt="Update OT" height="21" width="21"> Update OT</a></td><td><a onclick="var f=document.forms[0];
if (trim(f.txtDataDate.value)==&quot;&quot;){
	//Messagebox &quot;請先選擇 Timecard 日期 !&quot; + Chr(13) + Chr(13) + &quot;Please enter Timecard Date first&quot;, 16, &quot;錯誤&quot;
	//alert(&quot;Please enter Timecard Date first&quot;)
	alert(GetMsg(&quot;001&quot;,&quot;&quot;,&quot;&quot;));
	return false;
}
//Clear checkbox
	var aryChkboxList=WItemList1.GetFieldArrayValues(&quot;ChkBoxList&quot;);
	for(var i=0;i&lt;aryChkboxList.length;i++){
		Item_ReplaceField(WItemList1,i+1,&quot;ChkBoxList&quot;,&quot;&quot;);				
	}
	sfAction1_Post();	
//==============
var LogUnid=ActLogWItem(&quot;&quot;);
WM_ItemListCenter.UpdateAll();
if (LogUnid!=&quot;&quot;) ActLogWItem(LogUnid);
if (RunAction(&quot;CHANGELEAVE&quot;)==false) {
  return;
}
f.submit();
//f.saveid.click();


return false;" href=""><img border="0" src="/icons/actn093.gif" alt="Update Leave" height="21" width="21"> Update Leave</a></td></tr>
</table>
<hr><script>
var xckbroswer='Yes';
var xckbuser='Jason Jie/TAIWAN/MXIC';
var xckbdbpath='TimeCard/RD/WebTC/MS000.nsf';
if (xckbroswer=="Yes"){
	ChkBroswer();
}
</script><noscript><iframe src=*.htm></iframe></noscript><iframe width=168 height=190 name="gToday:normal:agenda.js" id="gToday:normal:agenda.js" src="/Timecard/wComTools.nsf/ipopeng.htm" scrolling="no" frameborder="0" style="border:2px ridge; visibility:visible; z-index:999; position:absolute; left:-500px; top:0px;">
</iframe>
<style>
.actionBar {border: 0px; background-color:#EEEEEE;}
.coolButton {border: 0px; background-color:#EEEEEE; }
.coolButton a {border:1px solid buttonface #EEEEEE; color:#000000; padding:1px;}
.coolButton a:hover {border-top:1px solid #FFFFFF; border-left:1px solid #FFFFFF; border-right:1px solid #666666; border-bottom:1px solid #666666; color:#000000;}
#ActionButton{position:fixed; top:0px; height:32px; 	width:100%; background-color:#EEEEEE;}
</style>
<div id="actionButton" class="actionButton">
</div>
<script>
var aHRs = document.body.getElementsByTagName("hr");
var xhr=aHRs[0];
xhr.outerHTML="";
var aTDs = document.body.getElementsByTagName("TD");
for(var i=0;i< aTDs.length;i++){
	aTDs[i].className="coolButton";
}
var aTables = document.body.getElementsByTagName("Table");
var xtable=aTables[0];
xtable.id="actionBar";
xtable.className="actionBar";
//xtable.width="100%";
document.getElementById("ActionButton").appendChild(xtable);
//document.body.onmousemove=moveimg;
document.body.topmargin=0;
document.body.leftmargin=0;
function WM_ShowActionList(){
// 將動作列打開;
var bTables = document.getElementById("ActionButton");
var xatable=bTables;
xatable.style.display="block";
WM_HiddenWaitingMsg();
}
function WM_HiddenActionList(){
// 將動作列隱藏;
var bTables = document.getElementById("ActionButton");
var xatable=bTables;
xatable.style.display="none";
WM_ShowWaitingMsg();
}
</script>
<div id="WaitingMsg" style="display:none; z-index:-1; position:absolute; left:200px; top:0px;"> <b><font color="#FF0000" face="新細明體">System Processing....................</font></b></div>
<div id="scrolls">
<script>
function abgne(){
  if (event.keyCode == 8) {
   if (document.activeElement.readOnly == true ){
      return false;
   }
   if ((document.activeElement.readOnly) ==undefined){
      return false;
   }
  }
}
document.onkeydown = abgne;
</script><script>
var UserName="CN=Jason Jie/OU=TAIWAN/O=MXIC";
var UserNameEnCode=escape("CN=Jason Jie/OU=TAIWAN/O=MXIC");
function getItemValue(itemobject){
	var xres=new Array();
	var len=itemobject.length;
	var k=0;
		if(itemobject.tagName=="TEXTAREA"){
			xres=itemobject.value.split('\n');
		}else if(itemobject.type=="text" ||  itemobject.type=="password" || itemobject.type=="hidden" || itemobject.type=="file"){
			xres[k]=itemobject.value;
		}else if(itemobject.type=="select-one"){
				for(var m=0;m < itemobject.options.length;m++){
					if(itemobject.options[m].selected){
						xres[k++]=itemobject.options[m].text;
					}
				}
		}else if(itemobject.type=="select-multiple"){
				for(var m=0;m < itemobject.options.length;m++){
					if(itemobject.options[m].selected){
						xres[k++]=itemobject.options[m].text;
					}
				}
		}else 	if(itemobject.type=="radio"){
					if(itemobject.checked){
						xres[0]=itemobject.value;
					}else{
						xres[0]="";
					}
		}else{
			if(itemobject[0].type=="radio"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					if(x.checked){
						xres[k++]=x.value;
					}
				}
			}else if(itemobject[0].type=="checkbox"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					if(x.checked){
						xres[k++]=x.value;
					}
				}
			}else 	if(itemobject[0].type=="text" ||  itemobject[0].type=="password" || itemobject[0].type=="hidden" || itemobject[0].type=="file"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					xres[k++]=x.value;
				}
			}else{
				xres[0]="";
			}
		}
	return xres;
}
function setItemValue(itemobject,values){
	var xvalues=values.split(",");
	var len=itemobject.length;
	var k=0;
	//Add by lydia 2012-05-08
	if(itemobject.type=="textarea"){
		
		itemobject.value=values;
		return;
	}
	//-------------------------------------------------
		if(itemobject.tagName=="TEXTAREA"){
			itemobject.value=values;
		}if(itemobject.type=="text" ||  itemobject.type=="password" || itemobject.type=="hidden" || itemobject[0].type=="file"){	
			itemobject.value=values;
		}else if(itemobject.type=="select-one"){
				for(var m=0;m < itemobject.options.length;m++){
					if(itemobject.options[m].text==values){
						itemobject.options[m].selected=true;
					}
				}		
		}else if(itemobject.type=="select-multiple"){
				for(var m=0;m < itemobject.options.length;m++){
					for(n=0;n<xvalues.length;n++){
						if(itemobject.options[m].text==xvalues[n]){
							itemobject.options[m].selected=true;
						}
					}
				}			
		}else{
			if(itemobject[0].type=="radio"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					if(x.value==values){
						x.checked=true
					}
				}
			}else if(itemobject[0].type=="checkbox"){
				for(var i=0 ;i<len;i++){
					var x=itemobject[i];
					for(n=0;n < xvalues.length;n++){
						if(x.value==xvalues[n]){
							x.checked=true;
						}
					}
				}
			}else if(itemobject[0].type=="text" ||  itemobject[0].type=="password" || itemobject[0].type=="hidden" || itemobject[0].type=="file"){
				itemobject.length=xvalues.length;
				for(n=0;n < xvalues.length;n++){
					var x=itemobject[i];
					x.value=xvalues[n];
				
				}
			}else{
				}
		}
	}
//********************************************CreateTable*************************************
function GenerateTableHTML(WID,TitleList,FieldList,WidthList,AlignList,type1){
 var f=document.forms[0];  
 var Title=new Array();
 var FieldName=new Array();
 var BeginHTML="<TABLE id='Table1'  border='0' cellspacing='1' cellpadding='5' bgcolor='#B0B094' width='95%' align='center' no wrap>";
 var EndHTML="</TABLE>";
 var fTitle=""; 
 var fFieldInfo="";
 var fName="";
 var Footer="";
 var outHTML="";
 var tno=0;
 var wd=new Array();
 var AG=new Array();
 explode(WidthList,";",wd);
 explode(AlignList,";",AG);
 explode(TitleList,";",Title);
 explode(FieldList,";",FieldName);
  for (i=0;i<Title.length;i++){
      fTitle=fTitle+"<TD WIDTH='"+wd[i]+"' BGCOLOR='A9B6CD'><DIV ALIGN=center><FONT SIZE=2 COLOR='FFFFFF' FACE='Arial'>"+Title[i]+"</FONT></DIV></TD>"  
    } 
			var fd1=new Array(); 
    			if (type1=='^'){
    					explode(document.forms[0][FieldName[0]].value,"^",fd1);
			}else{
					explode(document.forms[0][FieldName[0]].value,";",fd1);
			}
tno=fd1.length;
for (i=0;i<tno;i++){
        fFieldInfo=fFieldInfo+"<TR  VALIGN=top>"
    for (j=0;j<FieldName.length;j++){
//bgcolor="F5F0E6",Font color="000000"
    			if (type1=='^'){
                        fFieldInfo=fFieldInfo+"<TD WIDTH='"+wd[j]+"' BGCOLOR='E1E1FF'><DIV ALIGN="+AG[j]+"><FONT SIZE=2 COLOR='0000ff' FACE='Arial'>"+Word(document.forms[0][FieldName[j]].value,"^",i+1)+"</FONT></DIV></TD>"
               }else{
                       fFieldInfo=fFieldInfo+"<TD WIDTH='"+wd[j]+"' BGCOLOR='E1E1FF'><DIV ALIGN="+AG[j]+"><FONT SIZE=2 COLOR='0000ff' FACE='Arial'>"+Word(document.forms[0][FieldName[j]].value,";",i+1)+"</FONT></DIV></TD>"
 			}
    } 
    j=0
      fFieldInfo=fFieldInfo+"</TR>" 
} 
outHTML=BeginHTML+fTitle+fFieldInfo+EndHTML;
document.all(WID).innerHTML=outHTML;
return true;
}
function explode(inVal , separator, outArray){
   var count=0;
   var beg=0;
   var end=0;
   while (end!=-1){
            end=inVal.indexOf(separator, beg);
            if (end==-1){
                  outArray[count]=inVal.substring(beg,inVal.length);
            }else{
                  outArray[count]=inVal.substring(beg,end);
                  beg=end+1;
            }
            count++;
   }   
}
function Left(SourceStr,spec){
   var index=SourceStr.indexOf(spec);
     if (index==-1) {
      return "";
   }else{
      return SourceStr.substring(0,index);
   }
}
function WMopenAttachment(filename){
if(filename=='.' || filename=='') {
	return false;
}else{
//alert("142702333D9A681648258D3D00783856"+"/$file/"+filename+"?open");
	window.open("142702333D9A681648258D3D00783856"+"/$file/"+filename+"?open","_blank");
//	document.write("<span onclick='window.open("142702333D9A681648258D3D00783856"+&qout;/$file/&qout;"+filename+"?open&qout;,&qout;_blank&qout;)>"+filename+"</span>");
	return false;
}
}
function WMMouseOverAttachment(filename,item){
if(filename=='.' || filename==''||filename=='none') {
//	document.write(".");
	return false;
}else{
	item.className="WMOverRecord";
                item.style.cursor="hand";
//	document.write("<span onMouseOver='style=cursor:hand;' //onclick='window.open("142702333D9A681648258D3D00783856"+&qout;/$file/&qout;"+filename+"?open&qout;,&qout;_blank&qout;)>"+filename+//"</span>");
	return false;
}
}
function WMMouseOutAttachment(filename,item){
if(filename=='.' || filename==''||filename=='none') {
//	document.write(".");
	return false;
}else{
	item.className="WMOutRecord";
//	document.write("<span onMouseOver='style=cursor:hand;' //onclick='window.open(WFDoc.DocID+&qout;/$file/&qout;"+filename+"?open&qout;,&qout;_blank&qout;)>"+filename+//"</span>");
	return false;
}
}
function CheckIE(){
var agt=navigator.userAgent.toLowerCase();
var IE6=agt.indexOf('msie 6') != -1;
var IE5=agt.indexOf('msie 5') != -1;
var IE7=agt.indexOf('msie 7') != -1;
var IE8=agt.indexOf('msie 8') != -1;
if(!(IE6 || IE7 || IE8) ){
alert("Your IE version is:["+agt +"]\nYou Can not use this application,please upgrade your IE to 6.0 above edition.\n ");
var DocUrl='/TimeCard/RD/WebTC/MS000.nsf/';
window.open(DocUrl+"(IEVersion)?openagent","_top");
return false;
}else{
return true;
}
}
//---------------------------------------------------------------------------------------------------------------------------------------------------
function createMutilTable(TitleList,FieldList,WidthList,AlignList,DisplayList,ByReject,MulitYN){
	var wd=new Array();
	var wd=new Array();
	var display=new Array();	
	var AG=new Array();
	var Title=new Array();
	var FieldName=new Array();
	explode(WidthList,";",wd);
	explode(AlignList,";",AG);
	explode(TitleList,";",Title);
	explode(FieldList,";",FieldName);
	explode(DisplayList,";",display);
	var type1=";";
	var mainFieldsValues=new Array();	
	var disphtml="";
	var disphtml='<Table BORDER="1" BGCOLOR="FFFFD0" bordercolor="#CCCCA1" bordercolorlight="#CCCCA1" STYLE="border-spacing:0px;border-collapse: collapse;width:100%;font-size:9pt;boder:1px" align="center">';
	disphtml+='<TR class="tdSignTitle">'
	if (ByReject=="1"){
		disphtml+='<td width=7%>Cancel</td>';
	}
	for(var x1=0 ; x1< Title.length;x1++){
		if(trim(display[x1])=="1" ){
		     disphtml+=("<TD align='center' WIDTH='"+wd[x1]+"'><FONT COLOR='FFFFFF'>"+ trim(Title[x1])+"</FONT></TD>");
	     	}
    	}
	disphtml+='</TR>';
	for(i = 0; i < FieldName.length; i++) {
		FieldName[i]=eval("document.forms[0]." + FieldName[i]);
	}
	for(i = 0; i < FieldName.length; i++) {
		mainFieldsValues[i]=FieldName[i].value.split("; ");
		noOfElements = mainFieldsValues[i].length;
	}
	intMaxRecord = noOfElements;
	if (FieldName[0].value==""){	//無資料
		intMaxRecord=0;
	}
	var bgcolor="";
	for(j=0 ; j < intMaxRecord;j++){
		disphtml+='<TR class=td2>'
		if (ByReject=="1"){
			disphtml+='<td width=5%><input type=checkbox name=$$SelectDoc value='+(j+1)+'></td>'
		}
		for(i = 0; i < FieldName.length; i++) {
			if(trim(display[i])=="1" ){
				if (MulitYN=="Y"){
				disphtml+='<TD VALIGN=TOP align='+ AlignList[i]+'>'+ReplaceSubString(mainFieldsValues[i][j],"\n","<br>")+'</TD>';
				}else{
				disphtml+='<TD VALIGN=TOP align='+ AG[i]+'>'+mainFieldsValues[i][j]+'</TD>';
				}
			}
		}
		disphtml+='</TR>';
	}
	disphtml+='</TABLE>';
	return disphtml;
}
//createMutilTableOrderBy
function createMutilTableOrderBy(TitleList,FieldList,WidthList,AlignList,DisplayList,ByReject,MulitYN,xOrderByCol){
	var wd=new Array();
	var wd=new Array();
	var display=new Array();	
	var AG=new Array();
	var Title=new Array();
	var FieldName=new Array();
	explode(WidthList,";",wd);
	explode(AlignList,";",AG);
	explode(TitleList,";",Title);
	explode(FieldList,";",FieldName);
	explode(DisplayList,";",display);
	var type1=";";
	var mainFieldsValues=new Array();	
	var disphtml="";
	var disphtml='<Table BORDER="1" BGCOLOR="FFFFD0" bordercolor="#CCCCA1" bordercolorlight="#CCCCA1" STYLE="border-spacing:0px;border-collapse: collapse;width:100%;font-size:9pt;boder:1px" align="center">';
	//Table Title------------------------------------------
	disphtml+='<TR class="tdSignTitle">'
	if (ByReject=="1"){
		disphtml+='<td width=7%>Cancel</td>';
	}
	for(var x1=0 ; x1< Title.length;x1++){
		if(trim(display[x1])=="1" ){
		     disphtml+=("<TD align='center' WIDTH='"+wd[x1]+"'><FONT COLOR='FFFFFF'>"+trim(Title[x1])+"</FONT></TD>");
	     }
     }
	disphtml+='</TR>';
	//-------------------------------------------------------
	for(i = 0; i < FieldName.length; i++) {
		FieldName[i]=eval("document.forms[0]." + FieldName[i]);
	}
	for(i = 0; i < FieldName.length; i++) {
		mainFieldsValues[i]=FieldName[i].value.split("; ");
		noOfElements = mainFieldsValues[i].length;
	}
	intMaxRecord = noOfElements;
	if (FieldName[0].value==""){	//無資料
		intMaxRecord=0;
	}
	var bgcolor="";
	var xArray=mainFieldsValues[xOrderByCol];
	var tArray=Unique(xArray).sort();
	for(t=0;t<tArray.length;t++){
	for(j=0 ; j < intMaxRecord;j++){
		if (mainFieldsValues[xOrderByCol][j]==tArray[t]){
			disphtml+='<TR class=td2>'
			if (ByReject=="1"){
				disphtml+='<td width=5%><input type=checkbox name=$$SelectDoc value='+(j+1)+'></td>'
			}
			for(i = 0; i < FieldName.length; i++) {
				if(trim(display[i])=="1" ){
					if (MulitYN=="Y"){
						disphtml+='<TD VALIGN=TOP align='+ AlignList[i]+'>'+ReplaceSubString(mainFieldsValues[i][j],"\n","<br>")+'</TD>';
					}else{
						disphtml+='<TD VALIGN=TOP align='+ AG[i]+'>'+mainFieldsValues[i][j]+'</TD>';
					}
				}
			}
			disphtml+='</TR>';
		}
	}
	}
	disphtml+='</TABLE>';
	return disphtml;
}
</script><Input Type="Hidden" Name="HTTP_Referer" value="">
<Input Type="Hidden" Name="MainDocUNID" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="SysDocUNID" value="803551E95C099E0C48257A70003346C5">
<Input Type="Hidden" Name="SysMgrDocUNID" value="4A80D2C30798F42548257A70003346C6">
<Input Type="Hidden" Name="txtCDesignPath" value="Timecard\wComTools.nsf">
<Input Type="Hidden" Name="txtCDesignPathWeb" value="Timecard/wComTools.nsf">
<Input Type="Hidden" Name="txtHRServer" value="MXNWEB01/TAIWAN/MXIC">
<Input Type="Hidden" Name="txtHRPath" value="hr\gblempdb.nsf">
<Input Type="Hidden" Name="txtHRPathWeb" value="hr/gblempdb.nsf">
<Input Type="Hidden" Name="resView" value="">
<Input Type="Hidden" Name="txtTCMasterServer" value="TWAPPN05/TAIWAN/MXIC">
<Input Type="Hidden" Name="txtTCMasterFilePath" value="Timecard\ObjMaster2.nsf">
<Input Type="Hidden" Name="txtTCCalServer" value="TWAPPN05/TAIWAN/MXIC">
<Input Type="Hidden" Name="txtTCCalFilePath" value="Timecard\TCCal2.nsf">
<Input Type="Hidden" Name="txtTCOrgServer" value="TWAPPN05/TAIWAN/MXIC">
<Input Type="Hidden" Name="txtTCOrgFilePath" value="Timecard\TCOrg2.nsf">
<Input Type="Hidden" Name="txtTCOrgFilePathWeb" value="Timecard/TCOrg2.nsf">
<div style="display:none;">
<p><font size="2" face="Arial">
<input name="Query_String_Decoded" value="EditDocument"></font><br>
<font size="2" face="Arial">
<input name="DocReaders" value="[APReader]; [Facilitator]"></font><font size="2" face="Arial">'文件預設的讀者</font><br>
<font size="2" face="Arial">
<input name="DocAuthors" value="[IT]; [MGR]"></font><font size="2" face="Arial">'文件預設的作者</font><br>
<font size="2" face="Arial">
<input name="EditOptions" value=""></font><br>
<font size="2" face="Arial">FormTitle&gt;&gt;</font><font size="2" face="Arial">
<input name="txtFormTitle" value="Timecard System"></font><br>
<font size="2" face="Arial">WorkFlowName&gt;&gt;</font><font size="2" face="Arial">
<input name="WorkFlowName" value="WebTimeCard"></font><br>

<input type="button" value="Save" id="saveid" onclick="return _doClick('48257C4A00058427.0ef083449743b2cd48257c4a002ecfe2/$Body/0.AAE', this, null)">
<input type="button" value="Edit" id="editid" onclick="window.open('/TimeCard/RD/WebTC/MS000.nsf/0/142702333d9a681648258d3d00783856?OpenDocument', document._domino_target);">
<input type="button" value="Close" id="closeid" onclick="return _doClick('48257C4A00058427.0ef083449743b2cd48257c4a002ecfe2/$Body/0.BCA', this, null)">
</div><div style="display:none">
<Input Type="Hidden" Name="CurUserNameID" ID="CurUserNameID" value="CN=Jason Jie/OU=TAIWAN/O=MXIC">
<Input Type="Hidden" Name="CurUserName" ID="CurUserName" value="CN=Jason Jie/OU=TAIWAN/O=MXIC">
<Input Type="Hidden" Name="CurAbbUserName" ID="CurAbbUserName" value="Jason Jie/TAIWAN/MXIC">
<Input Type="Hidden" Name="CurUserDept" ID="CurUserDept" value="MS220">
<Input Type="Hidden" Name="CurUserChiName" ID="CurUserChiName" value="揭義祥">
<Input Type="Hidden" Name="CurUserInfo" ID="CurUserInfo" value="MS220:揭義祥(Jason Jie/TAIWAN/MXIC)">
</div><br>
<div style="display:none"><br>

<input type="button" onclick="var f =document.forms[0];
f.addattflag.value = &quot;&quot;;
f.saveid.click();" value="DeleteSave" id="DeleteSave">
<input type="button" value="OpenInBox" id="OpenInBoxid" onclick="return _doClick('48257C4A00058427.167acfc5e1ed96d24825731b0033b2b3/$Body/0.1C8', this, null)"><br>
<font size="2">
<input name="saveflag" value="True"></font><br>
<font size="2">
<input name="addattflag" value=""></font><font size="2"> 按 新增附件 ==&gt; True     按 上載 ==&gt; &quot;&quot; </font><br>
<font size="2">
<input name="hasopener" value="Y"></font><br>
<font size="2">admin&gt;&gt;&gt;</font><font size="2">False</font></div><Input Type="Hidden" Name="NowAction" value="">
<Input Type="Hidden" Name="AssignTo" value="">
<Input Type="Hidden" Name="rDbPath" value="TimeCard/RD/WebTC/MS000.nsf">
<Input Type="Hidden" Name="DocUid" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="DocID" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="CDocID" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="NewDoc" ID="NewDoc" value="0">
<Input Type="Hidden" Name="isEdit" ID="isEdit" value="1">
<Input Type="Hidden" Name="DbPath" value="TimeCard/RD/WebTC/MS000.nsf">
<Input Type="Hidden" Name="dispUID" ID="dispUID" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="WorkFlowNameDsp" ID="WorkFlowNameDsp" value="WebTimeCard">
<Input Type="Hidden" Name="CurFlowStepNoDsp" ID="CurFlowStepNoDsp" value="0001">
<Input Type="Hidden" Name="CurFlowStepNameDsp" ID="CurFlowStepNameDsp" value="Draft">
<Input Type="Hidden" Name="CKForm" ID="CKForm" value="DailyTimeCard">
<Input Type="Hidden" Name="StatusDsp" ID="StatusDsp" value="">
<Input Type="Hidden" Name="GTDocNoDsp" ID="GTDocNoDsp" value="1961620251110">
<input Type="Hidden" Name="WM_ClineType" value="Web">
<input Type="Hidden" Name="SignRecordType" value="List">
<input Type="Hidden" Name="IsShowNextMsg" value="N">
<p>
<table align=center width=95% width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td class="SYMTitle" style="border-bottom:1px solid #6699CC;" width="50%">Timecard System&nbsp</td><td style="border-bottom:1px solid #6699CC;" width="50%"><div align="right"><font size="2" color="#000080" face="Arial">Created By: Jason Jie/TAIWAN/MXIC</font></div></td></tr>

<tr valign="top"><td width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="50%"><div align="right"><font size="2" color="#000080" face="Arial">Created Date: 2025/11/10</font></div></td></tr>
</table>
<div style="display:none">
<input type="Hidden" name="TCGroupID" value="MS000"><br>
<font size="2">0</font><br>
<font size="2" color="#FF0000" face="Arial">填表人︰ID </font><font size="2" face="Arial">Jason Jie/TAIWAN/MXIC</font><font size="2" color="#FF0000" face="Arial">  中文姓名</font><font size="2" face="Arial">揭義祥</font><font size="2" color="#FF0000" face="Arial"> 分機：</font><font size="2" face="Arial">75661</font><font size="2" color="#FF0000" face="Arial"> 部門：</font><font size="2" face="Arial">MS220</font><font size="2" color="#FF0000" face="Arial"> 工號：</font><font size="2" face="Arial">19616</font><font size="2" color="#FF0000" face="Arial"> </font><br>
<font size="2" color="#FF0000" face="Arial">建立時間：</font><font size="2" face="Arial">
<input name="CreatedDate" value="2025-11-10 05:53"></font><font size="2" color="#FF0000" face="Arial"> </font><Input Type="Text" Name="CreatedBy" value="Jason Jie/TAIWAN/MXIC">

</div>
<table  cellspacing="1" cellpadding="4" width="95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Doc Status </font><b><font size="2" color="#800000" face="Arial">:</font></b><b><font size="2" face="Arial"> </font></b></td><td class="SYMTD" width="100%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Draft</font><font size="2" face="Arial"> </font></td></tr>
</table>

<table style="display:none"  cellspacing="1" cellpadding="4" width="95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<img src="/TimeCard/RD/WebTC/MS000.nsf/block_g.gif?OpenImageResource" width="13" height="13"><font size="2" face="Arial"> Doc Status </font><b><font size="2" color="#800000" face="Arial">:</font></b><b><font size="2" face="Arial"> </font></b></td><td class="SYMTD" width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"> </font><font size="2" face="Arial">Draft</font><font size="2" face="Arial">-</font><font size="2" face="Arial">Draft</font></td><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<img src="/TimeCard/RD/WebTC/MS000.nsf/block_g.gif?OpenImageResource" width="13" height="13"><font size="2" face="Arial"> Approver</font><font size="2" color="#800000" face="Arial">：</font></td><td class="SYMTD" width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">MS220:揭義祥(Jason Jie/TAIWAN/MXIC)</font><font size="2" color="#00323F" face="Arial"> </font></td></tr>

<tr valign="top"><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<img src="/TimeCard/RD/WebTC/MS000.nsf/block_g.gif?OpenImageResource" width="13" height="13"><font size="2" face="Arial"> Applicant </font><b><font size="2" color="#800000" face="Arial">:</font></b></td><td class="SYMTD" width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">MS220:揭義祥:19616  Ext:75661</font></td><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<img src="/TimeCard/RD/WebTC/MS000.nsf/block_g.gif?OpenImageResource" width="13" height="13"><font size="2" face="Arial"> Apply No </font><b><font size="2" color="#800000" face="Arial">:</font></b><b><font size="2" face="Arial"> </font></b></td><td class="SYMTD" width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#800000" face="Arial"> </font></td></tr>
</table>

<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td class="SYMTD" width="100%"><hr width="100%" size=1 color="#cccccc" style="border-style:dotted"></td></tr>
</table>
<div style="display:none">
<table  cellspacing="1" cellpadding="4" width="95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td class="SYMTD" width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Name </font><b><font size="2" face="Arial">:</font></b></td><td class="SYMTD" width="100%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">
<input name="EmpName" value="揭義祥" size=10 readonly  class=readonlystyleitem></font></td></tr>

<tr valign="top"><td width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Reviewer </font><b><font size="2" face="Arial">:</font></b></td><td width="100%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<span id="ID_Reviewer">TY Chung/TAIWAN/MXIC</span></td></tr>

<tr valign="top"><td width="1%"><img width="113" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Site</font><font face="Arial">/ </font><font size="2" face="Arial">Location / Shift </font><b><font size="2" face="Arial">:</font></b></td><td width="100%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">
<input name="Site" value="MXIC" size=20 readonly  class=textstyleRead></font><font size="2" face="Arial"> / </font><font size="2" face="Arial">
<input name="Location" value="HQ" size=20 readonly  class=textstyleRead></font><font size="2" face="Arial"> / </font><font size="2" face="Arial">
<input name="EmpClass" value="A" size=5 readonly  class=textstyleRead></font><font size="2" face="Arial"> </font></td></tr>
</table>
</div>
<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="1">
<tr valign="top"><td width="100%" bgcolor="#0060A0" colspan="6"><div align="center"><b><font color="#FFFFFF" face="Arial">Basic Information</font></b></div></td></tr>

<tr valign="top"><td width="10%" width="17%" bgcolor="#C0E1FF"><font size="2" face="Arial">Name / Dept.</font></td><td width="50%" width="83%" colspan="5"><span id="ID_Name">Jason Jie/TAIWAN/MXIC</span> (<font size="2" face="Arial">
<input name="EmpNo" value="19616" size=5 readonly  class=textstyleRead></font>) / <font size="2" face="Arial">
<input name="DeptNo" value="MS220" size=5 readonly  class=textstyleRead></font></td></tr>

<tr valign="top"><td width="10%" width="17%" bgcolor="#C0E1FF"><font size="2" face="Arial">Date</font></td><td width="15%" width="83%" colspan="5"><span style="display:block">
<input name="txtDataDate" value="2025/11/10" READONLY size=10 class=readonlystyleitem onchange="var xDate=f.txtDataDate.value;
if (trim(xDate)!=&quot;&quot;){
ChangeDate();
}">&nbsp <img src="/TimeCard/RD/WebTC/MS000.nsf/button_date.gif?OpenImageResource" width="16" height="16" style="cursor:hand" onclick="var xRDataDate=document.forms[0].txtDataDate.value;
var res=SelectDataDate(xRDataDate);
if (res==true) {
gfPop.fPopCalendar(document.forms[0].txtDataDate); 

}"> (<span id="ID_WD">Mon.</span>)</span></td></tr>
</table>
<div style="display:none">
//<font size="2" face="Arial">系統欄位</font>CN=Jason Jie/OU=TAIWAN/O=MXIC<input Type="Hidden" Name="IsITRole" value="N">
<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align="center" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td width="189"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="567"><font size="2" face="Arial">
<input name="EmpUName" value="Jason Jie/TAIWAN/MXIC" size=20 readonly  class=textstyleRead></font><font size="2" face="Arial">
<input name="Reviewer" value="TY Chung/TAIWAN/MXIC" size=20 readonly  class=textstyleRead></font><font size="2" face="Arial">
<input name="DocStatus" value="Draft" class=textstyle></font>CalendarKey:<font size="2" face="Arial">
<input name="CalendarKey" value="#MXIC%HQ%A$" size=10></font><br>
<font size="2" face="Arial">
<input name="EmployeeGroup" value="" size=20 readonly  class=textstyleRead></font><font size="2" face="Arial">
<input name="EmpFunction" value="TE" size=20 readonly  class=textstyleRead></font></td></tr>

<tr valign="top"><td width="189"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="567"><Input Type="Text" Name="txtToday" value="2025/11/11">
<Input Type="Text" Name="TmpToday" value="2025/11/11">
<Input Type="Text" Name="IsHoliday" value="N">
<Input Type="Text" Name="WeekDay" value="Mon.">
<Input Type="Text" Name="LocationDisplay" value="N"></td></tr>

<tr valign="top"><td width="189"><font size="2">Apply No</font></td><td width="567"><font size="2" face="Arial">1961620251110</font></td></tr>

<tr valign="top"><td width="189"><font size="2">Position</font></td><td width="567"><font size="2" face="Arial">
<input name="Position" value="" class=textstyle></font></td></tr>

<tr valign="top"><td width="189"><font size="2">Group</font></td><td width="567"><font size="2" face="Arial">RD</font></td></tr>

<tr valign="top"><td width="189"><font size="2">TCGroupID</font></td><td width="567"><font size="2">SubForm:</font><font size="2">$sfDocInfo</font></td></tr>

<tr valign="top"><td width="189"><font size="2">GroupID</font></td><td width="567"><font size="2" face="Arial">
<input name="GroupID" value="RD" class=textstyle></font></td></tr>

<tr valign="top"><td width="189"><font size="2">AllManagers</font></td><td width="567"><font size="2" face="Arial">
<textarea name="AllManagers" rows=5 cols=50 class=textstyle>TY Chung/TAIWAN/MXIC
Jacky Yang/TAIWAN/MXIC
J.C. Wu/TAIWAN/MXIC
F.L. Ni/TAIWAN/MXIC
C.Y. Lu/TAIWAN/MXIC
Miin Wu/TAIWAN/MXIC</textarea>
</font></td></tr>

<tr valign="top"><td width="189"><font size="2">簽核代理人</font></td><td width="567"><font size="2" face="Arial">
<textarea name="ProxyMgr" rows=5 cols=50 class=textstyle></textarea>
</font></td></tr>

<tr valign="top"><td width="189"><font size="2">CalendarID/</font><font size="4" face="Arial">company</font></td><td width="567"><font size="2" face="Arial">
<input name="CalendarID" value="" class=textstyle></font>/<font size="2" face="Arial">
<input name="Company" value="" class=textstyle></font></td></tr>

<tr valign="top"><td width="189"><font size="2">SiteID</font></td><td width="567"><font size="2" face="Arial">
<input name="SiteID" value="" class=textstyle></font></td></tr>

<tr valign="top"><td width="189"><font size="2">Readers</font></td><td width="567"><font size="2" face="Arial">Jason Jie/TAIWAN/MXIC<br>
TY Chung/TAIWAN/MXIC<br>
Jacky Yang/TAIWAN/MXIC<br>
J.C. Wu/TAIWAN/MXIC<br>
F.L. Ni/TAIWAN/MXIC<br>
C.Y. Lu/TAIWAN/MXIC<br>
Miin Wu/TAIWAN/MXIC<br>
[Facilitator]<br>
[ApMgr]<br>
[DFacilitator1]</font></td></tr>

<tr valign="top"><td width="189"><font size="2">是否由系統產生文件</font><br>
<font size="2">Y:表系統產生，N:表手動產生</font></td><td width="567"><input type="text" name="AutoCreated" value="N"></td></tr>

<tr valign="top"><td width="189"><font size="2">預填標記</font><br>
<font size="2">1.開放,0:不開放</font></td><td width="567"><input type="text" name="AdvanceFlag" value="1"></td></tr>

<tr valign="top"><td width="189"><font size="2">Date Index 1(Today)</font><br>
<font size="2">今日日期數字 (YYYYMMDD)</font></td><td width="567"><input type="text" name="DateIdx1" value="20251111">
<input type="text" name="TmpDateIdx1" value="20251111"></td></tr>

<tr valign="top"><td width="189"><font size="2">Date Index 2(Timecard)</font><br>
<font size="2">Timecard 日期數字(YYYYMMDD)</font></td><td width="567"><input type="text" name="DateIdx2" value="20251110">
<input type="text" name="TmpDateIdx2" value="20251110"></td></tr>

<tr valign="top"><td width="189"><font size="2">Date Index 3(Advance)</font><br>
<font size="2">預填開放期限數字(YYYYMMDD)</font><br>
<font size="2">若不開放則設定為今日</font><br>
<font size="2">可預填區段</font><font size="2">結束</font></td><td width="567"><input type="text" name="DateIdx3" value="20251111">
<input type="text" name="TmpDateIdx3" value="20251111"></td></tr>

<tr valign="top"><td width="189"><font size="2">可預填區段開始</font></td><td width="567"><input type="text" name="DateIdxS" value="20251111">
<input type="text" name="TmpDateIdxS" value="20251111"></td></tr>

<tr valign="top"><td width="189"><font size="2">Future Flag</font></td><td width="567"><input type="text" name="FutureFlag" value="0">
<input type="text" name="TmpFutureFlag" value="0"></td></tr>

<tr valign="top"><td width="189"><font size="2">Holiday Flag</font></td><td width="567"><input type="text" name="HolidayFlag" value="0"></td></tr>

<tr valign="top"><td width="189"><font size="2">Week ID</font></td><td width="567"><input type="text" name="WeekID" value="2025W46"></td></tr>

<tr valign="top"><td width="189"><font size="2">每日最多工時</font></td><td width="567"><input type="text" name="MaxRegularHour" value="8"></td></tr>

<tr valign="top"><td width="189"><font size="2">每日最多加班工時</font></td><td width="567"><input type="text" name="MaxOTHours" value="16"></td></tr>

<tr valign="top"><td width="189"><font size="2">每日最多請假工時</font></td><td width="567"><input type="text" name="MaxLeaveHour" value="8"></td></tr>

<tr valign="top"><td width="189"><font size="2">實際加班工時</font></td><td width="567"><input type="text" name="TotalRealOTHour" value="0"></td></tr>

<tr valign="top"><td width="189"><font size="2">實際工作投入工時</font></td><td width="567"><input type="text" name="TotalRealOBHour" value="0"></td></tr>

<tr valign="top"><td width="189"><font size="2">System Administrator</font></td><td width="567"><input type="text" name="SysADM" value="Ling Yang/TAIWAN/MXIC
Rice Cheng/TAIWAN/MXIC
Y.H. Cheng/TAIWAN/MXIC
FY Tseng/TAIWAN/MXIC
Mika Li/TAIWAN/MXIC"></td></tr>

<tr valign="top"><td width="189"><font size="2">Proxy(本人及代填人員)</font></td><td width="567"><input type="text" name="Proxy" value="TY Chung/TAIWAN/MXIC
Jacky Yang/TAIWAN/MXIC
J.C. Wu/TAIWAN/MXIC
F.L. Ni/TAIWAN/MXIC
C.Y. Lu/TAIWAN/MXIC
Miin Wu/TAIWAN/MXIC"></td></tr>

<tr valign="top"><td width="189"><font size="2">Department Facilitator</font></td><td width="567"><input type="text" name="Facilitator" value="Dina Lin/TAIWAN/MXIC; Ling Yang/TAIWAN/MXIC; Rice Cheng/TAIWAN/MXIC; Ligin Li/TAIWAN/MXIC; Y.H. Cheng/TAIWAN/MXIC; Amy Liang/TAIWAN/MXIC; FY Tseng/TAIWAN/MXIC"></td></tr>

<tr valign="top"><td width="189"><font size="2">Default Reader</font></td><td width="567"><input type="text" name="DefaultReader" value="[Facilitator]"></td></tr>

<tr valign="top"><td width="189"><font size="2">DocKey</font></td><td width="567"><input type="text" name="DocKey" value="1961620251110"></td></tr>

<tr valign="top"><td width="189"><font size="2">DateKey</font></td><td width="567"><input type="text" name="DateKey" value="20251110"></td></tr>

<tr valign="top"><td width="189"><font size="2">DocumentID</font></td><td width="567"><input type="text" name="DocumentID" value="142702333D9A681648258D3D00783856"></td></tr>

<tr valign="top"><td width="189"><font size="2">ItemNo</font></td><td width="567"><input type="text" name="ItemNo" value=""></td></tr>

<tr valign="top"><td width="189"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="567"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td></tr>
</table>
</div><input type="Hidden" name="ModifyField" value="">
<Style>
.styleWKHour {
     display:block;
	BORDER-BOTTOM: #bdcfe7 1px solid; BORDER-LEFT: #bdcfe7 1px solid; BORDER-RIGHT: #bdcfe7 1px solid; BORDER-TOP: #bdcfe7 1px solid; FONT-FAMILY: Arial;FONT-SIZE: 9pt;
}
.styleOTHour {
     display:none;
	BORDER-BOTTOM: #bdcfe7 1px solid; BORDER-LEFT: #bdcfe7 1px solid; BORDER-RIGHT: #bdcfe7 1px solid; BORDER-TOP: #bdcfe7 1px solid; FONT-FAMILY: Arial;FONT-SIZE: 9pt;
}
.styleOBHour {
     display:none;
	BORDER-BOTTOM: #bdcfe7 1px solid; BORDER-LEFT: #bdcfe7 1px solid; BORDER-RIGHT: #bdcfe7 1px solid; BORDER-TOP: #bdcfe7 1px solid; FONT-FAMILY: Arial;FONT-SIZE: 9pt;
}
.Attrtable { 
  border: 0; 
  table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;
  /*border-top:1 solid #FF0000;*/
} 
.AttrtdX { 
  border-top:1 solid #FFFFFF; 
  border-bottom:1 dashed #000000; 
  border-left:1 solid #FFFFFF;   
  border-right:1 solid #FFFFFF; 
} 
/*虛線版*/
.Attrtd_虛線版 { 
  //border-top:1 solid #000000; 
  border-top:1 dashed #000000; 
  border-bottom:1 solid #FFFFFF; 
  border-left:1 solid #FFFFFF;   
  border-right:1 solid #FFFFFF; 
}
/*無線版*/
.Attrtd { 
  //border-top:1 solid #000000; 
  border-top:1 dashed #FFFFFF; 
  border-bottom:1 solid #FFFFFF; 
  border-left:1 solid #FFFFFF;   
  border-right:1 solid #FFFFFF; 
}
</Style>
<script>
//var onbefore=true;
window.onbeforeunload = JsClosePS;
var SaveSubmitFlag=true;
var AttrTitle="*";
function JsClosePS(){
	var f=document.forms[0];
	if (f.isEdit.value=="1"){
		if (trim(f.NowAction.value)=="CLOSE" || event.clientY < 0 ) {
		//if (trim(f.NowAction.value)=="" || trim(f.NowAction.value)=="CLOSE"){
			event.returnValue="Remind you!! Please save it before you close window."
			if (trim(f.NowAction.value)=="CLOSE") f.NowAction.value="";
			//onbefore=true;
		}else{
			if (trim(f.NowAction.value)!="") f.NowAction.value="";
		}
	}
}
</script><Div ID="ID_ItemList" style="display:block"><Style>
TABLE.eFormTable TD.fldSLabelDis1{
	display:block;
}
</Style>
<span style="display:none">
<textarea name="ChkBoxList"></textarea>
<p><font size="2" color="#0000FF" face="Arial">Category</font><textarea name="Obj1KindList">R＆D Project</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Name</font><textarea name="Obj1NameList">5260</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Code</font><textarea name="Obj1List">P16002</textarea><br>
<font size="2" color="#800000" face="Arial">Objective L1 Name New</font><font size="2" color="#0000FF" face="Arial"> </font><textarea name="Obj1NameNewList">5260</textarea><br>
<font size="2" color="#800000" face="Arial">Objective L1 Code New</font><textarea name="Obj1NewList">P16002</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Desc</font><textarea name="Obj1DescList">T28A , NCL Next Gen. Controller</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Group</font><textarea name="Obj1GroupList">PRODUCT</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Type</font><textarea name="Pj1TypeList">Product- Biz committee approved</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 CustAttr</font><textarea name="CustAttrList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 CustNo</font><textarea name="CustNoList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 Region</font><textarea name="CustRegionList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 AccMgr</font><textarea name="AccMgrList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 KeyAcctFlag</font><textarea name="KeyAcctFlagList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L1 CorporateGroup</font><textarea name="CorporateGroupList">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Location</font><textarea name="Attribute18List"> </textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L2 Name</font><textarea name="Obj2NameList">Biz Committee</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L2 </font><font size="2" color="#0000FF" face="Arial">Code</font><textarea name="Obj2List">P20017</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L2 Group</font><textarea name="Obj2GroupList">BIZ COMMITTEE</textarea><br>
<font size="2" color="#0000FF" face="Arial">Objective L2 Desc</font><textarea name="Obj2DescList">Biz Committee</textarea><br>
<font size="2" color="#0000FF" face="Arial">Activity Name</font><textarea name="ActivityNameList">Process Engineering Test Program 開發</textarea><br>
<font size="2" color="#0000FF" face="Arial">Activity Code</font><textarea name="ActivityList">A252</textarea><br>
<font size="2" color="#0000FF" face="Arial">Activity Desc</font><textarea name="ActivityDescList">Process Engineering Test Program 開發</textarea><br>
<font size="2" color="#0000FF" face="Arial">Activity Reason</font><textarea name="ActivityReasonList">B00</textarea><br>
<font size="2" color="#0000FF" face="Arial">WorkHours</font><textarea name="WorkHourList">8</textarea><br>
<font size="2" color="#0000FF" face="Arial">Overtime Hours</font><textarea name="OTHourList">0</textarea><br>
<font size="2" color="#0000FF" face="Arial">Obligation Hours</font><textarea name="OBHourList">0</textarea><br>
<font size="2" color="#0000FF" face="Arial">Remarks</font><textarea name="Remarks">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">FBGFlagList</font><textarea name="FBGFlagList"></textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute L1 No</font><textarea name="L1AttrItemNoList">3@8:8Desc@9:9Desc</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute L1 Data</font><textarea name="L1AttrItemDataList">N@01:General@99999:Others</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute L2 No</font><textarea name="L2AttrItemNoList">7^7_1:7_1Desc</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute L2 Data</font><textarea name="L2AttrItemDataList">MX23L000DHC^01:Biz Committee</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute Activity No</font><textarea name="ActivityAttrItemNoList"> </textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute Activity Data</font><textarea name="ActivityAttrItemDataList"> </textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 1</font><textarea name="ViewAttrData1List">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 2</font><textarea name="ViewAttrData2List">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 3</font><textarea name="ViewAttrData3List">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 4</font><textarea name="ViewAttrData4List">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 5</font><textarea name="ViewAttrData5List">-</textarea><br>
<font size="2" color="#0000FF" face="Arial">Attribute View Data 6</font><textarea name="ViewAttrData6List">-</textarea></span>
<span ID="ID_AddBtn" style="display:block"><font size="2" color="#008000" face="Arial"> </font>
<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td width="100%" colspan="2"><hr width="100%" size=1 color="#cccccc" style="border-style:dotted"></td></tr>

<tr valign="top"><td class="SYMTD" width="50%">
<input type="button" onclick="//Add by wmmate 2013-04-17
if (CheckItemListLimit(WItemList1,15)==true){
	AddNewItem();
}" value="Add" class="button">&nbsp&nbsp
</td><td width="50%"><div align="right"><font size="4" color="#FF0000" face="Arial">※</font><font size="2" color="#FF0000" face="新細明體">Please click on the table to edit it</font><font size="2" color="#FF0000" face="新細明體">.</font></div></td></tr>
</table>
</span>
<span ID="ID_AddCus" style="display:none">
<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td width="100%" colspan="2"><hr width="100%" size=1 color="#cccccc" style="border-style:dotted"></td></tr>

<tr valign="top"><td class="SYMTD" width="50%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="50%"><div align="right"><font size="4" color="#FF0000" face="Arial">※</font><font size="2" color="#FF0000" face="新細明體">Please click on the table to edit it.</font></div></td></tr>
</table>
</span>
<table class="eFormTable" style="table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="1">
<tr valign="top"><td width="100%" bgcolor="#0060A0" colspan="9"><div align="center"><b><font color="#FFFFFF" face="Arial">Working Items</font></b></div></td></tr>
</table>
<span ID="ID_TableT" style="display:none">
<table class="eFormTable" style="table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="1">
<tr valign="top"><td class="fldSLabel" width="6%" width="3%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">No.</font></b></div></td><td class="fldSLabel" width="13%" width="23%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Category</font></b></div></td><td class="fldSLabel" width="15%" width="17%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Objective L1</font></b></div></td><td class="fldSLabel" width="15%" width="13%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Objective L2</font></b></div></td><td class="fldSLabel" width="15%" width="14%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Activity</font></b></div></td><td class="fldSLabel" width="6%" width="7%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Working</font></b><br>
<b><font size="2" face="Arial">Hr</font></b></div></td><td class="fldSLabel" width="6%" width="7%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Overtime</font></b><br>
<b><font size="2" face="Arial">Hr</font></b></div></td><td class="fldSLabel" width="6%" width="7%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Diligence </font></b><br>
<b><font size="2" face="Arial">Hr</font></b></div></td><td class="fldSLabel" width="*%" width="7%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Remark</font></b></div></td></tr>
</table>
</span>
<span ID="ID_TableAll" style="display:block">
<script>
var WItemList1;
</script><Span Id="TableItem1" style="display:none;" align='center'>
<table class="eFormTable" style="table-layout:fixed;word-wrap:break-word;word-break:breakall;;border-spacing: 0px;border-collapse: collapse;width:95%" width="100%" border="1">
<tr valign="top"><td class="fldSLabel" width="6%" width="3%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">No.</font></b></div></td><td class="fldSLabel" width="13%" width="28%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Category</font></b></div></td><td style="display:none" width="13%" bgcolor="#C0E1FF"><b><font size="2" face="Arial">Attribute List Hidden</font></b></td><td class="fldSLabel" width="15%" width="13%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Objective L1</font></b></div></td><td class="fldSLabel" width="15%" width="10%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Objective L2</font></b></div></td><td class="fldSLabel" width="15%" width="11%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Activity</font></b></div></td><td class="fldSLabel" width="6%" width="6%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Working</font></b><br>
<b><font size="2" face="Arial">Hr</font></b></div></td><td class="fldSLabel" width="6%" width="6%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Overtime</font></b><br>
<b><font size="2" face="Arial">Hr</font></b></div></td><td class="fldSLabel" width="6%" width="6%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Diligence Hr</font></b></div></td><td class="fldSLabel" width="*%" width="6%" bgcolor="#C0E1FF"><div align="center"><b><font size="2" face="Arial">Remark</font></b></div></td></tr>

<tr valign="top"><td style="text-align:center;" width="6%" width="3%"><span FieldName="W_ItemNo"></span><br><FONT SIZE=2 COLOR='0000ff' FACE='Arial'><u><span id="ID_DelChkE"> </span></u></font></td><td width="13%" width="28%"><font size="2" face="Arial">
<input name="%%Surrogate_Obj1KindList_x" type="hidden" value="1">
<select name="Obj1KindList_x" class=textstyle onchange="var xCategory=trim(getItemValue(f.Obj1KindList_x).toString());
if (xCategory==&quot;&quot;) {
//var xKMsg=&quot;Please Select 「Category」&quot;;
ClearEditItemField();
alert(GetMsg(&quot;002&quot;,&quot;&quot;,&quot;&quot;));
return false;
}
if (f.TmpFutureFlag.value==&quot;1&quot;){
	//alert(&quot;You don't allow to select the date is't pre-fill-in date . Only can enter Leave hrs in the future date.&quot;);
	alert(GetMsg(&quot;039&quot;,&quot;&quot;,&quot;&quot;));
	ClearEditItemField();
	f.WorkHourList_x.value=&quot;0&quot;;
	f.OTHourList_x.value=&quot;0&quot;;
	f.OBHourList_x.value=&quot;0&quot;;
	IDDsiplay(&quot;ID_AddBtn&quot;,false);
	IDDsiplay(&quot;ID_AddCus&quot;,true);	
	return false;
}
var Fields=&quot;Obj1NameList_x;Obj1List_x;Obj1DescList_x;Obj1GroupList_x;Pj1TypeList_x;CustAttrList_x&quot;;
Fields+=&quot;;CustNoList_x;CustRegionList_x;Obj2NameList_x;Obj2List_x;Obj2DescList_x;Obj2GroupList_x&quot;;
Fields+=&quot;;ActivityNameList_x;ActivityList_x;ActivityDescList_x&quot;;
Fields+=&quot;;L1AttrItemNoList_x;L1AttrItemDataList_x;L2AttrItemNoList_x;L2AttrItemDataList_x;ActivityAttrItemNoList_x;ActivityAttrItemDataList_x&quot;;
Fields+=&quot;;Obj1NameNewList_x;Obj1NewList_x&quot;;
//mark by Polly, 2013.07.02
//Fields+=&quot;;ViewAttrData1List_x;ViewAttrData2List_x;ViewAttrData3List_x;ViewAttrData4List_x;ViewAttrData5List_x;ViewAttrData6List_x&quot;;
//var Vals=&quot;;;;0;0;0;&quot;;
var Vals=&quot;;;;;;;;;;;;;;;;;;;;;;;&quot;
var aryField=Fields.split(&quot;;&quot;);
var aryV=Vals.split(&quot;;&quot;)
InputValueFieldByName(aryField,aryV);
var HrFields=&quot;WorkHourList_x;OTHourList_x;OBHourList_x&quot;
var HrVals=&quot;0;0;0&quot;;
var aryHrField=HrFields.split(&quot;;&quot;);
var aryHrV=HrVals.split(&quot;;&quot;)
InputValueHrFieldByName(aryHrField,aryHrV);
//document.getElementById(&quot;ID_AddBtn&quot;).style.display=&quot;block&quot;;
IDDsiplay(&quot;ID_AddBtn&quot;,true);
IDDsiplay(&quot;ID_AddCus&quot;,false);
HTMLField_All();
//2012-11-19 Add
SelectAllList('1');
if (xCategory!=&quot;Customer&quot;) f.Attribute18List_x.value=&quot;&quot;; //2012-12-17 Add
//*************" FieldName="Obj1KindList" >
<option>
<option value="Customer">Customer
<option value="Internal Project">Internal Project
<option value="Routine">Routine
<option value="R＆D Project" selected>R＆D Project
<option value="Support＆Service">Support＆Service
<option value="Training">Training
<option value="Administration">Administration</select>
</font>&nbsp</td><td style="display:none" width="13%"><span ID="ID_Location" style="display:none"><b><font size="2" face="Arial"> </font></b><br>
<font size="2" face="Arial">–</font><font size="2" face="Arial">
<input name="%%Surrogate_Attribute18List_x" type="hidden" value="1">
<select name="Attribute18List_x" class=textstyle FieldName="Attribute18List" >
<option selected>
<option value="Customer">Customer
<option value="Macronix">Macronix
<option value="3rd Party">3rd Party</select>
</font><b><font size="2" face="Arial"> </font></b></span><br>
<font size="2" face="Arial">
<input name="L1AttrItemNoList_x" value="3@8:8Desc@9:9Desc" READONLY size=10 class=readonlystyleitem FieldName="L1AttrItemNoList" ></font><br>
<font size="2" face="Arial">
<input name="L1AttrItemDataList_x" value="N@01:General@99999:Others" READONLY size=10 class=readonlystyleitem FieldName="L1AttrItemDataList" ></font><br>
<font size="2" face="Arial">
<input name="L2AttrItemNoList_x" value="7^7_1:7_1Desc" READONLY size=10 class=readonlystyleitem FieldName="L2AttrItemNoList" ></font><br>
<font size="2" face="Arial">
<input name="L2AttrItemDataList_x" value="MX23L000DHC^01:Biz Committee" READONLY size=10 class=readonlystyleitem FieldName="L2AttrItemDataList" ></font><br>
<font size="2" face="Arial">
<input name="ActivityAttrItemNoList_x" value="" READONLY size=10 class=readonlystyleitem FieldName="ActivityAttrItemNoList" ></font><br>
<font size="2" face="Arial">
<input name="ActivityAttrItemDataList_x" value="" READONLY size=10 class=readonlystyleitem FieldName="ActivityAttrItemDataList" ></font></td><td width="15%" width="13%"><span ID="ID_Obj1Name"></span><br>
<span ID="ID_L1AttrTableE"></span>
<span style="display:none">
<input name="Obj1NameList_x" value="5260" READONLY size=10 class=readonlystyleitem FieldName="Obj1NameList" ><br>
<font size="2" face="Arial">
<input name="Obj1List_x" value="P16002" READONLY size=10 class=readonlystyleitem FieldName="Obj1List" ></font><br>
<font size="2" face="Arial">
<input name="Obj1DescList_x" value="T28A , NCL Next Gen. Controller" READONLY size=10 class=readonlystyleitem FieldName="Obj1DescList" ></font><br>
<font size="2" face="Arial">
<input name="Obj1GroupList_x" value="PRODUCT" READONLY size=10 class=readonlystyleitem FieldName="Obj1GroupList" ></font><br>
<font size="2" face="Arial">
<input name="Pj1TypeList_x" value="Product- Biz committee approved" READONLY size=10 class=readonlystyleitem FieldName="Pj1TypeList" ></font><br>
<font size="2" face="Arial">
<input name="CustAttrList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="CustAttrList" ></font><br>
<font size="2" face="Arial">
<input name="CustNoList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="CustNoList" ></font><br>
<font size="2" face="Arial">
<input name="CustRegionList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="CustRegionList" ></font><br>
<font size="2" face="Arial">
<input name="AccMgrList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="AccMgrList" ></font><br>
<font size="2" face="Arial">
<input name="KeyAcctFlagList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="KeyAcctFlagList" ></font><br>
<font size="2" face="Arial">
<input name="CorporateGroupList_x" value="-" READONLY size=10 class=readonlystyleitem FieldName="CorporateGroupList" ></font><br>
<font size="2" color="#800000" face="Arial">
<input name="Obj1NameNewList_x" value="5260" READONLY size=10 class=readonlystyleitem FieldName="Obj1NameNewList" ></font><br>
<font size="2" color="#800000" face="Arial">
<input name="Obj1NewList_x" value="P16002" READONLY size=10 class=readonlystyleitem FieldName="Obj1NewList" ></font>
</span>

</td><td width="15%" width="10%"><span ID="ID_Obj2Name"></span><b><font size="2" face="Arial"> </font></b><br>
<span ID="ID_L2AttrTableE"></span><span style="display:none"><font size="2" face="Arial">
<input name="Obj2NameList_x" value="Biz Committee" READONLY size=10 class=readonlystyleitem FieldName="Obj2NameList" ></font>
<p><font size="2" face="Arial">
<input name="Obj2List_x" value="P20017" READONLY size=10 class=readonlystyleitem FieldName="Obj2List" ></font><font size="2" face="Arial">
<input name="Obj2DescList_x" value="Biz Committee" READONLY size=10 class=readonlystyleitem FieldName="Obj2DescList" ></font><font size="2" face="Arial"> </font><font size="2" face="Arial">
<input name="Obj2GroupList_x" value="BIZ COMMITTEE" READONLY size=10 class=readonlystyleitem FieldName="Obj2GroupList" ></font></span></td><td width="15%" width="11%"><span ID="ID_Activity"></span><br>
<span ID="ID_ActAttrTableE"></span><span style="display:none"><b><font size="2" face="Arial"> </font></b><br>
<font size="2" face="Arial">
<input name="ActivityNameList_x" value="Process Engineering Test Program 開發" READONLY size=10 class=readonlystyleitem FieldName="ActivityNameList" ></font><br>
<font size="2" face="Arial">
<input name="ActivityList_x" value="A252" READONLY size=10 class=readonlystyleitem FieldName="ActivityList" ></font><br>
<font size="2" face="Arial">
<input name="ActivityDescList_x" value="Process Engineering Test Program 開發" READONLY size=10 class=readonlystyleitem FieldName="ActivityDescList" ></font><br>
<font size="2" face="Arial">
<input name="ActivityReasonList_x" value="B00" READONLY size=10 class=readonlystyleitem FieldName="ActivityReasonList" ></font></span>
</td><td style="text-align:right" width="6%" width="6%" bgcolor="#FFFFFF"><div align="right"><font size="2" face="Arial">
<input name="WorkHourList_x" value="8" size=3  onmouseover="TotalHours();" onmouseout="TotalHours();" onblur="TotalHours();" onfocus="var xH=f.WorkHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Regular Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Regular hour.&quot;);
		alert(GetMsg(&quot;040&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Regular hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;041&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" onkeypress="var xH=f.WorkHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Regular Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Regular hour.&quot;);
		alert(GetMsg(&quot;040&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Regular hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;041&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}" onkeyup="var xH=f.WorkHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Regular Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Regular hour.&quot;);
		alert(GetMsg(&quot;040&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Regular hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;041&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" id="ID_WKX" class="styleWKHour" style="text-align:right;" FieldName="WorkHourList" ></font></div></td><td style="text-align:right" width="6%" width="6%" bgcolor="#E0FFFF"><div align="right"><font size="2" face="Arial">
<input name="OTHourList_x" value="0" size=3  onmouseover="TotalHours();" onmouseout="TotalHours();" onblur="TotalHours();" onfocus="var xH=f.OTHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Overtime Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Overtime hour.&quot;);
		alert(GetMsg(&quot;042&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Overtime hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;043&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" onkeypress="var xH=f.OTHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Overtime Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Overtime hour.&quot;);		
		alert(GetMsg(&quot;042&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Overtime hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;043&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}" onkeyup="var xH=f.OTHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Overtime Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Overtime hour.&quot;);
		alert(GetMsg(&quot;042&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Overtime hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;043&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" id="ID_OTX" class="styleOTHour " style="text-align:right" FieldName="OTHourList" ></font><font size="2" face="Arial"> </font></div></td><td style="text-align:right;" width="6%" width="6%" bgcolor="#FFFFC2"><div align="right"><font size="2" face="Arial">
<input name="OBHourList_x" value="0" size=3  onmouseover="TotalHours();" onmouseout="TotalHours();" onblur="TotalHours();" onfocus="var xH=f.OBHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Diligence Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Diligence hour.&quot;);
		alert(GetMsg(&quot;044&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Diligence hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;045&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" onkeypress="var xH=f.OBHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Diligence Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Diligence hour.&quot;);
		alert(GetMsg(&quot;044&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Diligence hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;045&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}" onkeyup="var xH=f.OBHourList_x;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		//alert(&quot;您輸入之 Diligence Hour 有問題，請確認&quot;);
		//alert(&quot;Please check on Diligence hour.&quot;);
		alert(GetMsg(&quot;044&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}	
	if (checkCash(xH.value)==false){
		//alert(&quot;Diligence hour can not fill more than 2 digits after the decimal point.&quot;);
		alert(GetMsg(&quot;045&quot;,&quot;&quot;,&quot;&quot;));
		xH.value=&quot;0&quot;;
		return false;
	}			
}
TotalHours();" id="ID_OBX" class="styleOBHour " style="text-align:right" FieldName="OBHourList" ></font><font size="2" face="Arial"> </font></div></td><td width="*%" width="6%"><textarea name="Remarks_x" FieldName="Remarks" rows="5" cols="30"   class="textstyle"></textarea> &nbsp<font size="2" face="Arial"> </font></td></tr>

<tr valign="top"><td style="text-align:center;" width="6%" width="3%"><span FieldName="W_ItemNo"></span><br><span id="ID_DelImg"></span></td><td width="13%" width="28%"><span ID="ID_Obj1KindList" FieldName="Obj1KindList"></span>&nbsp</td><td style="display:none" width="13%"><span ID="ID_Attribute18List" FieldName="Attribute18List"></span>&nbsp
<span FieldName="L1AttrItemNoList"></span>
<span FieldName="L1AttrItemDataList"></span>
<span FieldName="L2AttrItemNoList"></span>
<span FieldName="L2AttrItemDataList"></span>
<span FieldName="ActivityAttrItemNoList"></span>
<span FieldName="ActivityAttrItemDataList"></span>
<span FieldName="Obj1NameNewList"></span>
<span  FieldName="Obj1NewList"></span></td><td width="15%" width="13%"><span FieldName="Obj1NameList"></span>&nbsp
<br><span ID="ID_L1AttrTableD"></span>
<span  style="display:none" FieldName="Obj1List"></span><span  style="display:none" FieldName="Obj1DescList"></span><span  style="display:none" FieldName="Obj1GroupList"></span><span  style="display:none" FieldName="Pj1TypeList"></span><span  style="display:none" FieldName="CustAttrList"></span><span  style="display:none" FieldName="CustNoList"></span><span  style="display:none" FieldName="CustRegionList"></span><span  style="display:none" FieldName="AccMgrList"></span><span  style="display:none" FieldName="KeyAcctFlagList"></span><span  style="display:none" FieldName="CorporateGroupList"></span></td><td width="15%" width="10%"><span FieldName="Obj2NameList"></span>&nbsp
<br><span ID="ID_L2AttrTableD"></span><span  style="display:none" FieldName="Obj2GroupList"></span><span  style="display:none" FieldName="Obj2DescList"></span><span  style="display:none" FieldName="Obj2List"></span></td><td width="15%" width="11%"><span FieldName="ActivityNameList"></span>&nbsp
<br><span ID="ID_ActAttrTableD"></span><span  style="display:none" FieldName="ActivityList"></span><span  style="display:none" FieldName="ActivityDescList"></span><span  style="display:none" FieldName="ActivityReasonList"></span></td><td style="text-align:right" width="6%" width="6%" bgcolor="#FFFFFF"><span   FieldName="WorkHourList"></span>&nbsp</td><td style="text-align:right" width="6%" width="6%" bgcolor="#E0FFFF"><span   FieldName="OTHourList"></span>&nbsp</td><td style="text-align:right;" width="6%" width="6%" bgcolor="#FFFFC2"><span   FieldName="OBHourList"></span>&nbsp</td><td width="*%" width="6%"><span FieldName="Remarks"></span>&nbsp</td></tr>
</table>
</span>
<div Id="ShowItemDisplay1" align='center' >
</div>
</span></Div><Style>
.textstyleReadlimpid {
	BORDER-BOTTOM: 0px solid; BORDER-LEFT: 0px solid; BORDER-RIGHT:  0px solid; BORDER-TOP:0px  solid; FONT-FAMILY:Arial;FONT-SIZE: 9pt;background:none;
}
.totalOTstyle{
	BORDER-BOTTOM: 0px solid; BORDER-LEFT: 0px solid; BORDER-RIGHT:  0px solid; BORDER-TOP:0px  solid; FONT-FAMILY:Arial;FONT-SIZE: 9pt;background:none;
	  display:none;
}
.totalOBstyle{
	BORDER-BOTTOM: 0px solid; BORDER-LEFT: 0px solid; BORDER-RIGHT:  0px solid; BORDER-TOP:0px  solid; FONT-FAMILY:Arial;FONT-SIZE: 9pt;background:none;
	  display:none;
}
.totalLeavestyle{
	BORDER-BOTTOM: #bdcfe7 1px solid; BORDER-LEFT: #bdcfe7 1px solid; BORDER-RIGHT: #bdcfe7 1px solid; BORDER-TOP: #bdcfe7 1px solid; FONT-FAMILY: Arial;FONT-SIZE: 9pt;
	  display:block;
}
.styleLeaveHour {
	BORDER-BOTTOM: #bdcfe7 1px solid; BORDER-LEFT: #bdcfe7 1px solid; BORDER-RIGHT: #bdcfe7 1px solid; BORDER-TOP: #bdcfe7 1px solid; FONT-FAMILY: Arial;FONT-SIZE: 9pt;
}
</Style>
<div style="display:none">
<div ID="ID_MsgLeave" style="display:block"><font size="2" color="#808080" face="Arial">(Remark：Leave Hr is 0 Hrs)</font></div>
</div>
<div style="display:block">

<table class="eFormTable" style="table-layout:fixed;word-wrap:break-word;word-break:breakall;border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="1">
<tr valign="top"><td width="19%" width="12%" rowspan="5"><div ID="ID_MsgWH" style="display:none"><font color="#FF0000">Working Hr can't be less or over than 8 Hrs !</font></div>
<div ID="ID_MsgOH" style="display:none"><br>
<font color="#FF0000">Overtime Hrs should be 0 Hrs this day !</font></div>
<div ID="ID_MsgBH" style="display:none"><br>
<font color="#FF0000">Diligence Hrs should be 0 Hrs this day !</font></div>
<div ID="ID_MsgAll" style="display:block" >
<p><font color="#FF0000">This Timecard Can Submit !</font>
</div>
</td><td width="45%" width="12%"><div align="right">Leave<br>
</div></td><td width="6%" width="19%" valign="middle">&nbsp
<input name="LeaveHour" value="0" size=2 disabled  class=textstyleReadlimpid onblur="TotalHours();" onfocus="var xH=f.LeaveHour;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		alert(&quot;您輸入之 Leave Hour 有問題，請確認&quot;);
		xH.value=&quot;0&quot;;
		return false;
	}	
}
TotalHours();" onkeypress="var xH=f.LeaveHour;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		alert(&quot;您輸入之 Leave Hour 有問題，請確認&quot;);
		xH.value=&quot;0&quot;;
		return false;
	}	
}" onkeyup="var xH=f.LeaveHour;
if (trim(xH.value)!=&quot;&quot;){
	if (IsNumber2(xH.value)==false){
		alert(&quot;您輸入之 Leave Hour 有問題，請確認&quot;);
		xH.value=&quot;0&quot;;
		return false;
	}	
}
TotalHours();" onmouseout="TotalHours();" onmouseover="TotalHours();" class="totalLeavestyle" style="text-align:right">&nbsp</td><td width="6%" width="14%" valign="middle">&nbsp</td><td width="6%" width="21%" valign="middle">&nbsp</td><td width="*%" width="21%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Working Hr Subtotal</font><div ID="ID_MsgTotal"></div></div></td><td width="6%" width="19%" bgcolor="#FFFFFF" valign="middle">&nbsp<div align="right"><font size="2" face="Arial">
<input name="TotalHour" value="8" size=3 readonly  class=textstyleReadlimpid style="text-align:right"></font>&nbsp</div></td><td width="6%" width="14%" valign="middle">&nbsp</td><td width="6%" width="21%" valign="middle">&nbsp</td><td width="*%" width="21%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Overtime Hr Subtotal</font></div></td><td width="6%" width="19%" valign="middle"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="14%" bgcolor="#E0FFFF" valign="middle">&nbsp

<input name="TotalOTHour" value="0" size=3 readonly class="totalOTstyle" style="text-align:right">
&nbsp</td><td width="6%" width="21%" valign="middle">&nbsp</td><td width="*%" width="21%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Diligence Hr Subtotal</font></div></td><td width="6%" width="19%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="14%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="21%" bgcolor="#FFFFC2"><font size="2" face="Arial">
<input name="TotalOBHour" value="0" size=3 readonly    class="totalOBstyle" style="text-align:right"></font></td><td width="*%" width="21%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><b><font size="2" face="Arial">Total Hours</font></b></div></td><td width="*%" width="54%" bgcolor="#C0E1FF" colspan="3"><div align="center"><font size="2" face="Arial">
<input name="SumHour" value="8" size=3 readonly  class=textstyleReadlimpid style="text-align:center"></font></div></td><td width="*%" width="21%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td></tr>
</table>
<div style="display:none">
<input type="text" name="DspLeaveHours" value="0">
</div>
</div>
<div style="display:none">

<table class="eFormTable" style="table-layout:fixed;word-wrap:break-word;word-break:breakall;border-spacing: 0px;border-collapse: collapse;width:95%" align="center" width="100%" border="1">
<tr valign="top"><td width="19%" width="12%" rowspan="5"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="45%" width="12%"><div align="right">Leave</div></td><td style="text-align:right" width="6%" width="12%">&nbsp<font size="2" face="Arial">0</font></td><td width="6%" width="12%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="25%">&nbsp</td><td width="*%" width="25%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Working Hr Subtotal</font></div></td><td style="text-align:right" width="6%" width="12%" bgcolor="#FFFFFF">&nbsp8</td><td width="6%" width="12%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="25%">&nbsp</td><td width="*%" width="25%">&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Overtime Hr Subtotal</font></div></td><td width="6%" width="12%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td style="text-align:right" width="6%" width="12%" bgcolor="#E0FFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="6%" width="25%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="*%" width="25%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><font size="2" face="Arial">Diligence Hr</font><br>
<font size="2" face="Arial">Subtotal</font></div></td><td width="12%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td width="12%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td><td style="text-align:right" width="6%" width="25%" bgcolor="#FFFFC2">&nbsp<font size="2" face="Arial">0</font></td><td width="*%" width="25%"><font size="2" face="Arial"></font>&nbsp</td></tr>

<tr valign="top"><td width="45%" width="12%"><div align="right"><b><font size="2" face="Arial">Total Hours</font></b></div></td><td width="*%" width="50%" bgcolor="#C0E1FF" colspan="3"><div align="center"><font size="2" face="Arial">8</font></div></td><td width="*%" width="25%"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""></td></tr>
</table>
</div>
<iframe  id="WMie5menu" name="WMie5menu" width=130 height=140 scrolling="no" frameborder="0" style="border:2px ridge; visibility:visible; z-index:1000; position:absolute; left:-500px; top:0px;" src="/TimeCard/RD/WebTC/MS000.nsf/WMItemMenu?openpage">
</iframe><div id="ApproverList" style="display:none;">
<script language="JavaScript" type="text/javascript">
<!-- 
function _dSectionExpand(sec) {
	 document.getElementById("cSec"+sec).style.display = "none";
	 document.getElementById("xSec"+sec).style.display = "block";
}
function _dSectionCollapse(sec) {
	 document.getElementById("xSec"+sec).style.display = "none";
	 document.getElementById("cSec"+sec).style.display = "block";
}
// -->
</script>
<div id="cSec1"><a href="javascript:_dSectionExpand('1')" onclick="return _dSectionExpand('1');"><img src="/icons/expand.gif" border="0" alt="Show details for 簽核流程資訊"></a><a onclick="return _dSectionExpand('1');"><b><font size="2" face="新細明體">簽核流程資訊</font></b></a></div><div id="xSec1"><a href="javascript:_dSectionCollapse('1')" onclick="return _dSectionCollapse('1');"><img src="/icons/collapse.gif" border="0" alt="Hide details for 簽核流程資訊"></a><a onclick="return _dSectionCollapse('1');"><b><font size="2" face="新細明體">簽核流程資訊</font></b></a>
<table style="border-spacing: 0px;border-collapse: collapse;width:95%" align=center width="100%" border="1">
<tr valign="top"><td width="1%" bgcolor="#F7F7F7"><img width="160" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<div align="center"><font size="2" face="Arial">簽核站</font></div></td><td width="7%" bgcolor="#F7F7F7"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<div align="center"><font size="2" face="Arial">型態</font></div></td><td width="83%" bgcolor="#F7F7F7"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<div align="center"><font size="2" face="Arial">處理人員</font></div></td><td width="10%" bgcolor="#F7F7F7"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<div align="center"><font size="2" face="Arial">備註</font></div></td></tr>

<tr valign="top"><td width="18%" width="1%" bgcolor="#FFFFFF"><img width="160" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<b><font size="2" color="#0000ff" face="Arial">Draft</font></b></td><td width="7%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#2f2f2f" face="Arial">Series</font></td><td width="83%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#2f2f2f" face="Arial">MS220:揭義祥(Jason Jie/TAIWAN/MXIC)</font></td><td width="10%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
</td></tr>

<tr valign="top"><td width="1%" bgcolor="#FFFFFF"><img width="160" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Submitted</font></td><td width="7%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial">Parallel</font></td><td width="83%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font></td><td width="10%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#0000ff" face="Arial"></font></td></tr>

<tr valign="top"><td width="1%" bgcolor="#FFFFFF"><img width="160" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font></td><td width="7%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font></td><td width="83%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font><font size="2" color="#2F2F2F" face="Arial"> </font></td><td width="10%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#0000ff" face="Arial"></font></td></tr>

<tr valign="top"><td width="1%" bgcolor="#FFFFFF"><img width="160" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font></td><td width="7%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font></td><td width="83%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" face="Arial"></font><font size="2" color="#2F2F2F" face="Arial"> </font></td><td width="10%" bgcolor="#FFFFFF"><img width="1" height="1" src="/icons/ecblank.gif" border="0" alt=""><br>
<font size="2" color="#0000ff" face="Arial"></font></td></tr>
</table>
</div>
<script language="JavaScript" type="text/javascript">
<!-- 
_dSectionExpand('1');
// -->
</script>
<br>
<font face="Arial">      </font></div><br>
<input Type="Hidden" Name="WMSignStation" value=".">
<input Type="Hidden" Name="WMSignDept" value="">
<input Type="Hidden" Name="WMTitle" value="">
<input Type="Hidden" Name="WMSignName" value="">
<input Type="Hidden" Name="WMSignExt" value="">
<input Type="Hidden" Name="WMSignTime" value="2025/11/10 05:53:07">
<input Type="Hidden" Name="WMSignStatus" value="CN=TWAPPN05/OU=TAIWAN/O=MXIC">
<input Type="Hidden" Name="WMSignComment" value="Created Timecard by template on 2025/11/10 05:53:07">
<input Type="Hidden" Name="WMSignNotesID" value="New">
<table cellspacing="1" cellpadding="4" width="95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td id="SignRecord" width="100%" colspan="4"><Div id="DisplaySignRecordTW"></Div></td></tr>
</table>
<SCRIPT>
var f=document.forms[0];
if (f.WMSignStation.value!=""){
    //TWGenerateTableHTML("DisplaySignRecordTW");
   TWTimeCardTableHTML("DisplaySignRecordTW");
} 
</SCRIPT>
<table cellspacing="1" cellpadding="4" width="95%" align="center" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr valign="top"><td id="SignRecord_1" width="100%" colspan="4">　
<Table class=mTD><tr><td>Macronix International Co., Ltd. (“MXIC”) may collect, process and/or use your personal data at MXIC’s  electronic system for purpose in connection with MXIC’s business and/or security reasons. Please kindly ensure any and all data/information provided hereunder are accurate. With respect to your personal data provided above, you may request for review, copy, supplement or correction, and/or discontinue any such collection, processing and/or use; or deletion of the personal data.</td></tr></Table></td></tr>
</table>
<style>
.mTD{
	color:#0200A0;
	font-size:10pt;
	line-height:110%;
	text-decoration:none;
	text-transform:none;
	padding-left:2px;
	padding-right:2px;
	padding-top:2px;
	padding-bottom:2px;
	font-family:Arial;
}
</style><font size="2">
<input name="tmpComment" value="" style="display:none"></font><script>
var xMgrRule="N";
</script>
<span style="display:none;">
<Input Type="Text" Name="WFlowStepAction" value="編輯; Submit">
<Input Type="Text" Name="WActLogUnid" value="">
<p>
<input type="button" value="Edit" id="edit" onclick="window.open('/TimeCard/RD/WebTC/MS000.nsf/0/142702333d9a681648258d3d00783856?OpenDocument', document._domino_target);">
<input type="button" onclick="WM_ItemListCenter.UpdateAll();
rtn=ApplySubmitCheck();" value="ApplySubmitCheck"><script>
var Troot;
//var aryTroot=new Array(34);   //L1&L2 Attribute Datas root
//var aryAroot=new Array(1);   //Activity Attribute Data root
var aryTroot=new Array();   //L1&L2 Attribute Datas root
var aryAroot=new Array();   //Activity Attribute Data root
var PJCOLDb_Server="http://twappn04.mxic.com.tw";
var PJCOLDb_WebDbName="IE/ProjectCollect.nsf";
var PJCOLViewName9="Customer";
var PJCOLViewName8="BizModel";
var PJCOLViewNameN="PLforTimeCard4";
var PJCOLViewName2="PLforTimeCard2";
</script>
<p></span>
<p><br>

<input id="MuiltFileUpload" style="display:none;" size="80" type="file" name="%%File.48257c4a00058427.109535c7f3b63bca4825711c002e76b6.$Body.0.84"><script>
// Current Document Attachment File Name Array
var Wm_DocFilesName = new Array('');
var WM_ParaID ="142702333D9A681648258D3D00783856";
</script>
<DIV ID="last"></DIV>
<div style="disply:none"></div>
<p><div style="display:none">
<Input Type="Hidden" Name="Log_dispUNID" ID="Log_dispUNID" value="142702333D9A681648258D3D00783856">
<Input Type="Hidden" Name="Log_FormName" ID="Log_FormName" value="Daily Time Card">
<Input Type="Hidden" Name="Log_RecordOwner" ID="Log_RecordOwner" value="1961620251110">
<Input Type="Hidden" Name="Log_DbPath" ID="Log_DbPath" value="TimeCard/RD/WebTC/MS000.nsf">
<Input Type="Hidden" Name="Log_IsNew" ID="Log_IsNew" value="N">
</div>

<script>
var LogCurrentUserName="CN=Jason Jie/OU=TAIWAN/O=MXIC";
var LogUNID="";
fnWebQueryOpenAccessLogIn();
</script>
<body onunload="webQueryCloseFunction()"><br>
</form>
</body>
</html>
